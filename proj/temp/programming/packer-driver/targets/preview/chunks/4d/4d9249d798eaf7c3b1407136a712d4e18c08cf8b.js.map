{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/vs/VSSatrElementFightLogItem.ts"],"names":["VSSatrElementFightLogItem","Component","Label","path","Sprite","SpriteFrame","folder_icon","ResMgr","CfgMgr","PlayerData","DateUtils","head","resultImg","timeLab","pointLab","data","isInit","onLoad","node","getChildByPath","getComponent","updateShow","SetData","dates","TimestampToDate","timestamp","string","playerData","battlePlayers","UserInfo","playerId","cfg","GetHead","deckAttrs","avatarId","headIconUrl","icon","LoadResAbSub","join","res","spriteFrame","imgStr","result","pointChange"],"mappings":"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","sourcesContent":["import { Component, Label, path, Sprite, SpriteFrame } from \"cc\";\r\nimport { folder_icon, ResMgr } from \"../../manager/ResMgr\";\r\nimport { CfgMgr } from \"../../manager/CfgMgr\";\r\nimport { PlayerData } from \"../player/PlayerData\";\r\nimport { DateUtils } from \"../../utils/DateUtils\";\r\n\r\nexport class VSSatrElementFightLogItem extends Component {\r\n    private head: Sprite;\r\n    private resultImg: Sprite;\r\n    private timeLab: Label;\r\n    private pointLab: Label;\r\n    private data: any;\r\n    private isInit: boolean = false;\r\n    protected onLoad(): void {\r\n        this.head = this.node.getChildByPath(\"head\").getComponent(Sprite);\r\n        this.resultImg = this.node.getChildByPath(\"resultImg\").getComponent(Sprite);\r\n        this.timeLab = this.node.getChildByPath(\"timeLab\").getComponent(Label);\r\n        this.pointLab = this.node.getChildByPath(\"pointLab\").getComponent(Label);\r\n       this.isInit = true;\r\n       if (this.data) this.updateShow();\r\n    }\r\n\r\n    \r\n    SetData(data: any): void {\r\n        this.data = data;\r\n        this.updateShow();\r\n    }\r\n\r\n    private updateShow(): void {\r\n        if (!this.isInit || !this.data) return;\r\n        let dates: string[] = DateUtils.TimestampToDate(this.data.timestamp * 1000, true);\r\n        this.timeLab.string = `${dates[0]}-${dates[1]}-${dates[2]}  ${dates[3]}:${dates[4]}:${dates[5]}`;\r\n        let playerData: any = this.data.battlePlayers[PlayerData.UserInfo.playerId];\r\n        let cfg = CfgMgr.GetHead(playerData.deckAttrs.avatarId);\r\n        if(cfg){\r\n            let headIconUrl = cfg.icon\r\n            ResMgr.LoadResAbSub(path.join(folder_icon, \"head/\", headIconUrl, \"spriteFrame\"), SpriteFrame, res => {\r\n                this.head.spriteFrame =  res;\r\n            });\r\n        }\r\n\r\n        let imgStr: string;\r\n        if (this.data.result == \"win\") {\r\n            imgStr = \"win\";\r\n        } else if (this.data.result == \"lost\") {\r\n            imgStr = \"lost\";\r\n        }else if (this.data.result == \"draw\") {\r\n            imgStr = \"draw\";\r\n        }\r\n        ResMgr.LoadResAbSub(path.join(\"sheets/vs\", imgStr, \"spriteFrame\"), SpriteFrame, (res: SpriteFrame) => {\r\n            this.resultImg.spriteFrame = res;\r\n        });\r\n        this.pointLab.string = this.data.pointChange >= 0 ? `+${this.data.pointChange}` : `-${this.data.pointChange}`;\r\n    }\r\n    \r\n}"]}