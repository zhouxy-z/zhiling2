{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/vs/VsPlayerItem.ts"],"names":["VsPlayerItem","Component","Label","path","Sprite","SpriteFrame","CardGroupCoverItem","ResMgr","roleimage","CfgMgr","effect","cardView","nameBg","nameLab","cardGroupCoverItem","playerName","cardGroupData","isMy","isInit","resNum","onLoad","node","getChildByPath","getComponent","addComponent","active","updateShow","SetData","name","bgUrl","string","cfg","GetHead","avatarId","LoadResAbSub","join","res","spriteFrame"],"mappings":"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","sourcesContent":["import { Component, Label, Node, path, Sprite, SpriteFrame, UITransform, v3, Widget } from \"cc\";\r\nimport { CardGroupCoverItem } from \"../common/CardGroupCoverItem\";\r\nimport proto from \"../../net/Protocol\";\r\nimport { ResMgr, roleimage } from \"../../manager/ResMgr\";\r\nimport { CfgMgr } from \"../../manager/CfgMgr\";\r\n\r\nexport class VsPlayerItem extends Component {\r\n    private effect: Node;\r\n    private cardView: Sprite;\r\n    private nameBg: Sprite;\r\n    private nameLab: Label;\r\n    private cardGroupCoverItem: CardGroupCoverItem;\r\n    private playerName: string;\r\n    private cardGroupData: proto.base.IDeckAttrs;\r\n    private isMy: boolean;\r\n    private isInit: boolean = false;\r\n    private resNum: number = 0;\r\n    protected onLoad(): void {\r\n        this.effect = this.node.getChildByPath(\"effect\");\r\n        this.cardView = this.node.getChildByPath(\"playerCont/cardView\").getComponent(Sprite);\r\n        this.nameBg = this.node.getChildByPath(\"playerCont/nameBg\").getComponent(Sprite);\r\n        this.nameLab = this.node.getChildByPath(\"playerCont/nameLab\").getComponent(Label);\r\n        this.cardGroupCoverItem = this.node.getChildByPath(\"playerCont/CardGroupCoverItem\").addComponent(CardGroupCoverItem);\r\n        this.isInit = true;\r\n        this.effect.active = false;\r\n        if(this.playerName) this.updateShow();\r\n    }\r\n\r\n    SetData(name: string, cardGroupData: proto.base.IDeckAttrs = null, isMy: boolean = false): void {\r\n        this.playerName = name;\r\n        this.isMy = isMy;\r\n        this.cardGroupData = cardGroupData;\r\n        this.updateShow();\r\n    }\r\n\r\n    private updateShow(): void {\r\n        if (!this.isInit) return;\r\n        this.resNum ++;\r\n        let bgUrl: string;\r\n        if (this.playerName) {\r\n            this.effect.active = false;\r\n            this.nameLab.string = this.playerName;\r\n        } else {\r\n            this.effect.active = true;\r\n            this.nameLab.string = `???`;\r\n        }\r\n        this.cardView.node.active = false;\r\n        if (this.cardGroupData) {\r\n            this.cardGroupCoverItem.node.active = true;\r\n            this.cardGroupCoverItem.SetData(this.cardGroupData, false);\r\n            let cfg = CfgMgr.GetHead(this.cardGroupData.avatarId);\r\n            if(cfg) {\r\n                this.cardView.node.active = true;\r\n                ResMgr.LoadResAbSub(path.join(roleimage, cfg.cardView, \"spriteFrame\"), SpriteFrame, res => {\r\n                    this.cardView.spriteFrame =  res;\r\n                });\r\n            }\r\n        } else {\r\n            this.cardGroupCoverItem.node.active = false;\r\n        }\r\n        \r\n        if (this.isMy) {\r\n            bgUrl = \"nameBg_blue\";\r\n        } else {\r\n            bgUrl = \"nameBg_red\";\r\n        }\r\n        ResMgr.LoadResAbSub(path.join(\"sheets/vs\", bgUrl, \"spriteFrame\"), SpriteFrame, (res: SpriteFrame) => {\r\n            this.nameBg.spriteFrame = res;\r\n        });\r\n        \r\n    }\r\n}"]}