{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/utils/Utils.ts"],"names":["Mathf","PlaneView","Utils","Second","second","timeout","p","Promise","resolve","reject","tick","game","totalTime","setTimeout","TimeStamp","tt","$tick_record","$timeseed","toString","copyToClip","value","textarea","document","createElement","body","appendChild","select","setSelectionRange","length","success","execCommand","console","log","err","error","removeChild","BlockInputEvents","Button","Canvas","Input","Node","Rect","Sprite","SpriteRenderer","Tween","UIRenderer","UITransform","Vec3","builtinResMgr","find","geometry","js","math","tween","v3","view","$v1","$v2","$v3","$mat1","mat4","$mat2","$mat3","$q1","quat","$q2","$q3","$ray1","Ray","create","distance","v1","v2","Math","sqrt","pow","x","y","x1","y1","x2","y2","Equip","a","b","epsilon","Number","isNaN","isFinite","abs","constructor","camera","node","nv","offsetx","offsety","plane","leftUp","leftDown","rightUp","rightDown","middle","middleDown","mat","invertMat","localLeftUp","localLeftDown","localMiddle","localRightUp","localRightDown","localMiddleDown","getWorldMatrix","transformMat4","subtract","worldPosition","Plane","z","fromPoints","size","getVisibleSizeInPixel","w","width","h","height","ScreenToPlane","Mat4","invert","setLocalLeftUp","dx","dy","setPosition","setLocalLeftDown","setLocalRightUp","setLocalRightDown","setLocalMiddleDown","checkTouch","e","wide","hide","dispatchEvent","pt","getLocation","undefined","set","v","position","equals","UNIT_Y","$quat_x","$quat_y","$quat_z","Quat","fromEuler","trace","stack","Error","replace","stacks","split","slice","arg","ToFixed","decimal","count","reuslt","round","ls","shift","formatNumber","n","accuracy","BigNumber","fd","isNumber","IsArray","obj","Array","isArray","Object","prototype","call","noTouch","touch","preventSwallow","NoTouch","target","block","getComponent","destroy","on","EventType","TOUCH_START","TOUCH_MOVE","TOUCH_END","TOUCH_CANCEL","Convert","from","to","trans1","convertToWorldSpaceAR","trans2","convertToNodeSpaceAR","ConvertNode","parent","ConvertBoundToCavnas","canvas","canvasMat4","getBoundingBoxTo","MapBound","rect","uts","getComponentsInChildren","ut","clone","union","MapParentBy","component","results","push","CanvasToNode","contentSize","GetBoundingBoxTo","activeInHierarchy","getBoundingBox","xMin","yMin","xMax","yMax","ConvertScreenToNode","uiNode","screenToWorld","csn1","convertToUINode","csn2","MapChildrenFor","handle","list","child","pop","result","children","abss","maxx","max","minn","min","randomf","cusMax","cusMin","random","randomI","lastWeek","today","Date","dayOfWeekIndex","getDay","curDate1","curDate2","hour1","getHours","minutes1","getMinutes","sec1","getSeconds","allSec1","hour2","minutes2","sec2","allSec2","endTime","startTime","setDate","getDate","getTimesTamp","data","nowWeek","curDate","trunc","getTime","Underline","str","hasMap","match","word","toLowerCase","UpperCamel","toUpperCase","MapChild","root","childname","name","openls","isUI","CheckAnimation","ske","action","skeletonData","actions","getAnimsEnum","GetSkeAciton","k","formatDate","cusTime","cusFormat","_date","setTime","_info","getMonth","floor","getMilliseconds","test","RegExp","$1","getFullYear","substr","_key","screenX","screenY","len","screenPointToRay","intersect","rayPlane","computeHit","FaceToNode","out","getWorldPosition","setWorldRotation","GetPlane","TestSize","isScale","defScaleX","scale","defScaleY","sf","spriteFrame","trans","TestUIHigh","fovRad","fov","PI","tan","NodeSubNode","node1","node2","CountBoundSize","box","boundingBox","model","worldBounds","getBoundary","EulerAngles","cross","dot","fromAxisAngle","UP","normalize","cosTheta","theta","acos","getEulerAngles","GetBitPosHiValue","bitPos","rightOffset","bitValue","GetBitPosLowValue","mask","GetBitValue","bit","SetHeadFixedBits","headValue","headBitCount","clearMask","i","bitPosition","SetNodeGray","gray","disabled","get","renderList","btn","rend","interactable","customMaterial","pointToLineDistance3DOptimized","point","linePoint1","linePoint2","direction","AP","NumberRool","curValue","targetValue","dur","callBack","string","uid","uuid","cv","tv","roolObj","_roolObjMap","stopAllByTarget","opts","createMap","onUpdate","t","ratio","start","SaveFile","fileName","blob","Blob","type","url","URL","createObjectURL","link","href","setAttribute","click","revokeObjectURL","CopyProto","classz","datas","decode","encode","finish","GenerateArcPoints","center","pointA","pointB","numSegments","dxA","dyA","dxB","dyB","radiusA","hypot","radiusB","radius","thetaA","atan2","thetaB","deltaTheta","absDeltaTheta","fill","points","angleStep","currentTheta","cos","sin","AddTouchEffect","hitTest","thisObj","bind","onTouchStart3D","onTouchEnd3D","DelTouchEffect","off","getChildByName","active","radio","setScale","RadToDeg","DegToRad","PI90","PI2"],"mappings":"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","sourcesContent":["import { BlockInputEvents, Button, Camera, Canvas, Component, EventTouch, Input, Label, Mask, Mat4, Material, MeshRenderer, Node, Rect, RichText, Sprite, SpriteRenderer, Tween, UIRenderer, UITransform, Vec3, builtinResMgr, find, game, geometry, js, math, sp, tween, v3, view } from \"cc\";\r\nimport { SpriteLabel } from \"../component/SpriteLabel\";\r\nimport proto from \"../net/Protocol\";\r\n\r\nlet $v1 = v3();\r\nlet $v2 = v3();\r\nlet $v3 = v3();\r\nlet $mat1 = math.mat4();\r\nlet $mat2 = math.mat4();\r\nlet $mat3 = math.mat4();\r\nlet $q1 = math.quat();\r\nlet $q2 = math.quat();\r\nlet $q3 = math.quat();\r\nlet $ray1 = geometry.Ray.create();\r\n\r\nexport class Mathf {\r\n    static distance(v1: { x: number, y: number }, vs: { x: number, y: number }): number;\r\n    static distance(x1: number, y1: number, x2: number, y2: number): number;\r\n    static distance(...args) {\r\n        if (args.length == 2) {\r\n            let v1 = args[0], v2 = args[1];\r\n            return Math.sqrt(Math.pow(v2.x - v1.x, 2) + Math.pow(v2.y - v1.y, 2));\r\n        } else {\r\n            let x1 = args[0], y1 = args[1], x2 = args[2], y2 = args[3];\r\n            return Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));\r\n        }\r\n    }\r\n\r\n    /**通用判断浮点数是否相等 */\r\n    static Equip(a, b, epsilon = 1e-10) {\r\n        // 处理非数值类型\r\n        if (typeof a !== 'number' || typeof b !== 'number') return false;\r\n\r\n        // 处理 NaN 和 Infinity\r\n        if (Number.isNaN(a) || Number.isNaN(b)) return false;\r\n        if (!Number.isFinite(a) || !Number.isFinite(b)) return a === b;\r\n\r\n        // 计算绝对差值并与阈值比较\r\n        return Math.abs(a - b) < epsilon;\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * 平面视图\r\n */\r\nexport class PlaneView {\r\n    camera: Camera;\r\n    offsetx: number = 0;\r\n    offsety: number = 0;\r\n    nv: Vec3;\r\n    plane: geometry.Plane;\r\n    leftUp: Vec3;\r\n    leftDown: Vec3;\r\n    rightUp: Vec3;\r\n    rightDown: Vec3;\r\n    middle: Vec3;\r\n    middleDown: Vec3;\r\n    mat: math.Mat4 = math.mat4();\r\n    invertMat: math.Mat4 = math.mat4();\r\n    localLeftUp: Vec3 = v3();\r\n    localLeftDown: Vec3 = v3();\r\n    localMiddle: Vec3 = v3();\r\n    localRightUp: Vec3 = v3();\r\n    localRightDown: Vec3 = v3();\r\n    localMiddleDown: Vec3 = v3();\r\n\r\n    constructor(camera: Camera, node: Node, nv?: Vec3, offsetx?: number, offsety?: number) {\r\n        this.camera = camera;\r\n        this.nv = nv;\r\n        this.offsetx = offsetx || 0;\r\n        this.offsety = offsety || 0;\r\n        node.getWorldMatrix(this.mat);\r\n        if (nv) {\r\n            Vec3.transformMat4($v1, nv, this.mat);\r\n            Vec3.subtract($v2, $v1, node.worldPosition);\r\n            this.plane = geometry.Plane.create($v2.x, $v2.y, $v2.z, node.worldPosition.length());\r\n        } else {\r\n            Vec3.transformMat4($v1, v3(0, 0, 0), this.mat);\r\n            Vec3.transformMat4($v2, v3(1, 3, 0), this.mat);\r\n            Vec3.transformMat4($v3, v3(2, 0, 0), this.mat);\r\n            this.plane = geometry.Plane.create(0, 0, 0, 1);\r\n            geometry.Plane.fromPoints(this.plane, $v1, $v2, $v3);\r\n        }\r\n        let size = view.getVisibleSizeInPixel();\r\n        let w = size.width, h = size.height;\r\n        this.leftUp = v3(...Utils.ScreenToPlane(this.offsetx, h - this.offsety, camera, this.plane));\r\n        this.leftDown = v3(...Utils.ScreenToPlane(this.offsetx, this.offsety, camera, this.plane));\r\n        this.middle = v3(...Utils.ScreenToPlane(w / 2 + this.offsetx, h / 2 + this.offsety, camera, this.plane));\r\n        this.rightUp = v3(...Utils.ScreenToPlane(w - this.offsetx, h - this.offsety, camera, this.plane));\r\n        this.rightDown = v3(...Utils.ScreenToPlane(w - this.offsetx, this.offsety, camera, this.plane));\r\n        this.middleDown = v3(...Utils.ScreenToPlane(w / 2 + this.offsetx, this.offsety, camera, this.plane));\r\n\r\n        math.Mat4.invert(this.invertMat, this.mat);\r\n        Vec3.transformMat4(this.localLeftUp, this.leftUp, this.invertMat);\r\n        Vec3.transformMat4(this.localLeftDown, this.leftDown, this.invertMat);\r\n        Vec3.transformMat4(this.localMiddle, this.middle, this.invertMat);\r\n        Vec3.transformMat4(this.localRightUp, this.rightUp, this.invertMat);\r\n        Vec3.transformMat4(this.localRightDown, this.rightDown, this.invertMat);\r\n        Vec3.transformMat4(this.localMiddleDown, this.middleDown, this.invertMat);\r\n    }\r\n\r\n    setLocalLeftUp(node: Node, dx: number = 0, dy: number = 0) {\r\n        node.setPosition(this.localLeftUp.x + dx, this.localLeftUp.y, this.localLeftUp.z + dy);\r\n    }\r\n    setLocalLeftDown(node: Node, dx: number = 0, dy: number = 0) {\r\n        node.setPosition(this.localLeftDown.x + dx, this.localLeftDown.y, this.localLeftDown.z - dy);\r\n    }\r\n    setLocalRightUp(node: Node, dx: number = 0, dy: number = 0) {\r\n        node.setPosition(this.localRightUp.x - dx, this.localRightUp.y, this.localRightUp.z + dy);\r\n    }\r\n    setLocalRightDown(node: Node, dx: number = 0, dy: number = 0) {\r\n        node.setPosition(this.localRightDown.x - dx, this.localRightDown.y, this.localRightDown.z - dy);\r\n    }\r\n    setLocalMiddleDown(node: Node, dx: number = 0, dy: number = 0) {\r\n        node.setPosition(this.localMiddle.x - dx, this.localMiddle.y, this.localMiddle.z - dy);\r\n    }\r\n\r\n    /**\r\n     * 判断是否触碰\r\n     * @param e \r\n     * @param node \r\n     * @param wide \r\n     * @param hide \r\n     * @returns \r\n     */\r\n    checkTouch(e: EventTouch, node: Node, wide: number, hide: number) {\r\n        if (node['$$mask']) {\r\n            node['$$mask'].dispatchEvent(e);\r\n            return;\r\n        }\r\n        let pt = e.getLocation();\r\n        let [x, y, z] = Utils.ScreenToPlane(pt.x, pt.y, this.camera, this.plane, undefined);\r\n        $v2.set(x, y, z);\r\n        Vec3.transformMat4($v1, $v2, this.invertMat);\r\n        let v = node.position;\r\n        if (this.nv && this.nv.equals(Vec3.UNIT_Y)) {\r\n            if (Math.abs(v.x - $v1.x) <= wide && Math.abs(v.z - $v1.z) <= hide) {\r\n                return true;\r\n            }\r\n        } else {\r\n            if (Math.abs(v.x - $v1.x) <= wide && Math.abs(v.y - $v1.y) <= hide) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}\r\n\r\n/**\r\n * 延迟\r\n * @param second \r\n * @returns \r\n */\r\nexport async function Second(second: number) {\r\n    let timeout: Function;\r\n    let p = new Promise<number>((resolve, reject) => {\r\n        timeout = resolve;\r\n    });\r\n    let tick = game.totalTime;\r\n    setTimeout(() => {\r\n        timeout(game.totalTime - tick);\r\n    }, second * 1000);\r\n    return p;\r\n}\r\n\r\nlet $timeseed = 0;\r\nlet $tick_record: { [tt: string]: number } = {};\r\n\r\n/**\r\n * 标记一个时间或计算已标记的时间点\r\n * @param tt \r\n * @returns \r\n */\r\nexport function TimeStamp(tt?: any) {\r\n    if (tt) {\r\n        return game.totalTime / 1000 - ($tick_record[tt] || 0);\r\n    }\r\n    $timeseed++;\r\n    $tick_record[$timeseed.toString()] = game.totalTime / 1000;\r\n    return $timeseed;\r\n}\r\n\r\nexport function copyToClip(value: string) {\r\n    // 创建一个临时的textarea元素，将文本放入其中\r\n    const textarea = document.createElement('textarea');\r\n    textarea.value = value;\r\n    document.body.appendChild(textarea);\r\n    // 选中文本\r\n    textarea.select();\r\n    textarea.setSelectionRange(0, textarea.value.length);\r\n    let success = false;\r\n    try {\r\n        // 尝试执行复制操作\r\n        document.execCommand('copy');\r\n        console.log('Text copied to clipboard:', value);\r\n        success = true;\r\n    } catch (err) {\r\n        console.error('Unable to copy text to clipboard');\r\n        success = false;\r\n    }\r\n    // 移除临时元素\r\n    document.body.removeChild(textarea);\r\n    return success;\r\n}\r\n\r\n\r\nlet $quat_x = math.quat();\r\nlet $quat_y = math.quat();\r\nlet $quat_z = math.quat();\r\nmath.Quat.fromEuler($quat_x, -90, 0, 0);\r\nmath.Quat.fromEuler($quat_y, 0, -90, 0);\r\nmath.Quat.fromEuler($quat_z, 0, 0, -90);\r\n\r\n\r\n\r\ntype myNumber = number;\r\ntype myString = string;\r\ntype myDecimal = myNumber | myString\r\nexport class Utils {\r\n\r\n    static trace(...arg: any[]) {\r\n        let stack = (new Error()).stack.replace(/\\([^\\)]*\\)/g, \"\");\r\n        let stacks = stack.split(\"\\n\").slice(2, 4);\r\n        console.log(...arg, ...stacks);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param decimal 传入数据 数字或者字符串\r\n     * @param count 需要保留的小数位数\r\n     * @returns \r\n     */\r\n    static ToFixed(decimal: number, count = 0) {\r\n        let reuslt = (Math.round(decimal * 10000000000) / 10000000000) + \"\";\r\n        let ls = reuslt.split(\".\");\r\n        if (!ls.length || count < 1) return reuslt;\r\n        reuslt = ls.shift();\r\n        if (count > 0 && ls.length) reuslt += \".\";\r\n        while (count > 0 && ls.length) {\r\n            reuslt += ls.shift();\r\n            count--;\r\n        }\r\n        return reuslt;\r\n\r\n\r\n        // const ss = 10000000000;\r\n        // let value = Number(decimal);\r\n        // if (isNaN(value) || value == undefined || value == Infinity) return '0';\r\n        // if (typeof (decimal) == \"number\") {\r\n        //     value = Math.round(value * ss) / ss;\r\n        //     if (count) {\r\n        //         let seed = Math.pow(10, count);\r\n        //         value = Math.floor(value * seed) / seed;\r\n        //         return value + \"\";\r\n        //     } else return value + \"\";\r\n        // } else if (typeof (decimal) == \"string\") {\r\n        //     let index = decimal.indexOf(\".\");\r\n        //     if (index != -1) {\r\n        //         if (count > 0) {\r\n        //             return decimal.substring(0, index + count + 1)\r\n        //         } else {\r\n        //             return decimal.substring(0, index);\r\n        //         }\r\n        //     } else {\r\n        //         return decimal;\r\n        //     }\r\n        // }\r\n        // return \"0\";\r\n    }\r\n    static formatNumber(n: number, accuracy: number = 2): string {\r\n        return this.BigNumber(n, accuracy);\r\n    }\r\n    static BigNumber(value: number, fd?: number) {\r\n        if (value >= 1000000000) return this.ToFixed(value / 1000000000, fd) + \"b\";\r\n        if (value >= 1000000) return this.ToFixed(value / 1000000, fd) + \"m\";\r\n        if (value >= 1000) return this.ToFixed(value / 1000, fd) + \"k\";\r\n        return this.ToFixed(value, fd) + \"\";\r\n    }\r\n\r\n    static isNumber(arg: any): arg is number {\r\n        return isNaN(Number(arg)) != false;\r\n    }\r\n    static IsArray(obj: any) {\r\n        if (!Array.isArray) {\r\n            Array[\"isArray\"] = function (arg): arg is any[] {\r\n                return Object.prototype.toString.call(arg) === '[object Array]';\r\n            };\r\n        }\r\n        return Array.isArray(obj);\r\n    }\r\n\r\n    protected static noTouch(touch: EventTouch) {\r\n        touch.preventSwallow = true;\r\n    }\r\n\r\n    /**屏蔽点击 */\r\n    static NoTouch(target: Node) {\r\n        let block = target.getComponent(BlockInputEvents);\r\n        if (block) block.destroy();\r\n        target.on(Input.EventType.TOUCH_START, this.noTouch);\r\n        target.on(Input.EventType.TOUCH_MOVE, this.noTouch);\r\n        target.on(Input.EventType.TOUCH_END, this.noTouch);\r\n        target.on(Input.EventType.TOUCH_CANCEL, this.noTouch);\r\n    }\r\n\r\n    private static trans1: Vec3 = new Vec3();\r\n    private static trans2: Vec3 = new Vec3();\r\n    /**\r\n     * 转换坐标\r\n     * @param x \r\n     * @param y \r\n     * @param from \r\n     * @param to \r\n     * @returns \r\n     */\r\n    static Convert(x: number, y: number, from: Node, to?: Node) {\r\n        this.trans1.set(x, y);\r\n        from.getComponent(UITransform).convertToWorldSpaceAR(this.trans1, this.trans2);\r\n        if (!to) {\r\n            return [this.trans2.x, this.trans2.y];\r\n        }\r\n        to.getComponent(UITransform).convertToNodeSpaceAR(this.trans2, this.trans1);\r\n        return [this.trans1.x, this.trans1.y];\r\n    }\r\n\r\n    static ConvertNode(node: Node, to: Node) {\r\n        let x = node.position.x, y = node.position.y;\r\n        return this.Convert(x, y, node.parent, to);\r\n    }\r\n\r\n    static ConvertBoundToCavnas(canvas: Node, node: Node) {\r\n        let canvasMat4: Mat4 = canvas.getWorldMatrix();\r\n        return node.getComponent(UITransform).getBoundingBoxTo(canvasMat4);\r\n    }\r\n\r\n    static MapBound(node: Node) {\r\n        let rect: Rect;\r\n        node.parent.getWorldMatrix($mat1);\r\n        let uts = node.getComponentsInChildren(UITransform);\r\n        for (let ut of uts) {\r\n            if (!rect) {\r\n                rect = ut.getBoundingBoxTo($mat1).clone();\r\n            } else {\r\n                Rect.union(rect, rect.clone(), ut.getBoundingBoxTo($mat1));\r\n            }\r\n        }\r\n        return rect;\r\n    }\r\n    static MapParentBy(node: Node, component: typeof Component) {\r\n        let results = [];\r\n        let parent = node.parent;\r\n        while (parent) {\r\n            if (parent.getComponent(component)) {\r\n                results.push(parent);\r\n            }\r\n            parent = parent.parent;\r\n        }\r\n        return results;\r\n    }\r\n\r\n    /**屏幕到指定节点 */\r\n    static CanvasToNode(canvas: Node, node: Node) {\r\n        const size = canvas.getComponent(UITransform).contentSize;\r\n        let [x1, y1] = this.Convert(-size.width / 2, size.height / 2, canvas, node);\r\n        let [x2, y2] = this.Convert(size.width / 2, -size.height / 2, canvas, node);\r\n        return [x1, y1, x2, y2];\r\n    }\r\n\r\n    /**\r\n     * 获取指定节点到目标容器的包围盒（自动计算缩放）\r\n     * @param node \r\n     * @param parent \r\n     * @returns \r\n     */\r\n    static GetBoundingBoxTo(node: Node, parent: Node): Rect {\r\n        if (!node.activeInHierarchy) return new Rect();\r\n        let rect = node.getComponent(UITransform).getBoundingBox();\r\n        let [xMin, yMin] = this.Convert(rect.xMin, rect.yMin, node.parent, parent);\r\n        let [xMax, yMax] = this.Convert(rect.xMax, rect.yMax, node.parent, parent);\r\n        return new Rect(xMin, yMin, xMax - xMin, yMax - yMin);\r\n    }\r\n\r\n    private static csn1: Vec3 = new Vec3();\r\n    private static csn2: Vec3 = new Vec3();\r\n    /**计算屏幕到节点的坐标 */\r\n    static ConvertScreenToNode(camera: Camera, x: number, y: number, z: number, uiNode: Node) {\r\n        camera.screenToWorld(v3(x, y, z), this.csn1);\r\n        camera.convertToUINode(this.csn1, uiNode, this.csn2);\r\n        return [this.csn2.x, this.csn2.y];\r\n    }\r\n\r\n\r\n    /**\r\n     * 遍历所有子节点\r\n     * @param node \r\n     * @param handle \r\n     */\r\n    static MapChildrenFor(node: Node, handle: (child: Node) => any) {\r\n        let list: Node[] = [node];\r\n        while (list.length) {\r\n            let child = list.pop();\r\n            let result = handle(child);\r\n            if (result) break;\r\n            if (child.children.length) {\r\n                list.push(...child.children);\r\n            }\r\n        }\r\n    }\r\n\r\n    private static readonly RadToDeg: number = 180 / Math.PI;\r\n    private static readonly DegToRad: number = Math.PI / 180;\r\n    private static readonly PI90: number = Math.PI / 2;\r\n    private static readonly PI2: number = Math.PI * 2;\r\n\r\n    static abss(a: number, b: number = 0) {\r\n        return Math.abs(a - b);\r\n    }\r\n    static maxx(...args: number[]) {\r\n        return Math.max(...args);\r\n    }\r\n    static minn(...args: number[]) {\r\n        return Math.min(...args);\r\n    }\r\n\r\n    /**\r\n         * 最大值和最小值之间随机\r\n         * @param cusMax \r\n         * @param cusMin \r\n         * @returns \r\n         */\r\n    static randomf(cusMax: number, cusMin: number) {\r\n        return Math.random() * (cusMax - cusMin) + cusMin;\r\n    }\r\n    static randomI(cusMax: number, cusMin: number) {\r\n        return Math.round(Math.random() * (cusMax - cusMin) + cusMin);\r\n    }\r\n\r\n    /***\r\n     * 获取上周时间戳\r\n     */\r\n    static lastWeek() {\r\n        const today = new Date(); // 创建一个表示当前时间的 Date 对象\r\n        // 获取今天是星期几（0-6）\r\n        let dayOfWeekIndex = today.getDay();\r\n        if (dayOfWeekIndex == 0) {\r\n            dayOfWeekIndex = 7\r\n        }\r\n        let curDate1: any\r\n        let curDate2: any\r\n        curDate1 = new Date();\r\n        curDate2 = new Date();\r\n\r\n        let hour1 = curDate1.getHours();\r\n        let minutes1 = curDate1.getMinutes();\r\n        let sec1 = curDate1.getSeconds();\r\n        let allSec1 = hour1 * 60 * 60 + minutes1 * 60 + sec1;\r\n\r\n        let hour2 = curDate2.getHours();\r\n        let minutes2 = curDate2.getMinutes();\r\n        let sec2 = curDate2.getSeconds();\r\n        let allSec2 = hour2 * 60 * 60 + minutes2 * 60 + sec2;\r\n\r\n        let endTime: number;\r\n        let startTime: number;\r\n\r\n        curDate1.setDate(curDate1.getDate() - dayOfWeekIndex);\r\n        endTime = this.getTimesTamp(curDate1);\r\n\r\n\r\n        curDate2.setDate(curDate2.getDate() - dayOfWeekIndex - 6);\r\n        startTime = this.getTimesTamp(curDate2);\r\n\r\n        startTime = startTime - allSec1;\r\n        endTime = endTime - allSec2 + 24 * 60 * 60 - 1;\r\n\r\n        let data = {\r\n            startTime: startTime,\r\n            endTime: endTime,\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /***\r\n     * 获取这周时间戳\r\n     */\r\n    static nowWeek() {\r\n        const today = new Date(); // 创建一个表示当前时间的 Date 对象\r\n        // 获取今天是星期几（0-6）\r\n        let dayOfWeekIndex = today.getDay();\r\n        if (dayOfWeekIndex == 0) {\r\n            dayOfWeekIndex = 7\r\n        }\r\n        let curDate1: Date;\r\n        let curDate2: Date;\r\n        curDate1 = new Date();\r\n        curDate2 = new Date();\r\n\r\n        let hour1 = curDate1.getHours();\r\n        let minutes1 = curDate1.getMinutes();\r\n        let sec1 = curDate1.getSeconds();\r\n        let allSec1 = hour1 * 60 * 60 + minutes1 * 60 + sec1;\r\n\r\n        let hour2 = curDate2.getHours();\r\n        let minutes2 = curDate2.getMinutes();\r\n        let sec2 = curDate2.getSeconds();\r\n        let allSec2 = hour2 * 60 * 60 + minutes2 * 60 + sec2;\r\n\r\n        let endTime: number;\r\n        let startTime: number;\r\n        curDate1.setDate(curDate1.getDate() - dayOfWeekIndex + 1);\r\n        startTime = this.getTimesTamp(curDate1) - allSec1;\r\n\r\n        endTime = this.getTimesTamp(curDate2);\r\n\r\n        let data = {\r\n            startTime: startTime,\r\n            endTime: endTime,\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * 时间戳转换（秒）\r\n     * @param curDate 需要转换的时间\r\n     * @returns \r\n     */\r\n    static getTimesTamp(curDate) {\r\n        return Math.trunc(curDate.getTime() / 1000);\r\n    }\r\n\r\n    private static hasMap: { [key: string]: string } = {};\r\n    static Underline(str: string) {\r\n        if (this.hasMap[str]) return this.hasMap[str];\r\n        let value = str.replace(/([A-Z])/g, (match, word) => \"_\" + word.toLowerCase());\r\n        this.hasMap[str] = value;\r\n        return value;\r\n    }\r\n    static UpperCamel(str: string) {\r\n        if (this.hasMap[str]) return this.hasMap[str];\r\n        let value = str.replace(/(\\_[a-z])/g, (match, word) => word.replace(\"_\", \"\").toUpperCase());\r\n        this.hasMap[str] = value;\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * 查找\r\n     * @param root \r\n     * @param childname \r\n     * @returns \r\n     */\r\n    static MapChild(root: Node, childname: string) {\r\n        if (root.name == childname) return root;\r\n        let openls: Node[] = [root];\r\n        while (openls.length) {\r\n            let node = openls.pop();\r\n            for (let child of node.children) {\r\n                if (child.name == childname) return child;\r\n                openls.push(child);\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * 判断是否ui\r\n     * @param node \r\n     * @returns \r\n     */\r\n    static isUI(node: Node) {\r\n        let parent = node;\r\n        while (parent && !parent.getComponent(Canvas)) {\r\n            parent = node.parent;\r\n        }\r\n        return parent;\r\n    }\r\n\r\n    /**\r\n     * 判断是否有指定动作\r\n     * @param ske \r\n     * @param action \r\n     * @returns \r\n     */\r\n    static CheckAnimation(ske: sp.Skeleton, action: string) {\r\n        if (!ske || !ske.skeletonData) return false;\r\n        let actions = ske.skeletonData.getAnimsEnum();\r\n        if (!actions[action]) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * 获取默认动作\r\n     * @param ske \r\n     * @returns \r\n     */\r\n    static GetSkeAciton(ske: sp.Skeleton) {\r\n        let ls = ske.skeletonData.getAnimsEnum();\r\n        for (let k in ls) {\r\n            return k;\r\n        }\r\n    }\r\n\r\n    /**\r\n    * 格式化时间戳\r\n    * @param {string} cusFormat 格式串，eg:'yyyy-MM-dd hh:mm:ss'\r\n    * @返回 格式化后的时间字符串 \r\n    * eg: new Date().format('yyyy-MM-dd hh:mm:ss') -> '2020-06-30 16:28:14'\r\n    */\r\n    static formatDate(cusTime: number, cusFormat: string): string {\r\n        const _date: Date = new Date();\r\n        _date.setTime(cusTime);\r\n\r\n        const _info = {\r\n            'M+': _date.getMonth() + 1,\r\n            'd+': _date.getDate(),\r\n            'h+': _date.getHours(),\r\n            'm+': _date.getMinutes(),\r\n            's+': _date.getSeconds(),\r\n            'q+': Math.floor((_date.getMonth() + 3) / 3),\r\n            'S+': _date.getMilliseconds()\r\n        };\r\n\r\n        if (/(y+)/i.test(cusFormat)) {\r\n            cusFormat = cusFormat.replace(RegExp.$1, (_date.getFullYear() + '').substr(4 - RegExp.$1.length));\r\n        }\r\n\r\n        for (const _key in _info) {\r\n            if (new RegExp('(' + _key + ')').test(cusFormat)) {\r\n                cusFormat = cusFormat.replace(RegExp.$1, RegExp.$1.length === 1\r\n                    ? _info[_key] : ('00' + _info[_key]).substr(('' + _info[_key]).length));\r\n            }\r\n        }\r\n        return cusFormat;\r\n    }\r\n\r\n    /**\r\n     * 计算屏幕投射到场景的点\r\n     * @param screenX\r\n     * @param screenY\r\n     * @param camera \r\n     * @param plane \r\n     * @returns \r\n     */\r\n    static ScreenToPlane(screenX: number, screenY: number, camera: Camera, plane: geometry.Plane, len?: number) {\r\n        camera.screenPointToRay(screenX, screenY, $ray1);\r\n        if (!len) len = geometry.intersect.rayPlane($ray1, plane);\r\n        $ray1.computeHit($v1, len);\r\n        return [$v1.x, $v1.y, $v1.z];\r\n    }\r\n\r\n    /**\r\n     * 使节点朝向目标\r\n     */\r\n    static FaceToNode(a: Node | Vec3, b: Node | Vec3, out?: math.Quat) {\r\n        if (a instanceof Node) {\r\n            a.getWorldPosition($v1);\r\n        } else {\r\n            $v1.set(a);\r\n        }\r\n        if (b instanceof Node) {\r\n            b.getWorldPosition($v2);\r\n        } else {\r\n            $v2.set(b);\r\n        }\r\n        Vec3.subtract($v3, $v2, $v1); // 方向向量 = B 坐标 - A 坐标\r\n        math.Quat.fromEuler($q1, $v3.x, $v3.y, $v3.z);\r\n\r\n        // math.Quat.fromViewUp(q1, v3_3); // 根据方向向量生成旋转\r\n        if (a instanceof Node) a.setWorldRotation($q1);\r\n        if (out) out.set($q1);\r\n    }\r\n\r\n    /**\r\n     * 计算节点的平面\r\n     * @param node \r\n     * @returns \r\n     */\r\n    static GetPlane(node: Node, v: Vec3 = Vec3.UNIT_Y) {\r\n        node.getWorldMatrix($mat1);\r\n        Vec3.transformMat4($v1, v, $mat1);\r\n        Vec3.subtract($v2, $v1, node.worldPosition);\r\n        return geometry.Plane.create($v2.x, $v2.y, $v2.z, node.worldPosition.length());\r\n    }\r\n\r\n    /**\r\n     * 尝试检测节点的尺寸\r\n     * @param node \r\n     */\r\n    static TestSize(node: Node, isScale: boolean = false) {\r\n        let defScaleX: number = isScale ? Math.abs(node.scale.x) : 1;\r\n        let defScaleY: number = isScale ? Math.abs(node.scale.y) : 1;\r\n        let sf = node.getComponent(SpriteRenderer)?.spriteFrame;\r\n        if (sf) return [sf.width * defScaleX, sf.height * defScaleY];\r\n        sf = node.getComponent(Sprite)?.spriteFrame;\r\n        if (sf) return [sf.width * defScaleX, sf.height * defScaleY];\r\n        let trans = node.getComponent(UITransform);\r\n        if (trans) return [trans.contentSize.width * defScaleX, trans.contentSize.height * defScaleY];\r\n        return [0, 0];\r\n    }\r\n\r\n    /**\r\n     * 计算3dui适配高度的值\r\n     * @param height \r\n     * @param camera \r\n     * @returns \r\n     */\r\n    static TestUIHigh(height: number, camera: Camera) {\r\n        const fovRad = camera.fov * Math.PI / 180; // 转为弧度\r\n        const distance = height / (2 * Math.tan(fovRad / 2));\r\n        return distance;\r\n    }\r\n\r\n    /**\r\n     * 节点到另一节点的向量\r\n     * @param node1 \r\n     * @param node2 \r\n     * @returns \r\n     */\r\n    static NodeSubNode(node1: Node, node2: Node) {\r\n\r\n        node1.getWorldPosition($v1);\r\n        node2.getWorldPosition($v2);\r\n        Vec3.subtract($v3, $v1, $v2);\r\n        return [$v3.x, $v3.y, $v3.z, $v3.length()];\r\n    }\r\n\r\n    /**\r\n     * 计算模型尺寸\r\n     * @param box \r\n     * @returns \r\n     */\r\n    static CountBoundSize(box: MeshRenderer) {\r\n        const boundingBox = box.model.worldBounds;\r\n        boundingBox.getBoundary($v1, $v2);\r\n        Vec3.subtract($v3, $v2, $v1);\r\n        return [Math.abs($v3.x), Math.abs($v3.y), Math.abs($v3.z)];\r\n    }\r\n\r\n    /**\r\n     * 计算从向量A到向量B的四元数旋转\r\n     * @param a 起始向量（需归一化）\r\n     * @param b 目标向量（需归一化）\r\n     * @param out 输出四元数（可选）\r\n     */\r\n    static EulerAngles(a: Vec3, b: Vec3) {\r\n        const epsilon = 1e-6; // 浮点误差阈值\r\n\r\n        // 计算叉乘轴\r\n        Vec3.cross($v1, a, b);\r\n\r\n        // 处理向量共线的情况\r\n        if ($v1.length() < epsilon) {\r\n            // 方向相同：返回单位四元数\r\n            if (Vec3.dot(a, b) > 0) return [$v2.x, $v2.y, $v2.z];\r\n            // 方向相反：绕Y轴旋转180度（可自定义其他轴）\r\n            math.Quat.fromAxisAngle($q1, Vec3.UP, Math.PI);\r\n            return [$v2.x, $v2.y, $v2.z];\r\n        }\r\n\r\n        // 计算旋转角度\r\n        $v1.normalize();\r\n        const cosTheta = Vec3.dot(a, b);\r\n        const theta = Math.acos(Math.min(1, Math.max(-1, cosTheta))); // 限制精度范围\r\n\r\n        // 生成四元数\r\n        math.Quat.fromAxisAngle($q1, $v1, theta);\r\n        $q1.getEulerAngles($v2);\r\n\r\n        return [$v2.x, $v2.y, $v2.z];\r\n    }\r\n\r\n    /**\r\n     * 按位数获取比特位值(高位)\r\n     * @param value \r\n     * @param bitPos \r\n     * @returns \r\n     */\r\n    public static GetBitPosHiValue(value: number, bitPos: number): number {\r\n        if (bitPos <= 0 || bitPos > 32) {\r\n            throw new Error(\"位数必须在 1 到 32 之间\");\r\n        }\r\n        let rightOffset: number = 32 - bitPos;\r\n        let bitValue = (value >>> rightOffset) & ((1 << bitPos) - 1);\r\n        return bitValue;\r\n    }\r\n\r\n    /**\r\n     * 按位数获取比特位值(低位)\r\n     * @param value \r\n     * @param bitPos \r\n     * @returns \r\n     */\r\n    public static GetBitPosLowValue(value: number, bitPos: number): number {\r\n        let mask: number = (1 << bitPos) - 1;\r\n        return value & mask;\r\n    }\r\n\r\n    /**\r\n     * 获取某位bit的值\r\n     * @param value \r\n     * @param bit \r\n     * @returns \r\n     */\r\n    public static GetBitValue(value: number, bit: number): number {\r\n        if (bit <= 0 || bit > 32) {\r\n            throw new Error(\"位数必须在 1 到 32 之间\");\r\n        }\r\n        let bitValue: number = (value >> bit) & 0x1;\r\n        return bitValue;\r\n    }\r\n\r\n    /**\r\n     * 设置固定头部比特位的值\r\n     * @param target 目标值（32 位整型）\r\n     * @param headValue 头部比特位的值（十进制）\r\n     * @param headBitCount 头部比特位的位数\r\n     * @param args 可变参数，表示从头部之后要设置的比特位值（0 或 1）\r\n     * @returns 设置后的值\r\n     */\r\n    public SetHeadFixedBits(target: number, headValue: number, headBitCount: number, ...args: number[]): number {\r\n        if (headValue < 0 || headValue >= (1 << headBitCount)) {\r\n            throw new Error(`headValue必须在0和之间${(1 << headBitCount) - 1}`);\r\n        }\r\n        let clearMask: number = ~(((1 << headBitCount) - 1));\r\n        target = target & clearMask;\r\n        target = target | headValue;\r\n        for (let i = 0; i < args.length; i++) {\r\n            let bitValue: number = args[i];\r\n            if (bitValue !== 0 && bitValue !== 1) {\r\n                throw new Error(\"位数值必须在 0 或者 1\");\r\n            }\r\n            let bitPosition = headBitCount + i;\r\n            if (bitValue === 1) {\r\n                target = target | (1 << bitPosition);\r\n            } else {\r\n                target = target & ~(1 << bitPosition);\r\n            }\r\n        }\r\n        return target;\r\n    }\r\n\r\n    static SetNodeGray(target: Node, gray: boolean = false, disabled: boolean = true) {\r\n        //console.warn(\"此方法有问题！暂时不要用\");\r\n        //return;\r\n        let mat: Material = builtinResMgr.get(gray ? \"ui-sprite-gray-material\" : \"\") || null;\r\n        let renderList = target.getComponentsInChildren(UIRenderer);\r\n        let btn: Button;\r\n        for (let rend of renderList) {\r\n            btn = rend.node.getComponent(Button);\r\n            if (btn && disabled) btn.interactable = !gray;\r\n            rend.customMaterial = mat;\r\n        }\r\n    }\r\n\r\n    static pointToLineDistance3DOptimized(\r\n        point: Vec3,\r\n        linePoint1: Vec3,\r\n        linePoint2: Vec3\r\n    ): number {\r\n        const direction = linePoint2.clone().subtract(linePoint1);\r\n        const AP = point.clone().subtract(linePoint1);\r\n        const cross = new Vec3();\r\n        Vec3.cross(cross, AP, direction.normalize()); // 先归一化，避免最后除以长度\r\n        return cross.length();\r\n    }\r\n\r\n    private static _roolObjMap: { [key: number]: any } = {};\r\n    /*** 滚动数字*/\r\n    static NumberRool(target: Label | RichText | SpriteLabel, curValue: number, targetValue: number, dur: number = 0.3, callBack: Function = null): void {\r\n        if (curValue == targetValue) {\r\n            target.string = targetValue.toString();\r\n            return;\r\n        }\r\n        const uid: string = target.uuid;\r\n        const cv: number = curValue;\r\n        const tv: number = targetValue;\r\n        let roolObj: any = this._roolObjMap[uid];\r\n        if (roolObj != undefined) {\r\n            Tween.stopAllByTarget(roolObj);\r\n        }\r\n        roolObj = { value: curValue };\r\n        this._roolObjMap[uid] = roolObj;\r\n        let opts: any = js.createMap();\r\n        opts.onUpdate = (t: { value: number }, ratio: number) => {\r\n            if (target) {\r\n                if ((cv % 1 !== 0) || (tv % 1 != 0)) {\r\n                    target.string = this.formatNumber(t.value, 2);\r\n                } else {\r\n                    target.string = Math.floor(t.value).toString();\r\n                }\r\n\r\n            }\r\n        };\r\n        tween(roolObj)\r\n            .to(dur, { value: targetValue }, opts)\r\n            .call(() => {\r\n                if (callBack) callBack();\r\n                delete this._roolObjMap[uid];\r\n            })\r\n            .start();\r\n    }\r\n\r\n\r\n    /**\r\n     * 保存本地\r\n     * @param data \r\n     * @param fileName \r\n     */\r\n    static SaveFile(data: string, fileName: string) {\r\n        // 创建一个Blob实例，里面包含要下载的数据\r\n        const blob = new Blob([data], { type: 'text/plain;charset=utf-8' });\r\n\r\n        // 创建一个指向Blob对象的URL地址\r\n        const url = URL.createObjectURL(blob);\r\n\r\n        // 创建一个a标签\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.setAttribute('download', fileName);\r\n\r\n        // 触发下载\r\n        document.body.appendChild(link);\r\n        link.click();\r\n\r\n        // 清理并移除元素和对象URL\r\n        document.body.removeChild(link);\r\n        URL.revokeObjectURL(url);\r\n    }\r\n\r\n    static CopyProto(obj: any, classz: any) {\r\n        if (this.IsArray(obj)) {\r\n            let datas = obj as any[];\r\n            let ls = [];\r\n            for (let data of datas) {\r\n                ls.push(classz.decode(classz.encode(data).finish()));\r\n            }\r\n            return ls;\r\n        } else {\r\n            return classz.decode(classz.encode(obj).finish())\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * 在指定圆弧上生成等分点\r\n     * @param center 圆心\r\n     * @param pointA 起点\r\n     * @param pointB 终点\r\n     * @param numSegments 分段数（生成的点数 = 分段数 + 1）\r\n     * @returns 等分点数组\r\n    */\r\n    static GenerateArcPoints(center: Vec3, pointA: Vec3, pointB: Vec3, numSegments: number): Vec3[] {\r\n        if (numSegments <= 0) return [];\r\n\r\n        // 转换为相对于圆心的坐标\r\n        const dxA = pointA.x - center.x;\r\n        const dyA = pointA.y - center.y;\r\n        const dxB = pointB.x - center.x;\r\n        const dyB = pointB.y - center.y;\r\n\r\n        // 计算半径（假设两点在同一圆上）\r\n        const radiusA = Math.hypot(dxA, dyA);\r\n        const radiusB = Math.hypot(dxB, dyB);\r\n        if (Math.abs(radiusA - radiusB) > 1e-6) {\r\n            console.error(\"Error: Points A and B must be on the same circle.\");\r\n            return [];\r\n        }\r\n        const radius = radiusA;\r\n\r\n        // 计算极角并标准化到 [0, 2π)\r\n        let thetaA = Math.atan2(dyA, dxA);\r\n        let thetaB = Math.atan2(dyB, dxB);\r\n        thetaA = (thetaA + 2 * Math.PI) % (2 * Math.PI);\r\n        thetaB = (thetaB + 2 * Math.PI) % (2 * Math.PI);\r\n\r\n        // 计算角度差（自动处理方向）\r\n        let deltaTheta = thetaB - thetaA;\r\n        deltaTheta = ((deltaTheta + Math.PI) % (2 * Math.PI)) - Math.PI; // 调整到 [-π, π]\r\n\r\n        const absDeltaTheta = Math.abs(deltaTheta);\r\n        if (absDeltaTheta < 1e-6) { // 两点重合\r\n            return Array(numSegments + 1).fill(Vec3.clone(pointA));\r\n        }\r\n\r\n        const points: Vec3[] = [];\r\n        const angleStep = absDeltaTheta / numSegments;\r\n\r\n        for (let i = 0; i <= numSegments; i++) {\r\n            let currentTheta = thetaA + (deltaTheta > 0 ? angleStep * i : -angleStep * i);\r\n            currentTheta = (currentTheta + 2 * Math.PI) % (2 * Math.PI); // 保持标准化\r\n            const x = center.x + Math.cos(currentTheta) * radius;\r\n            const y = center.y + Math.sin(currentTheta) * radius;\r\n            points.push(new Vec3(x, y));\r\n        }\r\n\r\n        return points;\r\n    }\r\n\r\n    /**\r\n     * 给3dUI添加交互效果\r\n     * @param node \r\n     * @param canvas \r\n     */\r\n    static AddTouchEffect(node: Node, hitTest: (e:EventTouch) => boolean, thisObj: any, canvas: Node) {\r\n        if (!canvas) canvas = find(\"Cavnas\");\r\n        node['$$hitTest'] = hitTest.bind(thisObj);\r\n        canvas.on(Input.EventType.TOUCH_START, this.onTouchStart3D, node);\r\n        canvas.on(Input.EventType.TOUCH_END, this.onTouchEnd3D, node);\r\n        canvas.on(Input.EventType.TOUCH_CANCEL, this.onTouchEnd3D, node);\r\n    }\r\n\r\n    /**\r\n     * 移除3dUI的按钮效果\r\n     * @param node \r\n     * @param canvas \r\n     */\r\n    static DelTouchEffect(node: Node, canvas: Node) {\r\n        if (!canvas) canvas = find(\"Cavnas\");\r\n        canvas.off(Input.EventType.TOUCH_START, this.onTouchStart3D, node);\r\n        canvas.off(Input.EventType.TOUCH_END, this.onTouchEnd3D, node);\r\n        canvas.off(Input.EventType.TOUCH_CANCEL, this.onTouchEnd3D, node);\r\n    }\r\n\r\n    static onTouchStart3D(e: EventTouch) {\r\n        let node: Node = <unknown>this as Node;\r\n        if (!node['$$hitTest'](e)) return;\r\n        if (node.getChildByName(\"onTouchStart\")) {\r\n            node.getChildByName(\"onTouchStart\").active = true;\r\n            return;\r\n        }\r\n        if (!node['$initScale']) {\r\n            node['$initScale'] = node.scale.clone();\r\n        }\r\n        const radio = 1.15;\r\n        node.setScale(node.scale.x * radio, node.scale.y * radio, node.scale.z * radio);\r\n    }\r\n\r\n    static onTouchEnd3D(e: EventTouch) {\r\n        let node: Node = <unknown>this as Node;\r\n        if (node.getChildByName(\"onTouchStart\")) {\r\n            node.getChildByName(\"onTouchStart\").active = false;\r\n            return;\r\n        }\r\n        if (!node['$initScale']) return;\r\n        node.setScale(node['$initScale'].x, node['$initScale'].y, node['$initScale'].z);\r\n    }\r\n}"]}