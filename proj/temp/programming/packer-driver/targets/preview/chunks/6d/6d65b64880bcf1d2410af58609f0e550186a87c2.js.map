{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/common/HaveItem.ts"],"names":["HaveItem","Component","Label","path","Sprite","SpriteFrame","CfgMgr","folder_item","ResMgr","PlayerData","EventMgr","Evt_Item_Change","icon","numLab","itemId","std","isInit","onLoad","node","getChildByPath","getComponent","updateShow","onEnable","on","onItemChange","onDisable","off","changeMap","undefined","updateNum","SetData","notNumColor","Items","Getitem","LoadResAbSub","join","Icon","res","spriteFrame","haveNum","GetItemCount","string"],"mappings":";;;gMAQaA,Q;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AARGC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,W,OAAAA,W;;AACvCC,MAAAA,M,iBAAAA,M;;AACAC,MAAAA,W,iBAAAA,W;AAA2BC,MAAAA,M,iBAAAA,M;;AAC3BC,MAAAA,U,iBAAAA,U;;AACAC,MAAAA,Q,iBAAAA,Q;AAAUC,MAAAA,e,iBAAAA,e;;;;;;;;;AACnB;AACA;AACA;0BACaX,Q,GAAN,MAAMA,QAAN,SAAuBC,SAAvB,CAAiC;AAAA;AAAA;AAAA,eAC5BW,IAD4B;AAAA,eAE5BC,MAF4B;AAAA,eAG5BC,MAH4B,GAGX,CAHW;AAAA,eAI5BC,GAJ4B;AAAA,eAK5BC,MAL4B,GAKV,KALU;AAAA;;AAM1BC,QAAAA,MAAM,GAAS;AACrB,eAAKL,IAAL,GAAY,KAAKM,IAAL,CAAUC,cAAV,CAAyB,MAAzB,EAAiCC,YAAjC,CAA8ChB,MAA9C,CAAZ;AACA,eAAKS,MAAL,GAAc,KAAKK,IAAL,CAAUC,cAAV,CAAyB,QAAzB,EAAmCC,YAAnC,CAAgDlB,KAAhD,CAAd;AACA,eAAKc,MAAL,GAAc,IAAd;AACA,cAAI,KAAKF,MAAL,GAAc,CAAlB,EAAqB,KAAKO,UAAL;AACxB;;AAESC,QAAAA,QAAQ,GAAS;AACvB;AAAA;AAAA,oCAASC,EAAT;AAAA;AAAA,kDAA6B,KAAKC,YAAlC,EAAgD,IAAhD;AAEH;;AAESC,QAAAA,SAAS,GAAS;AACxB;AAAA;AAAA,oCAASC,GAAT;AAAA;AAAA,kDAA8B,KAAKF,YAAnC,EAAiD,IAAjD;AAEH;;AAEOA,QAAAA,YAAY,CAACG,SAAD,EAA6C;AAC7D,cAAIA,SAAS,CAAC,KAAKb,MAAN,CAAT,IAA0Bc,SAA9B,EAAyC;AACrC,iBAAKC,SAAL;AACH;AACJ;;AAEDC,QAAAA,OAAO,CAAChB,MAAD,EAAkBiB,WAAlB,EAA8C;AACjD,eAAKjB,MAAL,GAAcA,MAAd;AACA,eAAKO,UAAL;AACH;;AAEQA,QAAAA,UAAU,GAAS;AACxB,cAAI,CAAC,KAAKL,MAAN,IAAgB,KAAKF,MAAL,GAAc,CAAlC,EAAqC;;AACrC,cAAI,CAAC,KAAKC,GAAN,IAAc,KAAKA,GAAL,IAAY,KAAKD,MAAL,IAAe,KAAKC,GAAL,CAASiB,KAAtD,EAA8D;AAC1D,iBAAKjB,GAAL,GAAW;AAAA;AAAA,kCAAOkB,OAAP,CAAe,KAAKnB,MAApB,CAAX;AACH;;AACD,cAAI,KAAKC,GAAT,EAAc;AACV;AAAA;AAAA,kCAAOmB,YAAP,CAAoB/B,IAAI,CAACgC,IAAL;AAAA;AAAA,4CAAuB,KAAKpB,GAAL,CAASqB,IAAhC,EAAsC,aAAtC,CAApB,EAA0E/B,WAA1E,EAAwFgC,GAAD,IAAsB;AACzG,mBAAKzB,IAAL,CAAU0B,WAAV,GAAwBD,GAAxB;AACH,aAFD;AAGA,iBAAKR,SAAL;AACH;AACJ;;AAEOA,QAAAA,SAAS,GAAS;AACtB,cAAIU,OAAe,GAAG;AAAA;AAAA,wCAAWC,YAAX,CAAwB,KAAK1B,MAA7B,CAAtB;AACA,eAAKD,MAAL,CAAY4B,MAAZ,QAAwBF,OAAxB;AACH;;AAlDmC,O","sourcesContent":["import { Color, Component, Label, path, Sprite, SpriteFrame } from \"cc\";\r\nimport { CfgMgr, ItemType, StdItem } from \"../../manager/CfgMgr\";\r\nimport { folder_item, folder_money, ResMgr } from \"../../manager/ResMgr\";\r\nimport { PlayerData } from \"../player/PlayerData\";\r\nimport { EventMgr, Evt_Item_Change } from \"../../manager/EventMgr\";\r\n/**\r\n * 拥有道具展示\r\n */\r\nexport class HaveItem extends Component {\r\n    private icon: Sprite;\r\n    private numLab: Label;\r\n    private itemId: number = 0;\r\n    private std: StdItem;\r\n    private isInit: boolean = false;\r\n    protected onLoad(): void {\r\n        this.icon = this.node.getChildByPath(\"icon\").getComponent(Sprite);\r\n        this.numLab = this.node.getChildByPath(\"numLab\").getComponent(Label);\r\n        this.isInit = true;\r\n        if (this.itemId > 0) this.updateShow();\r\n    }\r\n\r\n    protected onEnable(): void {\r\n        EventMgr.on(Evt_Item_Change, this.onItemChange, this);\r\n\r\n    }\r\n\r\n    protected onDisable(): void {\r\n        EventMgr.off(Evt_Item_Change, this.onItemChange, this);\r\n\r\n    }\r\n\r\n    private onItemChange(changeMap: { [key: number]: number }): void {\r\n        if (changeMap[this.itemId] != undefined) {\r\n            this.updateNum();\r\n        }\r\n    }\r\n\r\n    SetData(itemId: number,  notNumColor?: string): void {\r\n        this.itemId = itemId;\r\n        this.updateShow();\r\n    }\r\n\r\n    private  updateShow(): void {\r\n        if (!this.isInit || this.itemId < 1) return;\r\n        if (!this.std || (this.std && this.itemId != this.std.Items)) {\r\n            this.std = CfgMgr.Getitem(this.itemId);\r\n        }\r\n        if (this.std) {\r\n            ResMgr.LoadResAbSub(path.join(folder_item, this.std.Icon, \"spriteFrame\"), SpriteFrame, (res: SpriteFrame) => {\r\n                this.icon.spriteFrame = res;\r\n            });\r\n            this.updateNum();\r\n        }\r\n    }\r\n\r\n    private updateNum(): void {\r\n        let haveNum: number = PlayerData.GetItemCount(this.itemId);\r\n        this.numLab.string = `${haveNum}`;\r\n    }\r\n\r\n}"]}