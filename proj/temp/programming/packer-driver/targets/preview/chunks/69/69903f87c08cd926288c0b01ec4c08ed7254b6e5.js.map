{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/rights/GatePassBuyPanel.ts"],"names":["GatePassBuyPanel","Button","Label","Layout","ScrollView","Sprite","UITransform","instantiate","Panel","CfgMgr","Second","prefab","bg","unLock1","unLock2","buyBtn1","buyBtn2","scroller1","scroller2","upLabel","clone_item_1","clone_item_2","width","onLoad","CloseBy","find","node","on","EventType","CLICK","onClick","onShow","flush","seaid","seapass","getSeaGatepass","content","removeAllChildren","index","BuyDes","length","element","item_1","updateItem","addChild","item_2","is_can_buy","active","getChildByPath","children","forEach","item","des","getChildByName","getComponent","height","contentSize","setContentSize","updateLayout","data","string","e","name","onHide"],"mappings":"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","sourcesContent":["import {Button, Input, Label, Layout, Node, ScrollView, Sprite, Toggle, UITransform, instantiate } from \"cc\";\r\nimport { Panel } from \"../../manager/GameRoot\";\r\nimport { AutoScroller } from \"../../component/AutoScroller\";\r\nimport { CfgMgr, StdSeaGatepass } from \"../../manager/CfgMgr\";\r\nimport { Second } from \"../../utils/Utils\";\r\n\r\nexport class GatePassBuyPanel extends Panel {\r\n    protected prefab: string = \"prefabs/rights/GatePassBuyPanel\";\r\n    \r\n    private bg:Sprite;\r\n    private unLock1;\r\n    private unLock2;\r\n    private buyBtn1:Button;\r\n    private buyBtn2:Button;\r\n    protected scroller1: ScrollView;\r\n    protected scroller2: ScrollView;\r\n    private upLabel:Label;\r\n    private clone_item_1:Node;\r\n    private clone_item_2:Node;\r\n    private width = 345\r\n    protected onLoad() {\r\n        this.CloseBy(\"backBtn\");\r\n        this.bg = this.find(\"bg\", Sprite);\r\n        this.unLock1 = this.find(\"general/unLock\");\r\n        this.unLock2 = this.find(\"advance/unLock\");\r\n        this.buyBtn1 = this.find(\"general/generalBuyBtn\", Button);\r\n        this.buyBtn2 = this.find(\"advance/advanceBuyBtn\", Button);\r\n        this.scroller1 = this.find(\"general/ScrollView\", ScrollView);\r\n        this.clone_item_1 = this.find(\"general/ScrollView/view/content/item\");\r\n        this.scroller2 = this.find(\"advance/ScrollView\", ScrollView);\r\n        this.clone_item_2 = this.find(\"advance/ScrollView/view/content/item\");\r\n        this.upLabel = this.find(\"advance/upBg/upLabel\",Label);\r\n      \r\n\r\n        this.buyBtn1.node.on(Button.EventType.CLICK, this.onClick, this)\r\n        this.buyBtn2.node.on(Button.EventType.CLICK, this.onClick, this)\r\n    }\r\n\r\n    protected onShow(): void {\r\n     \r\n    }\r\n\r\n    public async flush(...args: any[]) {\r\n        let seaid = 10001;\r\n        let seapass:StdSeaGatepass[] = CfgMgr.getSeaGatepass(seaid);\r\n        this.scroller1.content.removeAllChildren();\r\n        this.scroller2.content.removeAllChildren();\r\n\r\n        for (let index = 0; index < seapass[1].BuyDes.length; index++) {\r\n            const element = seapass[1].BuyDes[index];\r\n            let item_1 = instantiate(this.clone_item_1)\r\n            this.updateItem(item_1, element, index);\r\n            this.scroller1.content.addChild(item_1)\r\n        }\r\n\r\n        for (let index = 0; index < seapass[2].BuyDes.length; index++) {\r\n            const element = seapass[2].BuyDes[index];\r\n            let item_2 = instantiate(this.clone_item_2)\r\n            this.updateItem(item_2, element, index);\r\n            this.scroller2.content.addChild(item_2)\r\n        }\r\n        let is_can_buy = false;\r\n        this.unLock1.active = is_can_buy;\r\n        this.unLock2.active = is_can_buy;\r\n        this.buyBtn1.node.active = !is_can_buy;\r\n        this.buyBtn2.node.active = !is_can_buy;   \r\n        await Second(0.1)\r\n        this.scroller1.node.getChildByPath(\"view/content\").children.forEach((item)=>{\r\n            let des = item.getChildByName(\"TipsLabel\").getComponent(Label)\r\n            let height = des.getComponent(UITransform).contentSize.height\r\n            item.getComponent(UITransform).setContentSize(this.width, height)\r\n        })\r\n        this.scroller2.node.getChildByPath(\"view/content\").children.forEach((item)=>{\r\n            let des = item.getChildByName(\"TipsLabel\").getComponent(Label)\r\n            let height = des.getComponent(UITransform).contentSize.height\r\n            item.getComponent(UITransform).setContentSize(this.width, height)\r\n        })\r\n        this.scroller1.node.getChildByPath(\"view/content\").getComponent(Layout).updateLayout()\r\n        this.scroller2.node.getChildByPath(\"view/content\").getComponent(Layout).updateLayout()\r\n    }\r\n    protected updateItem(item: Node, data: string, index: number) {\r\n        let des = item.getChildByName(\"TipsLabel\").getComponent(Label);\r\n        des.string = data\r\n    }\r\n\r\n\r\n    private onClick(e:Button){\r\n        let name = e.name\r\n        switch (name) {\r\n            case \"generalBuyBtn\":\r\n                \r\n                break;\r\n            case \"advanceBuyBtn\":\r\n                \r\n                break;\r\n        \r\n            default:\r\n                break;\r\n        }\r\n\r\n    }\r\n    protected onHide(...args: any[]): void {\r\n    }\r\n\r\n}\r\n"]}