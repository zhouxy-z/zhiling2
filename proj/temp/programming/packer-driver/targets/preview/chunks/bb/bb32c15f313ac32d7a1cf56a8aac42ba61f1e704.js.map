{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/bag/BagPanel1.ts"],"names":["BagPanel1","Input","Label","Toggle","BagItem1","ComposePanel","EventMgr","Evt_Item_Change","OpenBoxPanel1","Panel","AutoScroller","PlayerData","CfgMgr","ItemSubType","ItemType","MsgPanel","prefab","page","page1","scroller1","page2","scroller2","page3","scroller3","item","selectName","selectDesc","selectHas","empty","useBtns","navBtns","scroller","selectData","datas","_curSelectIndex","onLoad","CloseBy","find","getChildByPath","getComponent","SetHandle","updateBagItem","bind","node","on","SelectItem","addComponent","children","concat","EventType","TOUCH_END","openJiaoyi","openHecheng","openUse","openGet","btn","onPage","onItemChange","SetPage","isOperat","$hasLoad","initSub","undefined","isChecked","onShow","flush","onHide","parent","std","Getitem","id","SubType","currency","showByItemId","Items","Itemtpye","box","Show","t","indexOf","active","GetitemBySubType","prop","sort","commSort","chipSort","factor","length","updateListData","UpdateDatas","resetSelect","cont","selectIndex","defSelect","index","itemIndex","getChildByName","a","b","stdA","stdB","Sort","data","bagItem","setIsShowSelect","setIsShowRedPoint","SetData","ScrollToHead","interactable","string","ItemName","Remark","count","money","btnNode","redNode","i","Button"],"mappings":"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","sourcesContent":["import { Input, Label, Node, Toggle } from \"cc\";\r\n\r\nimport { BagItem1 } from \"./BagItem1\";\r\nimport { ComposePanel } from \"./ComposePanel\";\r\nimport { EventMgr, Evt_Item_Change} from \"../../manager/EventMgr\";\r\nimport { OpenBoxPanel1 } from \"./OpenBoxPanel1\";\r\nimport { Panel } from \"../../manager/GameRoot\";\r\nimport { AutoScroller } from \"../../component/AutoScroller\";\r\nimport { SThing } from \"../player/PlayerStruct\";\r\nimport { PlayerData } from \"../player/PlayerData\";\r\nimport { CfgMgr, ItemSubType, ItemType } from \"../../manager/CfgMgr\";\r\nimport { MsgPanel } from \"../common/MsgPanel\";\r\n\r\n\r\nexport class BagPanel1 extends Panel {\r\n    protected prefab: string = \"prefabs/bag/BagPanel1\";\r\n\r\n    private page: number;\r\n    private page1: Node;\r\n    private scroller1: AutoScroller;\r\n    private page2: Node;\r\n    private scroller2: AutoScroller;\r\n    private page3: Node;\r\n    private scroller3: AutoScroller;\r\n    private item: BagItem1;\r\n    private selectName: Label;\r\n    private selectDesc: Label;\r\n    private selectHas: Label;\r\n    private empty: Node;\r\n    private useBtns: Node[];\r\n    private navBtns: Node[];\r\n    private scroller: AutoScroller;\r\n    private selectData: SThing;\r\n    private datas: SThing[];\r\n    private _curSelectIndex:number;\r\n    protected onLoad() {\r\n        this.CloseBy(\"layout/closeBtn\");\r\n        this.CloseBy(\"mask\");\r\n        this.page1 = this.find(\"layout/page1\");\r\n        this.scroller1 = this.page1.getChildByPath(\"ScrollView\").getComponent(AutoScroller);\r\n        this.scroller1.SetHandle(this.updateBagItem.bind(this));\r\n        this.scroller1.node.on('select', this.SelectItem, this);\r\n\r\n        this.page2 = this.find(\"layout/page2\");\r\n        this.scroller2 = this.page2.getChildByPath(\"ScrollView\").getComponent(AutoScroller);\r\n        this.scroller2.SetHandle(this.updateBagItem.bind(this));\r\n        this.scroller2.node.on('select', this.SelectItem, this);\r\n\r\n        this.page3 = this.find(\"layout/page3\");\r\n        this.scroller3 = this.page3.getChildByPath(\"ScrollView\").getComponent(AutoScroller);\r\n        this.scroller3.SetHandle(this.updateBagItem.bind(this));\r\n        this.scroller3.node.on('select', this.SelectItem, this);\r\n\r\n        this.item = this.find(\"layout/infoBar/item\").addComponent(BagItem1);\r\n        this.selectName = this.find(\"layout/infoBar/name\", Label);\r\n        this.selectDesc = this.find(\"layout/infoBar/desc\", Label);\r\n        this.selectHas = this.find(\"layout/infoBar/has\", Label);\r\n        this.empty = this.find(\"layout/infoBar/empty\");\r\n        this.useBtns = this.find(\"layout/infoBar/layout\").children.concat();\r\n\r\n        this.useBtns[0].on(Input.EventType.TOUCH_END, this.openJiaoyi, this);\r\n        this.useBtns[1].on(Input.EventType.TOUCH_END, this.openHecheng, this);\r\n        this.useBtns[2].on(Input.EventType.TOUCH_END, this.openUse, this);\r\n        this.useBtns[3].on(Input.EventType.TOUCH_END, this.openGet, this);\r\n\r\n        this.navBtns = this.find(\"layout/nav\").children.concat();\r\n        for (let btn of this.navBtns) {\r\n            btn.on('toggle', this.onPage, this);\r\n        }\r\n\r\n        EventMgr.on(Evt_Item_Change, this.onItemChange, this);\r\n    }\r\n    async SetPage(page: number, isOperat:boolean = true) {\r\n        if (!this.$hasLoad) await this.initSub;\r\n        if (!this.navBtns[page]) return;\r\n        this.page = undefined;\r\n        this.navBtns[page].getComponent(Toggle).isChecked = true;\r\n        this.onPage(this.navBtns[page].getComponent(Toggle), isOperat);\r\n    }\r\n    protected onShow(): void {\r\n        this.SetPage(0);\r\n    }\r\n    public flush(...args: any[]): void {\r\n\r\n    }\r\n    protected async onHide(...args: any[]) {\r\n        if (!this.$hasLoad) await this.initSub;\r\n        this.scroller = undefined;\r\n        this.datas = undefined;\r\n    }\r\n\r\n    protected onItemChange() {\r\n        if (!this.node.parent) return;\r\n        this.SetPage(this.page, false);\r\n    }\r\n\r\n    protected openJiaoyi() {\r\n        // let buildings = PlayerData.GetBuildingByType(BuildingType.ji_di, 101);\r\n        // let building = buildings ? buildings[0] : undefined;\r\n        // let open_lv = CfgMgr.GetSysOpenCfg(3).ConditionValue1[0]\r\n        // if(building && building.level >= open_lv){\r\n        //     Goto(PANEL_TYPE.TradePanel);\r\n        // }else{\r\n        //    Tips.Show(\"生命树等级不足\");\r\n        // }\r\n    }\r\n    protected openHecheng() {\r\n        let std = CfgMgr.Getitem(this.selectData.item.id);\r\n        if (std.SubType == ItemSubType.currency) {\r\n            ComposePanel.showByItemId(std.Items);\r\n        }\r\n    }\r\n    protected openUse() {\r\n        let std = CfgMgr.Getitem(this.selectData.item.id);\r\n        switch (std.Itemtpye) {\r\n            case ItemType.box://使用宝箱\r\n                OpenBoxPanel1.Show(std);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    protected openGet() {\r\n        // let get_path = CfgMgr.Getitem(this.selectData.id).SkipGet\r\n        // GetMoreWin.Show(get_path)\r\n    }\r\n\r\n    protected onPage(t: Toggle, isOperat:boolean = true) {\r\n        if (!t.isChecked) return;\r\n        if(isOperat) this._curSelectIndex = 0;\r\n        let page = this.navBtns.indexOf(t.node);\r\n        if ((page < 0 || page == this.page)) return;\r\n        \r\n        this.page1.active = false;\r\n        this.page2.active = false;\r\n        this.page3.active = false;\r\n        // console.log(\"onPage\", page);\r\n        switch (page) {\r\n            case 0: // 道具\r\n                this.datas = PlayerData.GetitemBySubType(ItemSubType.prop);\r\n                this.datas.sort(this.commSort);\r\n                this.page1.active = true;\r\n                this.scroller = this.scroller1;\r\n                break;\r\n\r\n            case 1: // 碎片\r\n                this.chipSort();\r\n                this.page2.active = true;\r\n                this.scroller = this.scroller2;\r\n                break;\r\n            case 2: // 资源\r\n                this.datas = PlayerData.GetitemBySubType(ItemSubType.factor);\r\n                this.datas.sort(this.commSort);\r\n                this.page3.active = true;\r\n                this.scroller = this.scroller3;\r\n                break;\r\n            case 3: //装备\r\n                MsgPanel.Show(\"功能未开启\");\r\n                this.SetPage(this.page, false);\r\n                return \r\n                break;\r\n            default:\r\n                this.datas.length = 0;\r\n        }\r\n        this.page = page;\r\n        this.updateListData(isOperat);\r\n    }\r\n    private updateListData(isOperat:boolean):void{\r\n        if (this.scroller && this.datas) {\r\n            this.scroller.UpdateDatas(this.datas);\r\n            this.SelectItem(this._curSelectIndex, isOperat);\r\n        }else{\r\n            this._curSelectIndex = 0;\r\n        }\r\n    }\r\n    private resetSelect():void{\r\n        let cont:Node = this.scroller.node.getChildByPath(\"view/content\");\r\n        let selectIndex:number = -1;\r\n        let defSelect:Node;\r\n        for (let index = 0; index < cont.children.length; index++) {\r\n            let node:Node = cont.children[index];\r\n            let itemIndex:number = node[\"$$index\"];\r\n            if(itemIndex == 0) defSelect = node;\r\n            if(itemIndex == this._curSelectIndex){\r\n                selectIndex = this._curSelectIndex;\r\n                node.getChildByName(\"select\").active = true;\r\n            }else{\r\n                node.getChildByName(\"select\").active = false;\r\n            }\r\n        }\r\n        if(selectIndex < 0){\r\n            selectIndex = 0;\r\n            if(defSelect){\r\n                defSelect.getChildByName(\"select\").active = true;\r\n            }\r\n        }\r\n        this._curSelectIndex = selectIndex;\r\n    }\r\n    private commSort(a:SThing, b:SThing):number{\r\n        let stdA = CfgMgr.Getitem(a.item.id);\r\n        let stdB = CfgMgr.Getitem(b.item.id);\r\n        return stdB.Sort - stdA.Sort;\r\n    }\r\n    private chipSort():void{\r\n        this.datas = PlayerData.GetitemBySubType(ItemSubType.currency);\r\n        this.datas.sort(this.commSort);    \r\n    }\r\n\r\n    private updateBagItem(item: Node, data: SThing, index:number) {\r\n        let bagItem = item.getComponent(BagItem1);\r\n        if (!bagItem) bagItem = item.addComponent(BagItem1);\r\n        bagItem.setIsShowSelect(false);    \r\n        bagItem.setIsShowRedPoint(true);\r\n        bagItem.SetData(data);\r\n        item.getChildByName(\"select\").active = index == this._curSelectIndex;\r\n        \r\n        // console.log(\"updateBagItem===\",data);\r\n    }\r\n    /**\r\n     * 选中道具\r\n     * @param index \r\n     */\r\n    protected async SelectItem(index: number, isOperat:boolean = true) {\r\n        if (!this.$hasLoad) await this.initSub;\r\n        this._curSelectIndex = index;\r\n        this.resetSelect();\r\n        if(this._curSelectIndex == 0 && isOperat) this.scroller.ScrollToHead();\r\n        let data = this.datas[this._curSelectIndex];\r\n        this.selectData = data;\r\n        if (data) {\r\n            this.empty.active = false;\r\n            this.item.node.getComponent(Toggle).interactable = false;\r\n            this.item.SetData(data);\r\n            let std = CfgMgr.Getitem(data.item.id);\r\n            this.selectName.string = std.ItemName;\r\n            this.selectDesc.string = std.Remark;\r\n            let count = data.item.count\r\n            if(std.Itemtpye == ItemType.money){\r\n                count = count / 10000\r\n            }\r\n            this.selectHas.string = `已拥有：${count}`;\r\n            let btnNode:Node;\r\n            let redNode:Node;\r\n            for (let i = 0; i < this.useBtns.length; i++) {\r\n                btnNode = this.useBtns[i];\r\n                if(std.Button.indexOf(i + 1) != -1){\r\n                    btnNode.active = true;\r\n                    redNode = btnNode.getChildByName(\"red_point\");\r\n                    // if(redNode){\r\n                    //     if(i == 1){//碎片红点\r\n                    //         if (std.Type == ThingType.ThingTypeItem && std.Itemtpye == ItemType.shard) {\r\n                    //             redNode.active = data.count >= std.ItemEffect3;\r\n                    //         }else{\r\n                    //             redNode.active = false;\r\n                    //         }\r\n                    //     }else if(i == 2){//宝箱红点\r\n                    //         if (std.Type == ThingType.ThingTypeItem && std.Itemtpye == ItemType.box) {\r\n                    //             redNode.active = true;\r\n                    //         }else{\r\n                    //             redNode.active = false;\r\n                    //         }\r\n                    //     }\r\n                    // }\r\n                }else{\r\n                    btnNode.active = false;\r\n                }              \r\n            }\r\n        } else {\r\n            this.empty.active = true;\r\n        }\r\n    }\r\n}\r\n"]}