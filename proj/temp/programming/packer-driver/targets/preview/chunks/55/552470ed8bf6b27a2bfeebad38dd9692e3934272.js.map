{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/fight/opOutput/Out_PlayerPower.ts"],"names":["Out_PlayerPower","BattleBaseComp","battleDataMgr","start","data","terrainPower","playerPowers","playerPower","isPlayerA","key","areaIdx","basePower","length","powerAttr","cardMulAttr","cardMul","cardTotalPower","getPlayerTerrainCardTotalPow","newPower","finalValue","scene","FlushAreaPower","exit","console","error","reset"],"mappings":";;;6DAOaA,e;;;;;;;;;;;;;;;;;;;;;;AANJC,MAAAA,c,iBAAAA,c;;AACAC,MAAAA,a,iBAAAA,a;;;;;;;AAET;AACA;AACA;iCACaF,e,GAAN,MAAMA,eAAN;AAAA;AAAA,4CAAyF;AAClFG,QAAAA,KAAK,GAAS;AACpB,cAAI,KAAKC,IAAL,CAAUC,YAAd,EAA4B;AACxB,gBAAIC,YAA0E,GAAG,KAAKF,IAAL,CAAUC,YAA3F;AACA,gBAAIE,WAAJ;AACA,gBAAIC,SAAJ;;AACA,iBAAK,IAAIC,GAAT,IAAgBH,YAAhB,EAA8B;AAC1BC,cAAAA,WAAW,GAAGD,YAAY,CAACG,GAAD,CAA1B;AACAD,cAAAA,SAAS,GAAG;AAAA;AAAA,kDAAcA,SAAd,CAAwBC,GAAxB,CAAZ;;AACA,mBAAK,IAAIC,OAAO,GAAG,CAAnB,EAAsBA,OAAO,GAAGH,WAAW,CAACI,SAAZ,CAAsBC,MAAtD,EAA8DF,OAAO,EAArE,EAAyE;AACrE,oBAAIG,SAA0C,GAAGN,WAAW,CAACI,SAAZ,CAAsBD,OAAtB,CAAjD;AACA,oBAAII,WAA4C,GAAGP,WAAW,CAACQ,OAAZ,CAAoBL,OAApB,CAAnD;AACA,oBAAIM,cAAsB,GAAG;AAAA;AAAA,oDAAcC,4BAAd,CAA2CR,GAA3C,EAAgDC,OAAhD,EAAyD,KAAzD,CAA7B;AACA,oBAAIQ,QAAgB,GAAGJ,WAAW,CAACK,UAAZ,GAAyBH,cAAzB,GAA0CH,SAAS,CAACM,UAA3E;AACA,qBAAKC,KAAL,CAAWC,cAAX,CAA0Bb,SAA1B,EAAqCE,OAArC,EAA8CQ,QAA9C;AACH;AACJ;;AAED,iBAAKI,IAAL;AACH,WAjBD,MAiBO;AACHC,YAAAA,OAAO,CAACC,KAAR,CAAc,YAAd;AACA,iBAAKF,IAAL;AACH;AACJ;;AACSG,QAAAA,KAAK,GAAS,CAEvB;;AA1B2F,O","sourcesContent":["import proto from \"../../../net/Protocol\";\r\nimport { BattleBaseComp } from \"../../battle/BattleBaseComp\";\r\nimport { battleDataMgr } from \"../../battle/BattleDataMgr\";\r\n\r\n/**\r\n * 玩家战力变更\r\n */\r\nexport class Out_PlayerPower extends BattleBaseComp<proto.base.IBattleRoomOpOutput_PlayerPower> {\r\n    protected start(): void {\r\n        if (this.data.terrainPower) {\r\n            let playerPowers: { [k: string]: proto.base.IBattleRoomOpOutput_TerrainPower } = this.data.terrainPower;\r\n            let playerPower: proto.base.IBattleRoomOpOutput_TerrainPower;\r\n            let isPlayerA: boolean;\r\n            for (let key in playerPowers) {\r\n                playerPower = playerPowers[key];\r\n                isPlayerA = battleDataMgr.isPlayerA(key);\r\n                for (let areaIdx = 0; areaIdx < playerPower.basePower.length; areaIdx++) {\r\n                    let powerAttr: proto.base.IBattleRoomAttrValue = playerPower.basePower[areaIdx];\r\n                    let cardMulAttr: proto.base.IBattleRoomAttrValue = playerPower.cardMul[areaIdx];\r\n                    let cardTotalPower: number = battleDataMgr.getPlayerTerrainCardTotalPow(key, areaIdx, false);\r\n                    let newPower: number = cardMulAttr.finalValue * cardTotalPower + powerAttr.finalValue;\r\n                    this.scene.FlushAreaPower(isPlayerA, areaIdx, newPower);\r\n                }\r\n            }\r\n            \r\n            this.exit();\r\n        } else {\r\n            console.error(\"玩家战力变更数据为空\");\r\n            this.exit();\r\n        }\r\n    }\r\n    protected reset(): void {\r\n        \r\n    }\r\n}"]}