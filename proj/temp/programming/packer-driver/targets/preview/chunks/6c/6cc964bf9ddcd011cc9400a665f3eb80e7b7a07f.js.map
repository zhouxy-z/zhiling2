{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/shop/ShopPanel1.ts"],"names":["ShopPanel1","js","ShopLuckyPage","ShopDayPage","EventMgr","Evt_Change_Scene_Bgm","Evt_Currency_Updtae","Evt_Hide_Scene","Evt_Item_Change","Evt_Show_Scene","ShopTabBtnItem","ShopWeekPage","Session","ShopTempPage","Panel","AutoScroller","CfgMgr","ShopGroupId","ShopType","BeforeGameUtils","ItemUtil","ConsumeItem","ConsumeNumFormatType","Req","Route","prefab","haveItemList","luckyPage","dayPage","weekPage","tempPage","tabBtnList","tabDatas","curTabIndex","shopPageInfo","ShopGroupInfo","toHashMapObj","BaseShop","LuckyShop","TabSort","ShopName","DayShop","WeekShop","TempShop","onLoad","find","SetHandle","updateHaveItem","bind","updateTabBtnItem","node","on","onTabBtnSelect","getChildByName","addComponent","Hide","onHide","CloseBy","onShow","emit","getClassName","shop_index","shopIndexId","Send","onCurrencyUpdate","onItemChange","getClassByName","off","flush","shopGroupId","showShopList","defShowList","stdShopGroup","stdShopIndex","index","length","GetShopIndex","SystemOpen","push","sort","a","b","UpdateDatas","SelectFirst","update","dt","updateHave","haveItems","tabData","GetSThingList","MoneyType","MoneyID","updateTabSelect","shopType","shopBasePage","key","Number","SetData","item","data","consumeItem","getComponent","numFormatType","Have","tabBtnItem","select","active","resetSelect","itemIndex","children"],"mappings":"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","sourcesContent":["import { Node, Toggle, js } from \"cc\";\r\nimport { ShopLuckyPage } from \"./ShopLuckyPage\";\r\nimport { ShopDayPage } from \"./ShopDayPage\";\r\nimport { EventMgr, Evt_Change_Scene_Bgm, Evt_Currency_Updtae, Evt_Hide_Scene, Evt_Item_Change, Evt_Show_Scene } from \"../../manager/EventMgr\";\r\nimport { ShopTabBtnItem } from \"./ShopTabBtnItem\";\r\nimport { ShopBasePage } from \"./ShopPageBase\";\r\nimport { ShopWeekPage } from \"./ShopWeekPage\";\r\nimport { Session } from \"../../net/Session\";\r\nimport { ShopTempPage } from \"./ShopTempPage\";\r\nimport { Panel } from \"../../manager/GameRoot\";\r\nimport { AutoScroller } from \"../../component/AutoScroller\";\r\nimport { CfgMgr, ShopGroupId, ShopType, StdShopGroup, StdShopIndex } from \"../../manager/CfgMgr\";\r\nimport { BeforeGameUtils } from \"../../utils/BeforeGameUtils\";\r\nimport { PlayerData } from \"../player/PlayerData\";\r\nimport { SThing } from \"../player/PlayerStruct\";\r\nimport { ItemUtil } from \"../../utils/ItemUtils\";\r\nimport { ConsumeItem, ConsumeNumFormatType } from \"../common/ConsumeItem\";\r\nimport { Req, Route } from \"../../net/Protocol\";\r\n\r\n\r\n\r\nexport class ShopPanel1 extends Panel {\r\n    protected prefab: string = \"prefabs/shop/ShopPanel1\";\r\n    private haveItemList: AutoScroller;\r\n    private luckyPage: ShopLuckyPage;\r\n    private dayPage: ShopDayPage;\r\n    private weekPage: ShopWeekPage;\r\n    private tempPage: ShopTempPage;\r\n    private tabBtnList: AutoScroller;\r\n    private tabDatas: StdShopGroup[];\r\n    private curTabIndex: number;\r\n    private shopPageInfo: { [key: string]: ShopBasePage };\r\n    //商城组信息（包含商城页签）\r\n    private ShopGroupInfo: { [key: string]: StdShopGroup[] } = BeforeGameUtils.toHashMapObj(\r\n\r\n        //基础商店\r\n        ShopGroupId.BaseShop, [\r\n        { ShopGroupId: ShopGroupId.BaseShop, ShopType: ShopType.LuckyShop, TabSort: 0, ShopName: \"抽奖商城\" },\r\n        { ShopGroupId: ShopGroupId.BaseShop, ShopType: ShopType.DayShop, TabSort: 0, ShopName: \"每日商城\" },\r\n        { ShopGroupId: ShopGroupId.BaseShop, ShopType: ShopType.WeekShop, TabSort: 0, ShopName: \"特殊商城\" },\r\n        { ShopGroupId: ShopGroupId.BaseShop, ShopType: ShopType.TempShop, TabSort: 0, ShopName: \"临时商店\" },\r\n    ],\r\n    );\r\n    protected onLoad() {\r\n        this.haveItemList = this.find(\"haveItemList\", AutoScroller);\r\n        this.haveItemList.SetHandle(this.updateHaveItem.bind(this));\r\n        this.tabBtnList = this.find(\"tabBtnList\", AutoScroller);\r\n        this.tabBtnList.SetHandle(this.updateTabBtnItem.bind(this));\r\n        this.tabBtnList.node.on('select', this.onTabBtnSelect, this);\r\n        this.luckyPage = this.node.getChildByName(\"luckyPage\").addComponent(ShopLuckyPage);\r\n        this.luckyPage.Hide();\r\n        this.dayPage = this.node.getChildByName(\"dayPage\").addComponent(ShopDayPage);\r\n        this.dayPage.onHide();\r\n        this.weekPage = this.node.getChildByName(\"weekPage\").addComponent(ShopWeekPage);\r\n        this.weekPage.onHide();\r\n        this.tempPage = this.node.getChildByName(\"tempPage\").addComponent(ShopTempPage);\r\n        this.tempPage.onHide();\r\n        this.shopPageInfo = BeforeGameUtils.toHashMapObj(\r\n            ShopType.TempShop, this.tempPage,\r\n            ShopType.LuckyShop, this.luckyPage,\r\n            ShopType.DayShop, this.dayPage,\r\n            ShopType.WeekShop, this.weekPage,\r\n        );\r\n        this.CloseBy(\"backBtn\");\r\n    }\r\n    protected onShow(): void {\r\n        EventMgr.emit(Evt_Hide_Scene, js.getClassName(this));\r\n        let shop_index = new Req[\"shop.protocol.getindex\"]();\r\n        shop_index.shopIndexId = null\r\n        Session.Send(Route[\"shop.protocol.getindex\"], shop_index);\r\n        // EventMgr.emit(Evt_Change_Scene_Bgm, SceneBgmId.SceneBgm_6); \r\n        EventMgr.on(Evt_Currency_Updtae, this.onCurrencyUpdate, this);\r\n        EventMgr.on(Evt_Item_Change, this.onItemChange, this);\r\n    }\r\n    protected onHide(...args: any[]): void {\r\n        EventMgr.emit(Evt_Show_Scene, js.getClassByName(this));\r\n        EventMgr.emit(Evt_Change_Scene_Bgm);\r\n        EventMgr.off(Evt_Currency_Updtae, this.onCurrencyUpdate, this);\r\n        EventMgr.off(Evt_Item_Change, this.onItemChange, this);\r\n    }\r\n\r\n    public async flush(shopGroupId: number): Promise<void> {\r\n        this.curTabIndex = -1;\r\n        let showShopList: StdShopGroup[] = [];\r\n        let defShowList: StdShopGroup[] = this.ShopGroupInfo[shopGroupId];\r\n        let stdShopGroup: StdShopGroup;\r\n        let stdShopIndex: StdShopIndex;\r\n        for (let index = 0; index < defShowList.length; index++) {\r\n            stdShopGroup = defShowList[index];\r\n            stdShopIndex = CfgMgr.GetShopIndex(stdShopGroup.ShopGroupId, stdShopGroup.ShopType);\r\n            if (stdShopIndex && stdShopIndex.SystemOpen) {\r\n                stdShopGroup.TabSort = stdShopIndex.TabSort ?? 0;\r\n                showShopList.push(stdShopGroup);\r\n            }\r\n        }\r\n        showShopList.sort((a: StdShopGroup, b: StdShopGroup) => {\r\n            return a.TabSort - b.TabSort;\r\n        });\r\n        this.tabDatas = showShopList;\r\n        this.tabBtnList.UpdateDatas(this.tabDatas);\r\n        this.tabBtnList.SelectFirst(0);\r\n    }\r\n    protected update(dt: number): void {\r\n\r\n    }\r\n    private onItemChange(): void {\r\n        this.updateHave();\r\n    }\r\n    private onCurrencyUpdate(): void {\r\n        this.updateHave();\r\n    }\r\n    private updateHave(): void {\r\n        let haveItems: SThing[] = [];\r\n        let tabData: StdShopGroup = this.tabDatas[this.curTabIndex];\r\n        let stdShopIndex: StdShopIndex = CfgMgr.GetShopIndex(tabData.ShopGroupId, tabData.ShopType);\r\n        if (stdShopIndex) {\r\n            haveItems = ItemUtil.GetSThingList(stdShopIndex.MoneyType, stdShopIndex.MoneyID);\r\n        }\r\n        this.haveItemList.UpdateDatas(haveItems);\r\n    }\r\n    private updateTabSelect(): void {\r\n        let shopType: number;\r\n        let shopBasePage: ShopBasePage;\r\n        let tabData: StdShopGroup = this.tabDatas[this.curTabIndex];\r\n        for (let key in this.shopPageInfo) {\r\n            shopType = Number(key);\r\n            shopBasePage = this.shopPageInfo[key];\r\n            if (shopType == tabData.ShopType) {\r\n                shopBasePage.onShow();\r\n                shopBasePage.SetData(tabData);\r\n            } else {\r\n                shopBasePage.onHide();\r\n            }\r\n        }\r\n        this.updateHave();\r\n    }\r\n    private updateHaveItem(item: Node, data: SThing): void {\r\n        let consumeItem = item.getComponent(ConsumeItem);\r\n        if (!consumeItem) consumeItem = item.addComponent(ConsumeItem);\r\n        consumeItem.numFormatType = ConsumeNumFormatType.Have;\r\n        consumeItem.SetData(data);\r\n    }\r\n    protected updateTabBtnItem(item: Node, data: StdShopGroup, index: number) {\r\n        let tabBtnItem = item.getComponent(ShopTabBtnItem);\r\n        if (!tabBtnItem) tabBtnItem = item.addComponent(ShopTabBtnItem);\r\n        let select: Node = item.getChildByName(\"selectCont\");\r\n        select.active = index == this.curTabIndex;\r\n        tabBtnItem.SetData(data);\r\n    }\r\n    private onTabBtnSelect(index: number, item: Node): void {\r\n        if (this.curTabIndex == index) return;\r\n        this.resetSelect();\r\n        let select: Node = item.getChildByName(\"selectCont\");\r\n        select.active = true;\r\n        this.curTabIndex = index;\r\n        this.updateTabSelect();\r\n    }\r\n    private resetSelect(): void {\r\n        let node: Node;\r\n        let itemIndex: number;\r\n        let select: Node;\r\n\r\n        for (let index = 0; index < this.tabBtnList.children.length; index++) {\r\n            node = this.tabBtnList.children[index];\r\n            itemIndex = node[\"$$index\"];\r\n            if (itemIndex == this.curTabIndex) {\r\n                select = node.getChildByName(\"selectCont\");\r\n                select.active = false;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}"]}