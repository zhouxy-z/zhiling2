{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/task/ActiveTaskCont.ts"],"names":["ActiveTaskCont","Button","Component","instantiate","Label","ProgressBar","UITransform","v3","TaskActiveBoxItem","CfgMgr","activeNumLab","proBar","tipsCont","boxCont","boxItemTemp","isInit","activeType","datas","boxList","curNum","maxNum","onLoad","node","getChildByName","getComponent","getChildByPath","updateShow","SetData","len","length","maxLen","boxNode","boxItem","taskData","stsTask","boxX","barTrans","removeAllChildren","index","GetTaskByData","width","CompletionNum","active","position","addComponent","addChild","tempNum","string","progress"],"mappings":";;;+KAKaA,c;;;;;;;;;;;;;;;;;;;;;;;;;;;AALJC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,K,OAAAA,K;AAAaC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,E,OAAAA,E;;AACvEC,MAAAA,iB,iBAAAA,iB;;AACAC,MAAAA,M,iBAAAA,M;;;;;;;;;gCAGIT,c,GAAN,MAAMA,cAAN,SAA6BE,SAA7B,CAAuC;AAAA;AAAA;AAAA,eAClCQ,YADkC;AAAA,eAElCC,MAFkC;AAAA,eAGlCC,QAHkC;AAAA,eAIlCC,OAJkC;AAAA,eAKlCC,WALkC;AAAA,eAMlCC,MANkC;AAAA,eAOlCC,UAPkC;AAAA,eAQlCC,KARkC;AAAA,eASlCC,OATkC;AAAA,eAUlCC,MAVkC;AAAA,eAWlCC,MAXkC;AAAA;;AAYhCC,QAAAA,MAAM,GAAS;AACrB,eAAKX,YAAL,GAAoB,KAAKY,IAAL,CAAUC,cAAV,CAAyB,cAAzB,EAAyCC,YAAzC,CAAsDpB,KAAtD,CAApB;AACA,eAAKO,MAAL,GAAc,KAAKW,IAAL,CAAUC,cAAV,CAAyB,QAAzB,EAAmCC,YAAnC,CAAgDnB,WAAhD,CAAd;AACA,eAAKO,QAAL,GAAgB,KAAKU,IAAL,CAAUC,cAAV,CAAyB,UAAzB,EAAqCC,YAArC,CAAkDvB,MAAlD,CAAhB;AACA,eAAKY,OAAL,GAAe,KAAKS,IAAL,CAAUC,cAAV,CAAyB,SAAzB,CAAf;AACA,eAAKT,WAAL,GAAmB,KAAKQ,IAAL,CAAUG,cAAV,CAAyB,qBAAzB,CAAnB;AACA,eAAKV,MAAL,GAAc,IAAd;AACA,eAAKW,UAAL;AACH;AAED;AACJ;AACA;AACA;;;AACIC,QAAAA,OAAO,CAACX,UAAD,EAAoBC,KAApB,EAA6CE,MAA7C,EAA4DC,MAA5D,EAA2E;AAC9E,eAAKJ,UAAL,GAAkBA,UAAlB;AACA,eAAKC,KAAL,GAAaA,KAAK,IAAI,EAAtB;AACA,eAAKE,MAAL,GAAcA,MAAd;AACA,eAAKC,MAAL,GAAcA,MAAd;AACA,eAAKM,UAAL;AACH;;AAEOA,QAAAA,UAAU,GAAO;AACrB,cAAI,CAAC,KAAKX,MAAN,IAAgB,CAAC,KAAKC,UAAtB,IAAoC,CAAC,KAAKC,KAA9C,EAAqD;AACrD,cAAIW,GAAU,GAAG,KAAKX,KAAL,CAAWY,MAA5B;AACA,cAAIC,MAAM,GAAG,KAAKb,KAAL,CAAWY,MAAxB;AACA,cAAIE,OAAJ;AACA,cAAIC,OAAJ;AACA,cAAIC,QAAJ;AACA,cAAIC,OAAJ;AACA,cAAIC,IAAW,GAAG,CAAlB;AACA,cAAIC,QAAoB,GAAG,KAAKzB,MAAL,CAAYW,IAAZ,CAAiBE,YAAjB,CAA8BlB,WAA9B,CAA3B;AACA,eAAKO,OAAL,CAAawB,iBAAb;;AACA,eAAK,IAAIC,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGR,MAA5B,EAAoCQ,KAAK,EAAzC,EAA6C;AACzCP,YAAAA,OAAO,GAAG5B,WAAW,CAAC,KAAKW,WAAN,CAArB;AACAmB,YAAAA,QAAQ,GAAG,KAAKhB,KAAL,CAAWqB,KAAX,CAAX;AACAJ,YAAAA,OAAO,GAAG;AAAA;AAAA,kCAAOK,aAAP,CAAqBN,QAArB,CAAV;AACAE,YAAAA,IAAI,GAAGC,QAAQ,CAACI,KAAT,IAAkBN,OAAO,CAACO,aAAR,GAAwB,KAAKrB,MAA/C,CAAP;AACAW,YAAAA,OAAO,CAACW,MAAR,GAAiB,IAAjB;AACAX,YAAAA,OAAO,CAACY,QAAR,GAAmBpC,EAAE,CAAC4B,IAAD,EAAO,CAAP,EAAU,CAAV,CAArB;AACAH,YAAAA,OAAO,GAAGD,OAAO,CAACP,YAAR;AAAA;AAAA,uDAAV;AACA,gBAAG,CAACQ,OAAJ,EAAaA,OAAO,GAAGD,OAAO,CAACa,YAAR;AAAA;AAAA,uDAAV;AACbZ,YAAAA,OAAO,CAACL,OAAR,CAAgBM,QAAhB,EAA2BK,KAA3B;AACA,iBAAKzB,OAAL,CAAagC,QAAb,CAAsBd,OAAtB;AACH;;AACD,cAAIe,OAAc,GAAG,KAAK3B,MAA1B;;AACA,cAAG,KAAKA,MAAL,GAAc,KAAKC,MAAtB,EAA6B;AACzB0B,YAAAA,OAAO,GAAG,KAAK1B,MAAf;AACH;;AACD,eAAKV,YAAL,CAAkBqC,MAAlB,GAA2B,QAAQD,OAAR,GAAkB,GAAlB,GAAwB,KAAK1B,MAAxD;AACA,eAAKT,MAAL,CAAYqC,QAAZ,GAAuB,KAAK7B,MAAL,GAAc,KAAKC,MAA1C;AACH;;AA/DyC,O","sourcesContent":["import { Button, Component, instantiate, Label, Node, ProgressBar, UITransform, v3 } from \"cc\";\r\nimport { TaskActiveBoxItem } from \"./TaskActiveBoxItem\";\r\nimport { CfgMgr, StdTask } from \"../../manager/CfgMgr\";\r\nimport { SPlayerDataTask } from \"../player/PlayerStruct\";\r\n\r\nexport class ActiveTaskCont extends Component {\r\n    private activeNumLab:Label;\r\n    private proBar:ProgressBar;\r\n    private tipsCont:Button;\r\n    private boxCont:Node;\r\n    private boxItemTemp:Node;\r\n    private isInit:boolean;\r\n    private activeType:number;\r\n    private datas:SPlayerDataTask[];\r\n    private boxList:Node[];\r\n    private curNum:number;\r\n    private maxNum:number;\r\n    protected onLoad(): void {\r\n        this.activeNumLab = this.node.getChildByName(\"activeNumLab\").getComponent(Label);\r\n        this.proBar = this.node.getChildByName(\"proBar\").getComponent(ProgressBar);\r\n        this.tipsCont = this.node.getChildByName(\"tipsCont\").getComponent(Button);\r\n        this.boxCont = this.node.getChildByName(\"boxCont\");\r\n        this.boxItemTemp = this.node.getChildByPath(\"boxCont/boxItemTemp\");\r\n        this.isInit = true;\r\n        this.updateShow();\r\n    }\r\n\r\n    /**\r\n     * 设置角色数据\r\n     * @param roleId \r\n     */\r\n    SetData(activeType:number, datas:SPlayerDataTask[], curNum:number, maxNum:number) {\r\n        this.activeType = activeType;\r\n        this.datas = datas || [];\r\n        this.curNum = curNum;\r\n        this.maxNum = maxNum;\r\n        this.updateShow();\r\n    }\r\n\r\n    private updateShow():void{\r\n        if (!this.isInit || !this.activeType || !this.datas) return;\r\n        let len:number = this.datas.length;\r\n        let maxLen = this.datas.length;\r\n        let boxNode:Node;\r\n        let boxItem:TaskActiveBoxItem;\r\n        let taskData:SPlayerDataTask;\r\n        let stsTask:StdTask;\r\n        let boxX:number = 0;\r\n        let barTrans:UITransform = this.proBar.node.getComponent(UITransform);\r\n        this.boxCont.removeAllChildren();\r\n        for (let index = 0; index < maxLen; index++) {\r\n            boxNode = instantiate(this.boxItemTemp);\r\n            taskData = this.datas[index];\r\n            stsTask = CfgMgr.GetTaskByData(taskData);\r\n            boxX = barTrans.width * (stsTask.CompletionNum / this.maxNum);\r\n            boxNode.active = true;\r\n            boxNode.position = v3(boxX, 0, 0);\r\n            boxItem = boxNode.getComponent(TaskActiveBoxItem);\r\n            if(!boxItem) boxItem = boxNode.addComponent(TaskActiveBoxItem);\r\n            boxItem.SetData(taskData,  index);\r\n            this.boxCont.addChild(boxNode);\r\n        }\r\n        let tempNum:number = this.curNum;\r\n        if(this.curNum > this.maxNum){\r\n            tempNum = this.maxNum;\r\n        }\r\n        this.activeNumLab.string = \"已完成\" + tempNum + \"/\" + this.maxNum;\r\n        this.proBar.progress = this.curNum / this.maxNum;\r\n    }\r\n}\r\n"]}