{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/task/SignPanel.ts"],"names":["SignPanel","Button","Input","Label","instantiate","Panel","CfgMgr","PlayerData","STaskType","STaskState","BagItem","MsgTypeRet","MsgTypeSend","Session","EventMgr","Evt_TaskChange","prefab","layout","day7","signBtn","label","Layout","item","taskData","reward_data","select_index","day","is_first","first_select_index","send_index","onLoad","CloseBy","find","node","on","onGetReward","EventType","TOUCH_START","check","onShow","flush","index","task_all_data","roleInfo","tasks","task_Data","sign_day","key","Object","prototype","hasOwnProperty","call","element","stdTask","GetTaskById","id","TaskType","dayliyLogin","v","push","loop_num","Math","ceil","iterator","data","getTaskRewardThings","length","children","off","TOUCH_END","getChildByName","getComponent","string","s","Finsh","active","bagItem","addComponent","SetData","setIsShowSelect","setIsShowTips","removeAllChildren","addChild","setSelectData","even","currentTarget","name","i","CompletionNum","unFinsh","info","type","CompleteTask","task_id","Send","CompleteTaskRet","onHide"],"mappings":"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","sourcesContent":["import { Button, Component, EditBox, EventTouch, Input, Label, Node, ProgressBar, RichText, ScrollView, Sprite, SpriteFrame, Toggle, UITransform, instantiate, path, sp, tween } from \"cc\";\r\nimport { Panel } from \"../../GameRoot\";\r\nimport { CfgMgr, ResourceType, StdCommonType, StdTask, ThingType } from \"../../manager/CfgMgr\";\r\nimport { RewardTips } from \"../common/RewardTips\";\r\nimport PlayerData from \"../roleModule/PlayerData\"\r\n import {STaskType,SPlayerData,SPlayerDataItem,SPlayerDataTask,STaskState,STaskShowType,SThing} from \"../roleModule/PlayerStruct\";\r\nimport { BagItem } from \"../bag/BagItem\";\r\nimport { MsgTypeRet, MsgTypeSend } from \"../../MsgType\";\r\nimport { Session } from \"../../net/Session\";\r\nimport { Tips } from \"../login/Tips\";\r\nimport { EventMgr, Evt_TaskChange } from \"../../manager/EventMgr\";\r\n\r\nexport class SignPanel extends Panel {\r\n    protected prefab: string = \"prefabs/task/SignPanel\";\r\n\r\n    private layout:Node;\r\n    private day7:Node;\r\n    private signBtn:Button;\r\n    private label:Label;\r\n    private Layout:Node;\r\n    private item:Node;\r\n   \r\n\r\n    private taskData:SPlayerDataTask[]\r\n    private reward_data:SThing[][] = []\r\n    private select_index:number = 1;\r\n    private day:number[] = [];\r\n    private is_first = false;\r\n    private first_select_index = 0;\r\n    private send_index = null;\r\n\r\n\r\n\r\n\r\n    protected onLoad() {\r\n        this.CloseBy(\"mark\");\r\n        this.layout = this.find(\"layout\");\r\n        this.day7 = this.find(\"day7\");\r\n        this.Layout = this.find(\"day7/Layout\");\r\n        this.item = this.find(\"day7/Layout/item\");\r\n        this.label = this.find(\"label\",Label);\r\n        this.signBtn = this.find(\"signBtn\",Button);\r\n        this.signBtn.node.on(\"click\",this.onGetReward, this);\r\n        this.day7.on(Input.EventType.TOUCH_START, this.check,this);\r\n    }\r\n\r\n  \r\n\r\n    protected onShow(): void {\r\n        EventMgr.on(Evt_TaskChange, this.flush, this);\r\n    }\r\n\r\n    public flush(index?: number): void {\r\n        let task_all_data = PlayerData.roleInfo.tasks;\r\n        let task_Data:SPlayerDataTask[] = [];\r\n        this.day = [];\r\n        this.is_first = false;\r\n        let sign_day = 0;\r\n        for (const key in task_all_data) {\r\n            if (Object.prototype.hasOwnProperty.call(task_all_data, key)) {\r\n                const element = task_all_data[key];\r\n                let stdTask = CfgMgr.GetTaskById(element.id);\r\n                if (stdTask && stdTask.TaskType == STaskType.dayliyLogin) {\r\n                    sign_day = element.v;\r\n                    task_Data.push(element);\r\n                }\r\n            }\r\n        }\r\n\r\n        if(sign_day == 0){\r\n            sign_day = 1;\r\n        }\r\n        let loop_num = Math.ceil(sign_day / 7);\r\n        if(loop_num >= 5){\r\n            loop_num = 4;\r\n        }\r\n        this.taskData = [];\r\n        this.reward_data = [];\r\n        for (let index = 1; index <= 7; index++) {\r\n            let day = index + 7 * (loop_num - 1)\r\n            this.day.push(day)\r\n            let id =  500100 + day;\r\n          for (const iterator of task_Data) {\r\n            if(iterator.id == id){\r\n                let data:SThing[] = CfgMgr.getTaskRewardThings(id)\r\n                this.reward_data.push(data);\r\n                this.taskData.push(iterator);\r\n            }\r\n          }\r\n        }\r\n       \r\n        if(this.taskData.length == 0) return;\r\n        for (let index = 0; index < this.layout.children.length; index++) {\r\n            const node = this.layout.children[index];\r\n            node.off(Input.EventType.TOUCH_END,this.check,this);\r\n            node.on(Input.EventType.TOUCH_END,this.check,this);\r\n            node.getChildByName(\"label\").getComponent(Label).string = \"第\" + this.day[index] + \"天\";\r\n            if(node){\r\n                if(this.taskData[index].s == STaskState.Finsh){\r\n                    node.getChildByName(\"sign\").active = true;\r\n                    node.getChildByName(\"sign_mask\").active = true;\r\n                }else{\r\n                    if(!this.is_first){\r\n                        this.is_first = true;\r\n                        this.first_select_index = index;\r\n                    }\r\n                    node.getChildByName(\"sign\").active = false;\r\n                    node.getChildByName(\"sign_mask\").active = false;\r\n                }\r\n                let item = node.children[0];\r\n                let bagItem = item.getComponent(BagItem);\r\n                if(!bagItem) bagItem = item.addComponent(BagItem);\r\n                bagItem.SetData(this.reward_data[index][0])\r\n                bagItem.setIsShowSelect(false);\r\n                bagItem.setIsShowTips(true);\r\n            }\r\n        }\r\n\r\n        this.Layout.removeAllChildren();\r\n        for (let index = 0; index < this.reward_data[6].length; index++) {\r\n            const element = this.reward_data[6][index];\r\n            let item = instantiate(this.item);  \r\n            item.getChildByName(\"sign\").active = this.taskData[6].s == STaskState.Finsh;\r\n            let bagItem = item.getComponent(BagItem);\r\n            if(!bagItem) bagItem = item.addComponent(BagItem);\r\n            bagItem.SetData(element)\r\n            bagItem.setIsShowSelect(false);\r\n            bagItem.setIsShowTips(true);\r\n            this.Layout.addChild(item);\r\n        }\r\n        this.day7.getChildByName(\"sign_mask\").active = this.taskData[6].s == STaskState.Finsh;\r\n        this.day7.getChildByName(\"label\").getComponent(Label).string = \"第\" + this.day[6] + \"天\";\r\n\r\n        if(!this.is_first){\r\n            this.first_select_index = 6;\r\n        }\r\n        this.setSelectData(this.first_select_index);\r\n    }\r\n\r\n    private check(even: EventTouch){\r\n        let node = even.currentTarget;\r\n        let index = 0;\r\n        switch (node.name) {\r\n            case \"day1\":\r\n                index = 0;\r\n                break;\r\n            case \"day2\":\r\n                index = 1;\r\n                break;\r\n            case \"day3\":\r\n                index = 2;\r\n                break;\r\n            case \"day4\":\r\n                index = 3;\r\n                break;\r\n            case \"day5\":\r\n                index = 4;\r\n                break;\r\n            case \"day6\":\r\n                index = 5;\r\n                break;\r\n            case \"day7\":\r\n                index = 6;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n       \r\n        this.setSelectData(index);\r\n    }\r\n\r\n    private setSelectData(index){\r\n        for (let i = 0; i < this.layout.children.length; i++) {\r\n            this.layout.children[i].getChildByName(\"select\").active = false;  \r\n        }       \r\n        this.day7.getChildByName(\"select\").active = index == 6;  \r\n\r\n        this.select_index = index;\r\n        if(index < 6){\r\n            this.layout.children[index].getChildByName(\"select\").active = true;\r\n        }\r\n        let stdTask = CfgMgr.GetTaskById(this.taskData[index].id);\r\n        if(this.taskData[index].v >= stdTask.CompletionNum ){\r\n            if(this.taskData[index].s == STaskState.unFinsh){\r\n                this.signBtn.node.active = true;\r\n                this.label.node.active = false;\r\n                this.signBtn.node.getChildByName(\"Label\").getComponent(Label).string = \"签到领奖\"\r\n            }else{\r\n                this.signBtn.node.active = false;\r\n                this.label.node.active = true;\r\n                this.label.string = \"已领取\"\r\n            }\r\n        }else{\r\n            this.signBtn.node.active = false;\r\n            this.label.node.active = true;\r\n            let day = this.taskData[index].id - 500100;\r\n            this.label.string = \"登录\" + day + \"天可领取\"\r\n        }\r\n    }\r\n\r\n    \r\n\r\n    \r\n\r\n    private onGetReward(even: EventTouch) {\r\n        // console.log(even)\r\n        // let index = even.currentTarget.getSiblingIndex();\r\n        // console.log(index)\r\n    //     //一键领取\r\n    //     for (let index = 0; index < this.taskData.length; index++) {\r\n    //         const element = this.taskData[index];\r\n    //         let stdTask = CfgMgr.GetTaskById(this.taskData[index].id);\r\n    //         if(this.taskData[index].v >= stdTask.CompletionNum && this.taskData[index].s == STaskState.unFinsh){\r\n    //             let info = {\r\n    //                 type: MsgTypeSend.CompleteTask,\r\n    //                 data: {\r\n    //                     task_id: this.taskData[index].id\r\n    //                 }\r\n    //             }\r\n    //             Session.Send(info, MsgTypeRet.CompleteTaskRet);\r\n    //         }\r\n    //    }\r\n\r\n    \r\n        this.send_index = this.select_index\r\n        let info = {\r\n            type: MsgTypeSend.CompleteTask,\r\n            data: {\r\n                task_id: this.taskData[this.send_index].id\r\n            }\r\n        }\r\n        Session.Send(info, MsgTypeRet.CompleteTaskRet);\r\n        \r\n    }\r\n\r\n   \r\n\r\n    protected onHide(...args: any[]): void {\r\n        this.is_first = false;\r\n        this.first_select_index = 0;\r\n        this.send_index = null;\r\n        EventMgr.off(Evt_TaskChange, this.flush, this);\r\n    }\r\n\r\n\r\n}\r\n"]}