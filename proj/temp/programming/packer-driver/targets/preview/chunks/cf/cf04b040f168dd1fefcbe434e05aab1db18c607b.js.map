{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/fight/opOutput/Out_CopyCard.ts"],"names":["Out_CopyCard","BattleBaseComp","battleDataMgr","proto","start","copyCard","getCard","data","copyInstId","copyPlayerIsA","isPlayerA","playerId","toPlayerIsA","card","location","base","BattleRoomCardLocation","Hand","scene","AddCardToHand","Unknown","isExit","Terrain","cardLocation","getPlayerAreaEmptyCardLocationByIdx","area","AddCardToArea","areaIdx","cardIdx","Deck","Del","Drop","CopyCardToUnVisible","exit","reset"],"mappings":";;;oEASaA,Y;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AATJC,MAAAA,c,iBAAAA,c;;AACAC,MAAAA,a,iBAAAA,a;;AAGFC,MAAAA,K;;;;;;;AAEP;AACA;AACA;8BACaH,Y,GAAN,MAAMA,YAAN;AAAA;AAAA,4CAAmF;AAEtEI,QAAAA,KAAK,GAAkB;AAAA;;AAAA;AACnC,gBAAIC,QAAwC,GAAG;AAAA;AAAA,gDAAcC,OAAd,CAAsB,KAAI,CAACC,IAAL,CAAUC,UAAhC,CAA/C,CADmC,CAEnC;;AACA,gBAAIC,aAAsB,GAAG;AAAA;AAAA,gDAAcC,SAAd,CAAwBL,QAAQ,CAACM,QAAjC,CAA7B,CAHmC,CAInC;;AACA,gBAAIC,WAAoB,GAAG;AAAA;AAAA,gDAAcF,SAAd,CAAwB,KAAI,CAACH,IAAL,CAAUM,IAAV,CAAeF,QAAvC,CAA3B,CALmC,CAMnC;;AACA,oBAAQ,KAAI,CAACJ,IAAL,CAAUM,IAAV,CAAeC,QAAvB;AACI,mBAAK;AAAA;AAAA,kCAAMC,IAAN,CAAWC,sBAAX,CAAkCC,IAAvC;AACI;AACA,sBAAM,KAAI,CAACC,KAAL,CAAWC,aAAX,CAAyBP,WAAzB,EAAsC,KAAI,CAACL,IAA3C,EAAiD;AAAA;AAAA,oCAAMQ,IAAN,CAAWC,sBAAX,CAAkCI,OAAnF,EAA4Ff,QAA5F,CAAN;AACA,oBAAI,KAAI,CAACgB,MAAT,EAAiB,OAHrB,CAII;;AACA;;AACJ,mBAAK;AAAA;AAAA,kCAAMN,IAAN,CAAWC,sBAAX,CAAkCM,OAAvC;AACI;AACA,oBAAIC,YAA0B,GAAG;AAAA;AAAA,oDAAcC,mCAAd,CAAkD,KAAI,CAACjB,IAAL,CAAUM,IAAV,CAAeF,QAAjE,EAA2E,KAAI,CAACJ,IAAL,CAAUM,IAAV,CAAeY,IAA1F,CAAjC;AACA,sBAAM,KAAI,CAACP,KAAL,CAAWQ,aAAX,CAAyBd,WAAzB,EAAsC,KAAI,CAACL,IAA3C,EAAiDF,QAAjD,EAA2DkB,YAAY,CAACI,OAAxE,EAAiFJ,YAAY,CAACK,OAA9F,CAAN;AACA,oBAAI,KAAI,CAACP,MAAT,EAAiB;AACjB;;AACJ,mBAAK;AAAA;AAAA,kCAAMN,IAAN,CAAWC,sBAAX,CAAkCa,IAAvC;AACA,mBAAK;AAAA;AAAA,kCAAMd,IAAN,CAAWC,sBAAX,CAAkCc,GAAvC;AACA,mBAAK;AAAA;AAAA,kCAAMf,IAAN,CAAWC,sBAAX,CAAkCe,IAAvC;AACI;AACA,sBAAM,KAAI,CAACb,KAAL,CAAWc,mBAAX,CAA+BpB,WAA/B,EAA4C,KAAI,CAACL,IAAjD,EAAuDF,QAAvD,CAAN;AACA,oBAAI,KAAI,CAACgB,MAAT,EAAiB,OAHrB,CAII;;AACA;;AACJ;AACI;AAtBR;;AAwBA,YAAA,KAAI,CAACY,IAAL;AA/BmC;AAgCtC;;AAESC,QAAAA,KAAK,GAAS,CAEvB;;AAtCqF,O","sourcesContent":["import { BattleBaseComp } from \"../../battle/BattleBaseComp\";\r\nimport { battleDataMgr } from \"../../battle/BattleDataMgr\";\r\nimport { BeforeGameUtils } from \"../../../utils/BeforeGameUtils\";\r\nimport { CardLocation } from \"../../player/PlayerStruct\";\r\nimport proto from \"../../../net/Protocol\";\r\n\r\n/**\r\n * 复制一张卡\r\n */\r\nexport class Out_CopyCard extends BattleBaseComp<proto.base.IBattleRoomOpOutput_CopyCard> {\r\n\r\n    protected async start(): Promise<void> {\r\n        let copyCard: proto.base.IBattleRoomCardData = battleDataMgr.getCard(this.data.copyInstId);\r\n        //复制来源是否第一觉玩家\r\n        let copyPlayerIsA: boolean = battleDataMgr.isPlayerA(copyCard.playerId);\r\n        //是否复制到第一觉玩家\r\n        let toPlayerIsA: boolean = battleDataMgr.isPlayerA(this.data.card.playerId);\r\n        //复制卡来源\r\n        switch (this.data.card.location) {\r\n            case proto.base.BattleRoomCardLocation.Hand:\r\n                //复制的卡出现在屏幕中间然后飞到对应目标玩家的手卡区\r\n                await this.scene.AddCardToHand(toPlayerIsA, this.data, proto.base.BattleRoomCardLocation.Unknown, copyCard);\r\n                if (this.isExit) return;\r\n                // this.scene.AddCardFormSceneCentreToHand(toPlayerIsA, this.data.card);\r\n                break;\r\n            case proto.base.BattleRoomCardLocation.Terrain:\r\n                //复制的卡出现在屏幕中间然后飞到对应目标玩家的场地上区\r\n                let cardLocation: CardLocation = battleDataMgr.getPlayerAreaEmptyCardLocationByIdx(this.data.card.playerId, this.data.card.area);\r\n                await this.scene.AddCardToArea(toPlayerIsA, this.data, copyCard, cardLocation.areaIdx, cardLocation.cardIdx);\r\n                if (this.isExit) return;\r\n                break;\r\n            case proto.base.BattleRoomCardLocation.Deck:\r\n            case proto.base.BattleRoomCardLocation.Del:\r\n            case proto.base.BattleRoomCardLocation.Drop:\r\n                //复制的卡出现在屏幕中间然后飞到对应目标玩家的头像区\r\n                await this.scene.CopyCardToUnVisible(toPlayerIsA, this.data, copyCard);\r\n                if (this.isExit) return;\r\n                // this.scene.AddCardFormSceneCentreToHead(toPlayerIsA, this.data.card);\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        this.exit();\r\n    }\r\n\r\n    protected reset(): void {\r\n\r\n    }\r\n}"]}