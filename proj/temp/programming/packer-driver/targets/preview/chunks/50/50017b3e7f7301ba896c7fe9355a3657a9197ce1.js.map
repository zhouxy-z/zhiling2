{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/main/MainUI3D.ts"],"names":["MainUI3D","easing","Input","instantiate","Label","path","Sprite","SpriteFrame","tween","UITransform","v3","Vec3","folder_item","ResMgr","GameSet","PlaneView","Second","Utils","Transform3d","AsyncComponent","PlayerData","CfgMgr","EventMgr","Evt_MainTaskChange","Panel","MsgPanel","Goto","proto","planeView","leftView","rightView","battleView","fightBtn","saijiBtn","txzItem","leftStartY","rightStartY","right_taskStartX","taskClone","noticeClone","taskPool","noticePool","leftItems","taskItems","startTaskTween","instance","_instance","prevLoad","loadSub","Promise","resolve","reject","GetResources","prefab","node","addComponent","Show","mainCamera","addChild","d","TestUIHigh","PixelSize","setPosition","canvas","on","EventType","TOUCH_START","onTouchStart","TOUCH_END","onTouchEnd","Init","Hide","parent","removeChild","off","onLoad","getChildByPath","left","push","position","y","right","x","updateLeftData","hdItem","AddTouchEffect","e","ut","getComponent","checkTouch","contentSize","width","height","tileItem","start","UNIT_Z","children","layoutV","localLeftDown","startTween","localRightDown","setTween","battleNode","battleNode_pos","getPosition","z","to","circOut","left_right","items","endPos","index","length","element","pos","starty","h","_i","_item","startx","startz","out","mat","getWorldMatrix","invert","i","item","trans","transformMat4","worldPosition","v","datas","GetShowMianTask","data","DelTouchEffect","pop","cfg_task","GetTaskByData","console","log","icon","Getitem","RewardID","Icon","num","RewardNumber","LoadResAbSub","join","res","getChildByName","spriteFrame","string","Description","state","GetTaskState","active","len","Math","max","update","dt","change_task_list","GetPanelNum","updateRighTaskItem","concat","item_count","count","ceil","time","value","CompletionNum","str","delay","call","CurSeasonData","currentSeasonId","base","BattleMode","BattleModeRank","SatrElementData","BattleModeStar","name","cfg","type","TaskTypeData"],"mappings":"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","sourcesContent":["import { Component, director, easing, EventTouch, find, geometry, Input, instantiate, Label, math, Node, path, Prefab, Sprite, SpriteFrame, tween, UIOpacity, UITransform, v3, Vec3 } from \"cc\";\nimport { folder_item, ResMgr } from \"../../manager/ResMgr\";\nimport { GameSet } from \"../../manager/GameSet\";\nimport { PlaneView, Second, Utils } from \"../../utils/Utils\";\nimport { Transform3d } from \"../common/Transform3d\";\nimport { AsyncComponent } from \"../common/AsyncComponent\";\nimport { TaskPanel } from \"../task/TaskPanel\";\nimport { PlayerData } from \"../player/PlayerData\";\nimport { CfgMgr, StdTask } from \"../../manager/CfgMgr\";\nimport { EventMgr, Evt_MainTaskChange, Evt_TaskChange } from \"../../manager/EventMgr\";\nimport { Panel } from \"../../manager/GameRoot\";\nimport { MsgPanel } from \"../common/MsgPanel\";\nimport { Goto } from \"../../DL\";\nimport proto from \"../../net/Protocol\";\n\nexport class MainUI3D extends AsyncComponent {\n    protected static _instance: MainUI3D;\n    protected static canvas: Node;\n    static get instance() {\n        return this._instance;\n    }\n\n    protected static loadSub: Promise<any>;\n\n    static async prevLoad() {\n        if (!this.loadSub) {\n            this.loadSub = new Promise((resolve, reject) => {\n                ResMgr.GetResources(\"prefabs/main/MainUI3D\", (prefab: Prefab) => {\n                    let node: Node = instantiate(prefab);\n                    MainUI3D._instance = node.addComponent(MainUI3D);\n                    resolve(MainUI3D._instance);\n                })\n            });\n            return this.loadSub;\n        }\n        return this.loadSub;\n    }\n\n    /**\n     * 显示\n     */\n    static async Show(node: Node) {\n        if (!this._instance) await this.prevLoad();\n        GameSet.mainCamera.node.addChild(this._instance.node);\n        let d = Utils.TestUIHigh(720 * GameSet.PixelSize, GameSet.mainCamera);\n        MainUI3D._instance.node.setPosition(0, 0, -d);\n\n        this.canvas = node;\n        this.canvas.on(Input.EventType.TOUCH_START, this._instance.onTouchStart, this._instance);\n        this.canvas.on(Input.EventType.TOUCH_END, this._instance.onTouchEnd, this._instance);\n        this._instance.Init();\n    }\n\n\n    static async Hide() {\n        if (!this._instance) await this.prevLoad();\n        if (this._instance && this._instance.node.parent) {\n            this._instance.node.parent.removeChild(this._instance.node);\n        }\n        if (this.canvas) {\n            this.canvas.off(Input.EventType.TOUCH_START, this._instance.onTouchStart, this._instance);\n            this.canvas.off(Input.EventType.TOUCH_END, this._instance.onTouchEnd, this._instance);\n        }\n    }\n\n    protected planeView: PlaneView;\n    protected leftView: PlaneView;\n    protected rightView: PlaneView;\n    protected battleView: PlaneView;\n    protected fightBtn: Node;\n    protected saijiBtn: Node;\n    protected txzItem: Node;\n    protected leftStartY: number;\n    protected rightStartY: number;\n    protected right_taskStartX: number;\n    protected taskClone: Node;\n    protected noticeClone: Node;\n    protected taskPool: Node[] = [];\n    protected noticePool: Node[] = [];\n    protected leftItems: Node[] = [];\n    protected taskItems: Node[] = [];\n    private startTaskTween: boolean = false;\n\n    protected async onLoad() {\n        MainUI3D._instance = this;\n\n        this.fightBtn = this.node.getChildByPath(\"ui/battleNode/fight\");\n        this.saijiBtn = this.node.getChildByPath(\"ui/battleNode/saiji\");\n        this.txzItem = this.node.getChildByPath(\"ui/left/txzItem\");\n\n\n        let left = this.node.getChildByPath(\"ui/left\");\n        this.taskClone = left.getChildByPath(\"item0\");\n        left.removeChild(this.taskClone);\n        this.taskPool.push(left.getChildByPath(\"item1\"));\n        this.taskPool.push(left.getChildByPath(\"item2\"));\n        left.removeChild(this.taskPool[0]);\n        left.removeChild(this.taskPool[1]);\n        this.leftStartY = left.getChildByPath(\"txzItem\").position.y;\n\n        let right = this.node.getChildByPath(\"ui/right\");\n        this.rightStartY = right.getChildByPath(\"hdItem\").position.y;\n\n        this.taskItems.push(this.node.getChildByPath(\"ui/taskItem/item0\"));\n        this.taskItems.push(this.node.getChildByPath(\"ui/taskItem/item1\"));\n        this.taskItems.push(this.node.getChildByPath(\"ui/taskItem/item2\"));\n        this.right_taskStartX = this.node.getChildByPath(\"ui/taskItem/item0\").position.x;\n        EventMgr.on(Evt_MainTaskChange, this.updateLeftData, this);\n\n        super.onLoad();\n    }\n\n    protected Init() {\n\n        let hdItem = this.node.getChildByPath(\"ui/right/hdItem\");\n        Utils.AddTouchEffect(hdItem, (e) => {\n            let ut = hdItem.getComponent(UITransform);\n            if (this.rightView.checkTouch(e, hdItem, ut.contentSize.width, ut.contentSize.height / 2)) return true;\n            return false;\n        }, this, MainUI3D.canvas);\n        \n        Utils.AddTouchEffect(this.txzItem, (e) => {\n            let ut = this.txzItem.getComponent(UITransform);\n            if (this.leftView.checkTouch(e, this.txzItem, ut.contentSize.width, ut.contentSize.height / 2)) return true;\n            return false;\n        }, this, MainUI3D.canvas);\n\n        let tileItem = this.node.getChildByPath(\"ui/left/tileItem\");\n        Utils.AddTouchEffect(tileItem, (e) => {\n            let ut = tileItem.getComponent(UITransform);\n            if (this.leftView.checkTouch(e, tileItem, ut.contentSize.width, ut.contentSize.height / 2)) return true;\n            return false;\n        }, this, MainUI3D.canvas);\n\n        Utils.AddTouchEffect(this.fightBtn, (e) => {\n            let ut = this.fightBtn.getComponent(UITransform);\n            if (this.battleView.checkTouch(e, this.fightBtn, ut.contentSize.width / 2, ut.contentSize.height / 2)) return true;\n            return false;\n        }, this, MainUI3D.canvas);\n        Utils.AddTouchEffect(this.saijiBtn, (e) => {\n            let ut = this.saijiBtn.getComponent(UITransform);\n            if (this.battleView.checkTouch(e, this.saijiBtn, ut.contentSize.width / 2, ut.contentSize.height / 2)) return true;\n            return false;\n        }, this, MainUI3D.canvas);\n\n    }\n\n    async start() {\n        this.planeView = new PlaneView(GameSet.mainCamera, this.node.getChildByPath(\"ui\"), Vec3.UNIT_Z);\n        this.leftView = new PlaneView(GameSet.mainCamera, this.node.getChildByPath(\"ui/left\"));\n        this.rightView = new PlaneView(GameSet.mainCamera, this.node.getChildByPath(\"ui/right\"));\n        this.battleView = new PlaneView(GameSet.mainCamera, this.node.getChildByPath(\"ui/battleNode\"));\n\n        this.updateLeftData();\n\n        let children = this.node.getChildByPath(\"ui/left\").children;\n        this.layoutV(this.leftView.localLeftDown.x, this.leftStartY, children);\n        this.startTween(0, children);\n\n        children = this.node.getChildByPath(\"ui/right\").children;\n        this.layoutV(this.rightView.localRightDown.x, this.rightStartY, children);\n        this.startTween(1, children);\n\n        this.setTween();\n    }\n\n    private async setTween() {\n        // let poster = this.node.getChildByPath(\"poster\");\n        // poster.getComponent(UIOpacity).opacity = 0;\n        // poster.setScale(new Vec3(poster.scale.x * 0.5, poster.scale.y * 0.5, 1));\n        // tween(poster)\n        //     .to(0.6, { scale: new Vec3(poster.scale.x * 2, poster.scale.y * 2, 1) }, { easing: easing.circOut })\n        //     .start();\n\n        let battleNode = this.node.getChildByPath(\"ui/battleNode\");\n        let battleNode_pos = battleNode.getPosition();\n        battleNode.setPosition(new Vec3(battleNode_pos.x, battleNode_pos.y - 20, battleNode_pos.z));\n\n        tween(battleNode)\n            .to(1.2, { position: new Vec3(battleNode_pos.x, battleNode_pos.y, battleNode_pos.z) }, { easing: easing.circOut })\n            .start();\n        // // await Second(0.2)\n        // tween(poster.getComponent(UIOpacity))\n        //     .to(1, { opacity: 255 }, { easing: easing.circOut })\n        //     .start()\n    }\n\n    private async startTween(left_right: number, items: Node[]) {\n        let endPos = [];\n        for (let index = 0; index < items.length; index++) {\n            const element = items[index];\n            let pos = element.getPosition();\n            endPos.push(pos);\n            if (left_right == 1) {\n                element.setPosition(new Vec3(pos.x + 100, pos.y, pos.z));\n            } else {\n                element.setPosition(new Vec3(pos.x - 100, pos.y, pos.z));\n            }\n        }\n\n        for (let index = 0; index < items.length; index++) {\n            const element = items[index];\n            tween(element).\n                to(1, { position: endPos[index] }, { easing: easing.circOut }).\n                start();\n            await Second(0.05);\n        }\n    }\n\n    protected layoutV(x: number, starty: number, items: Node[]) {\n        let h = 0;\n        for (let _i = 0; _i < items.length; _i++) {\n            let _item = items[_i];\n            h += _item.getComponent(Transform3d).height;\n        }\n        let startx = x;\n        let startz = 0;\n        let out = v3();\n        let mat = this.node.getWorldMatrix().invert();\n        for (let i = 0; i < items.length; i++) {\n            let item = items[i];\n            let trans = item.getComponent(Transform3d);\n            Vec3.transformMat4(out, item.worldPosition, mat);\n            let v = item.position;\n            item.setPosition(startx, starty, startz);\n            starty -= trans.height;\n        }\n    }\n\n    /**\n     * 更新左边任务栏\n     * @param datas \n     */\n    protected updateLeftData() {\n        let datas: any[] = PlayerData.GetShowMianTask();\n        let left = this.node.getChildByPath(\"ui/left\");\n        for (let i = 0, len = Math.max(datas.length, this.leftItems.length); i < len; i++) {\n            let data = datas[i];\n            if (!data) {\n                let item = this.leftItems[i]\n                left.removeChild(item);\n                this.taskPool.push(item);\n                Utils.DelTouchEffect(item, MainUI3D.canvas);\n\n            } else {\n                let item = this.leftItems[i];\n                if (!item) {\n                    item = this.taskPool.length ? this.taskPool.pop() : instantiate(this.taskClone);\n                    Utils.DelTouchEffect(item, MainUI3D.canvas);\n                    Utils.AddTouchEffect(item, (e) => {\n                        let ut = item.getComponent(UITransform);\n                        if (this.leftView.checkTouch(e, item, ut.contentSize.width, ut.contentSize.height / 2)) return true;\n                        return false;\n                    }, this, MainUI3D.canvas);\n\n                    this.leftItems.push(item);\n                    left.addChild(item);\n                }\n                let cfg_task = CfgMgr.GetTaskByData(data)\n                console.log(cfg_task)\n                let icon = CfgMgr.Getitem(cfg_task.RewardID[0]).Icon;\n                let num = cfg_task.RewardNumber[0];\n                ResMgr.LoadResAbSub(path.join(folder_item, icon, \"spriteFrame\"), SpriteFrame, res => {\n                    item.getChildByName(\"icon\").getComponent(Sprite).spriteFrame = res;\n                })\n                item.getChildByPath(\"icon/num\").getComponent(Label).string = num + \"\"\n                item.getChildByPath(\"icon/label\").getComponent(Label).string = cfg_task.Description\n                let state = PlayerData.GetTaskState(data)\n                item.getChildByName(\"select\").active = state == 2\n                item[\"data\"] = cfg_task\n            }\n        }\n    }\n\n    protected update(dt: number): void {\n        if (this.node.parent) {\n            if (PlayerData.change_task_list.length && Panel.GetPanelNum(\"MainPanel\", \"TopUI\") <= 0) {\n                if (!this.startTaskTween) {\n                    this.startTaskTween = true;\n                    this.updateRighTaskItem();\n                }\n            }\n        }\n    }\n\n    /** 更新右边任务栏 */\n    private async updateRighTaskItem() {\n        let data = [];\n        data = data.concat(...PlayerData.change_task_list);\n        PlayerData.change_task_list = [];\n        this.startTaskTween = false;\n        let item_count = this.taskItems.length\n        let count = Math.ceil(data.length / item_count);\n        for (let index = 0; index < count; index++) {\n            let time = index == count - 1 ? 3 : 0.6\n            for (let i = 0; i < item_count; i++) {\n                const element = data[index * item_count + i];\n                console.log(element, data.length, index, item_count, i)\n                let item = this.taskItems[i];\n                if (!element) {\n                    item.active = false\n                } else {\n                    item.active = true;\n                    let cfg_task = CfgMgr.GetTaskByData(element.data)\n                    let count = element.data.value > cfg_task.CompletionNum ? cfg_task.CompletionNum : element.data.value\n                    let str = \"(\" + count + \"/\" + cfg_task.CompletionNum + \")\"\n                    item.getChildByName(\"label\").getComponent(Label).string = \"完成\" + cfg_task.Description + str\n                }\n                tween(item)\n                    .to(0.5, { position: new Vec3(this.right_taskStartX - 4.1, item.position.y, item.position.z) })\n                    .delay(time)\n                    .call(() => { item.active = false })\n                    .to(0.01, { position: new Vec3(this.right_taskStartX, item.position.y, item.position.z) })\n                    .call(() => { item.active = true })\n                    .start()\n            }\n            await Second(1.11)\n        }\n    }\n\n    protected onTouchStart(e: EventTouch) {\n\n    }\n\n\n    /**\n     * 点击事件\n     * @param e \n     * @returns \n     */\n    protected onTouchEnd(e: EventTouch) {\n        let ut = this.saijiBtn.getComponent(UITransform);\n        if (this.battleView.checkTouch(e, this.saijiBtn, ut.contentSize.width / 2, ut.contentSize.height / 2)) {\n            if (PlayerData.CurSeasonData && PlayerData.CurSeasonData.currentSeasonId != 0) {\n                Goto(\"VSModelPanel\", proto.base.BattleMode.BattleModeRank);\n            } else {\n                MsgPanel.Show(\"暂时没有赛季进行中\");\n            }\n            return;\n        }\n\n        ut = this.fightBtn.getComponent(UITransform);\n        if (this.battleView.checkTouch(e, this.fightBtn, ut.contentSize.width / 2, ut.contentSize.height / 2)) {\n            if (PlayerData.SatrElementData && PlayerData.SatrElementData.currentSeasonId != 0) {\n                Goto(\"VSModelPanel\", proto.base.BattleMode.BattleModeStar);\n            } else {\n                MsgPanel.Show(\"暂时没有星元对战进行中\");\n            }\n            return;\n        }\n\n        //赛季通行证\n        ut = this.txzItem.getComponent(UITransform);\n        if (this.leftView.checkTouch(e, this.txzItem, ut.contentSize.width, ut.contentSize.height)) {\n            Goto(\"RightsPanel\")\n            return;\n        }\n\n        //任务\n        let tileItem = this.node.getChildByPath(\"ui/left/tileItem\");\n        ut = tileItem.getComponent(UITransform);\n        if (this.leftView.checkTouch(e, tileItem, ut.contentSize.width, ut.contentSize.height)) {\n            console.log(tileItem.name);\n            Goto(\"TaskPanel\");\n            return;\n        }\n\n        for (let item of this.leftItems) {\n            if (item.parent) {\n                ut = item.getComponent(UITransform);\n                if (this.leftView.checkTouch(e, item, ut.contentSize.width, ut.contentSize.height)) {\n                    let cfg: StdTask = item[\"data\"];\n                    console.log(cfg);\n                    let type = 0;\n                    if (cfg.TaskTypeData && cfg.TaskTypeData.length > 0) {\n                        type = cfg.TaskTypeData[0]\n                    }\n                    Goto(\"TaskPanel\", cfg.Show - 1, type);\n                    return;\n                }\n            }\n        }\n    }\n}\n"]}