{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/shop/ShopRefreshPanel.ts"],"names":["ShopRefreshPanel","Button","RichTextComponent","Panel","ItemUtil","prefab","okBtn","noBtn","contLab","stdShop","shopId","onLoad","find","node","on","EventType","CLICK","onBtnClick","onShow","onHide","flush","btn","CheckThingConsumes","RefreshThingType","RefreshThingId","RefreshThingCount","Hide"],"mappings":";;;2HAIaA,gB;;;;;;;;;;;;;;;;;;;;;;;;;;;AAJJC,MAAAA,M,OAAAA,M;AAAkBC,MAAAA,iB,OAAAA,iB;;AAClBC,MAAAA,K,iBAAAA,K;;AAEAC,MAAAA,Q,iBAAAA,Q;;;;;;;;;kCACIJ,gB,GAAN,MAAMA,gBAAN;AAAA;AAAA,0BAAqC;AAAA;AAAA;AAAA,eAC9BK,MAD8B,GACb,qCADa;AAAA,eAEhCC,KAFgC;AAAA,eAGhCC,KAHgC;AAAA,eAIhCC,OAJgC;AAAA,eAKhCC,OALgC;AAAA,eAMhCC,MANgC;AAAA;;AAO9BC,QAAAA,MAAM,GAAG;AACf,eAAKH,OAAL,GAAe,KAAKI,IAAL,CAAU,SAAV,EAAqBV,iBAArB,CAAf;AACA,eAAKI,KAAL,GAAa,KAAKM,IAAL,CAAU,OAAV,EAAmBX,MAAnB,CAAb;AACA,eAAKM,KAAL,GAAa,KAAKK,IAAL,CAAU,OAAV,EAAmBX,MAAnB,CAAb;AAEA,eAAKK,KAAL,CAAWO,IAAX,CAAgBC,EAAhB,CAAmBb,MAAM,CAACc,SAAP,CAAiBC,KAApC,EAA2C,KAAKC,UAAhD,EAA4D,IAA5D;AACA,eAAKV,KAAL,CAAWM,IAAX,CAAgBC,EAAhB,CAAmBb,MAAM,CAACc,SAAP,CAAiBC,KAApC,EAA2C,KAAKC,UAAhD,EAA4D,IAA5D;AACH;;AACSC,QAAAA,MAAM,GAAS,CAExB;;AACSC,QAAAA,MAAM,GAAuB,CAEtC;;AAEYC,QAAAA,KAAK,CAACX,OAAD,EAAUC,MAAV,EAAwC;AAAA;;AAAA;AACtD,YAAA,KAAI,CAACD,OAAL,GAAeA,OAAf;AACA,YAAA,KAAI,CAACC,MAAL,GAAcA,MAAd,CAFsD,CAGtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAZsD;AAczD;;AACDO,QAAAA,UAAU,CAACI,GAAD,EAAc;AACpB,kBAAQA,GAAR;AACI,iBAAK,KAAKf,KAAV;AACI,kBAAG,CAAC;AAAA;AAAA,wCAASgB,kBAAT,CAA4B,KAAKb,OAAL,CAAac,gBAAzC,EAA2D,KAAKd,OAAL,CAAae,cAAxE,EAAwF,KAAKf,OAAL,CAAagB,iBAArG,EAAwH,IAAxH,CAAJ,EAAkI;AAC9H;AACH,eAHL,CAII;;;AACA;;AACJ,iBAAK,KAAKlB,KAAV;AAEI;AATR;;AAWA,eAAKmB,IAAL;AACH;;AAlDuC,O","sourcesContent":["import { Button, RichText, RichTextComponent } from \"cc\";\r\nimport { Panel } from \"../../manager/GameRoot\";\r\nimport { StdShop } from \"../../manager/CfgMgr\";\r\nimport { ItemUtil } from \"../../utils/ItemUtils\";\r\nexport class ShopRefreshPanel extends Panel {\r\n    protected prefab: string = \"prefabs/panel/shop/ShopRefreshPanel\";\r\n    private okBtn:Button;\r\n    private noBtn:Button;\r\n    private contLab:RichText;\r\n    private stdShop:StdShop;\r\n    private shopId:number;\r\n    protected onLoad() {\r\n        this.contLab = this.find(\"contLab\", RichTextComponent);\r\n        this.okBtn = this.find(\"okBtn\", Button);\r\n        this.noBtn = this.find(\"noBtn\", Button);\r\n        \r\n        this.okBtn.node.on(Button.EventType.CLICK, this.onBtnClick, this);\r\n        this.noBtn.node.on(Button.EventType.CLICK, this.onBtnClick, this);\r\n    }\r\n    protected onShow(): void {\r\n        \r\n    }\r\n    protected onHide(...args: any[]): void {\r\n        \r\n    }\r\n    \r\n    public async flush(stdShop, shopId:number): Promise<void> {\r\n        this.stdShop = stdShop;\r\n        this.shopId = shopId;\r\n        // let things:SThing[] = ItemUtil.GetSThingList(this.stdShop.RefreshThingType, this.stdShop.RefreshThingId, this.stdShop.RefreshThingCount);\r\n        // let itemName:string = \"\";\r\n        // for (let index = 0; index < things.length; index++) {\r\n        //     let item = things[index];\r\n        //     itemName += `<color=#AD4800><size=48>${item.resData.name} * ${item.resData.count}</size></color>`;\r\n        //     if(index < things.length - 1){\r\n        //         itemName += \"、\";\r\n        //     }   \r\n        // }\r\n        // this.contLab.string = `是否消耗${itemName}马上刷新宝库?`;\r\n        \r\n    }\r\n    onBtnClick(btn: Button) {\r\n        switch (btn) {\r\n            case this.okBtn:\r\n                if(!ItemUtil.CheckThingConsumes(this.stdShop.RefreshThingType, this.stdShop.RefreshThingId, this.stdShop.RefreshThingCount, true)){\r\n                    return;\r\n                }\r\n                // Session.Send({type: MsgTypeSend.ShopManualRefresh, data:{shop_index_id:this.shopId}});\r\n                break;\r\n            case this.noBtn:\r\n               \r\n                break;\r\n        }\r\n        this.Hide();\r\n    }\r\n    \r\n}"]}