{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/manager/Guide.ts"],"names":["Guide","SystenDoor","GuideLay","GuideSub","PointTo","PlayVideo","BlockInputEvents","Button","Input","Label","Layers","Node","Sprite","SpriteFrame","Tween","UITransform","Widget","easing","find","game","instantiate","js","math","path","sp","tween","v3","view","EventMgr","PanelDefine","GameSet","CfgMgr","Tips","CheckCondition","Goto","ResMgr","folder_common","GameObj","Panel","Utils","Snapshot","LocalStorage","PlayerData","constructor","systems","guides","updateLoop","addTick","update","AddChan","Init","fetch","ShowTop","length","door","pop","destory","stdDoors","Get","std","push","guide","player","statusMark","NoobCardsAdd","SetNumber","stdGuids","stdGuide","GetNumber","ID","link","route","split","params","classz","getClassByName","shift","h","Show","target","activeInHierarchy","emit","dt","i","isEnd","splice","open","msg","seed","n","types","values","undefined","type","value","IsArray","uis","UI","HideType","url","active","resetBtn","getChildByName","lock","sprite","addComponent","addChild","LoadResAbSub","join","sf","spriteFrame","maskTouch","size","getComponent","contentSize","sx","getScale","x","sy","y","mask","setContentSize","width","height","on","EventType","TOUCH_START","breakTouch","TOUCH_END","TOUCH_CANCEL","PARENT_CHANGED","onParentChange","e","currentTarget","btn","evt","dispatchEvent","parent","removeChild","off","destroy","isOpen","Std","prefab","onShow","flush","onHide","Add","node","$instance","Del","$loading","cfg","state","progress","pointTo","video","$currentTarget","loop","result","cs","vs","next","end","checkTarget","isRunning","Steps","OpenUI","receive","Type","OverTime","step","Prefabs","Create","Play","modal","console","log","Target","Angle","Offset","TipsAngle","TipsOffset","TipsSize","clickSzie","ClickSize","Childs","id","$prefab","modalMask","finger","pointer","tips","label","overTime","img","imgSp","sub","duration","tipsSize","pointerAngle","offset","msgAngle","msgOffset","secondTick","onLoad","widget","isAlignLeft","isAlignRight","isAlignBottom","isAlignTop","left","right","bottom","top","getVisibleSize","ut","clone","Stop","$hasLoad","loadSub","angle","msgSize","string","prefabNode","setSiblingIndex","name","onModalTouch","layer","Enum","onTouchCanvas","once","onTouch","pointSub","position","setPosition","to","quadOut","call","bind","start","quadIn","out","mainCamera","worldToScreen","worldPosition","p","getLocation","w","Math","abs","isValid","UICamera","CLICK","convertToUINode","Number","Convert","box","GetBoundingBoxTo","max","xMin","xMax","yMin","yMax","cos","toRadian","min","sin","setRotationFromEuler","rad","fingerSize","fingerWide","a","b","Remove","stopAllByTarget","targetUrl","startTick","ls","children","child","totalTime","t","list","index","floor","sk","Skeleton","action","GetSkeAciton","setAnimation","getCurrent","animation","scale","timeScale"],"mappings":"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","sourcesContent":["import { BlockInputEvents, Button, EventTouch, Input, Label, Layers, Node, Size, Sprite, SpriteFrame, System, Tween, UITransform, Vec2, Widget, debug, director, easing, find, game, input, instantiate, js, math, path, sp, tween, v2, v3, view } from \"cc\";\r\nimport { EventMgr } from \"./EventMgr\";\r\nimport { PanelDefine } from \"../PanelDefine\";\r\nimport { GameSet } from \"./GameSet\";\r\nimport { CfgMgr, StdGuide, StdUIOpen } from \"./CfgMgr\";\r\nimport { Tips } from \"../module/common/Tips\";\r\nimport { CheckCondition, Goto } from \"../DL\";\r\nimport { ResMgr, folder_common } from \"./ResMgr\";\r\nimport { GameObj, Panel } from \"./GameRoot\";\r\nimport { Second, Utils } from \"../utils/Utils\";\r\nimport { Snapshot } from \"../utils/Snapshot\";\r\nimport LocalStorage from \"../utils/LocalStorage\";\r\nimport { PlayerData } from \"../module/player/PlayerData\";\r\n\r\n/**\r\n * 引导系统\r\n */\r\nexport class Guide {\r\n\r\n    protected systems: SystenDoor[] = [];\r\n    protected guides: GuideSub[] = [];\r\n\r\n    constructor() {\r\n        GameSet.addTick(this.update, this);\r\n        EventMgr.AddChan('reset_guide', this.Init, this);\r\n        EventMgr.AddChan('ui_guide', this.fetch, this);\r\n    }\r\n\r\n    /**\r\n     * 初始\r\n     */\r\n    protected async Init() {\r\n        await GuideLay.ShowTop();\r\n        while (this.systems.length) {\r\n            let door = this.systems.pop();\r\n            door.destory();\r\n        }\r\n        let stdDoors = CfgMgr.Get(\"SystemOpen\");\r\n        for (let std of stdDoors) {\r\n            let door = new SystenDoor(std);\r\n            this.systems.push(door);\r\n        }\r\n\r\n        while (this.guides.length) {\r\n            let guide = this.guides.pop();\r\n            guide.destory();\r\n        }\r\n\r\n        if (PlayerData.player?.statusMark.NoobCardsAdd) {\r\n            LocalStorage.SetNumber(\"guide301\", 1);\r\n            LocalStorage.SetNumber(\"guide302\", 1);\r\n        }\r\n\r\n        let stdGuids: StdGuide[] = CfgMgr.Get(\"guide\");\r\n        for (let stdGuide of stdGuids) {\r\n            if (!LocalStorage.GetNumber(\"guide\" + stdGuide.ID, 0)) {\r\n                this.guides.push(new GuideSub(stdGuide));\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 打开界面\r\n     * @param link \r\n     * @param params \r\n     * @returns \r\n     */\r\n    protected fetch(link: string, ...params: any[]) {\r\n        let route = link.split(\".\");\r\n        if (PanelDefine[route[0]]) {\r\n            let classz: any = js.getClassByName(route.shift());\r\n            if (!classz) return;\r\n            if (route.length) {\r\n                for (let h of route) {\r\n                    classz = classz[h];\r\n                }\r\n                classz(...params);\r\n            } else {\r\n                classz.Show(...params);\r\n            }\r\n        } else {\r\n            let target = find(route[0]);\r\n            if (target && target.activeInHierarchy && params) {\r\n                target.emit(params.shift(), ...params);\r\n            }\r\n        }\r\n    }\r\n\r\n    protected updateLoop = 0;\r\n    protected update(dt: number) {\r\n        this.updateLoop += dt;\r\n        if (this.updateLoop >= 0.25) {\r\n            this.updateLoop = 0;\r\n            for (let door of this.systems) {\r\n                door.update();\r\n            }\r\n            let i = 0;\r\n            while (i < this.guides.length) {\r\n                let guide = this.guides[i];\r\n                guide.update();\r\n                if (guide.isEnd) {\r\n                    this.guides[i].destory();\r\n                    this.guides.splice(i, 1);\r\n                } else {\r\n                    i++;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * 系统开启\r\n */\r\nclass SystenDoor {\r\n    private std: StdUIOpen;\r\n    private open: boolean = true;\r\n    private msg: string;\r\n    constructor(std: StdUIOpen) {\r\n        this.std = std;\r\n    }\r\n    update() {\r\n        // 判断触发条件\r\n        let seed = true;\r\n        for (let n = 1; ; n++) {\r\n            let types = this.std['ConditionId' + n];\r\n            let values = this.std['ConditionValue' + n];\r\n            if (types == undefined || types.length == 0 || values == undefined) break;\r\n\r\n            for (let i = 0; i < types.length; i++) {\r\n                let type = types[i];\r\n                let value = values[i];\r\n                if (!Utils.IsArray(value)) value = [value];\r\n                if (!CheckCondition(type, ...value)) this.msg = this.std.Tips;\r\n                if (this.msg != undefined) {\r\n                    seed = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (seed) break;\r\n        }\r\n        if (seed) {\r\n            if (!this.open) {\r\n                this.open = true;\r\n            } else {\r\n                return;\r\n            }\r\n        } else if (this.open) {\r\n            this.open = false;\r\n        } else {\r\n            return;\r\n        }\r\n        let uis: string[] = this.std.UI;\r\n        let types: number[] = this.std.HideType;\r\n        for (let i = 0; i < uis.length; i++) {\r\n            let url = uis[i];\r\n            let target = find(url);\r\n            if (!target) continue;\r\n            // 系统入口开启或隐藏样式\r\n            switch (types[i]) {\r\n                case 0:\r\n                    target.active = this.open;\r\n                    break;\r\n                case 1:\r\n                    if (this.open) {\r\n                        this.resetBtn(target);\r\n                    } else {\r\n                        if (target.getChildByName(`lock`)) {\r\n                            target.getChildByName(`lock`).active = true;\r\n                        } else {\r\n                            let lock = new Node(\"lock\");\r\n                            let sprite = lock.addComponent(Sprite);\r\n                            target.addChild(lock);\r\n                            ResMgr.LoadResAbSub(path.join(folder_common, \"lock/spriteFrame\"), SpriteFrame, sf => {\r\n                                sprite.spriteFrame = sf;\r\n                            });\r\n                        }\r\n                        this.maskTouch(target);\r\n                    }\r\n                    break;\r\n                default:\r\n                    target.active = this.open;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected maskTouch(target: any) {\r\n        if (!target['$$mask']) {\r\n            let size = target.getComponent(UITransform).contentSize;\r\n            let sx = target.getScale().x, sy = target.getScale().y;\r\n            let mask = new Node('mask');\r\n            mask.addComponent(Sprite);\r\n            mask.addComponent(BlockInputEvents);\r\n            mask.getComponent(UITransform).setContentSize(size.width * sx, size.height * sy);\r\n            target.addChild(mask);\r\n            target['$$mask'] = mask;\r\n            mask['$$target'] = target;\r\n            mask.on(Input.EventType.TOUCH_START, this.breakTouch, this);\r\n            mask.on(Input.EventType.TOUCH_END, this.breakTouch, this);\r\n            mask.on(Input.EventType.TOUCH_CANCEL, this.breakTouch, this);\r\n            target.on(Node.EventType.PARENT_CHANGED, this.onParentChange, this);\r\n        }\r\n    }\r\n    protected breakTouch(e: EventTouch) {\r\n        let target = e.currentTarget['$$target'];\r\n        let btn = target.getComponent(Button);\r\n        if (btn) {\r\n            if (e.type == Input.EventType.TOUCH_END) {\r\n                btn['_pressed'] = false;\r\n                btn['_updateState']();\r\n            } else {\r\n                let evt = instantiate(e);\r\n                evt.target = btn;\r\n                evt.currentTarget = btn;\r\n                target.dispatchEvent(evt);\r\n            }\r\n        }\r\n        if (e.type == Input.EventType.TOUCH_END) Tips.Show(this.msg);\r\n    }\r\n    protected onParentChange(target: any) {\r\n        if (!target || !target['$$mask']) return;\r\n        if (target['$$mask'].parent) {\r\n            target['$$mask'].parent.removeChild(target['$$mask']);\r\n        }\r\n    }\r\n\r\n    resetBtn(target: Node) {\r\n        target.active = true\r\n        if (target.getChildByName(`lock`)) target.getChildByName(`lock`).active = false;\r\n        if (target['$$mask']) {\r\n            let mask = target['$$mask'];\r\n            target['$$mask'] = undefined;\r\n            mask.off(Input.EventType.TOUCH_START);\r\n            mask.off(Input.EventType.TOUCH_END);\r\n            mask.off(Input.EventType.TOUCH_CANCEL);\r\n            mask.parent && mask.parent.removeChild(mask);\r\n            mask.destroy();\r\n        }\r\n    }\r\n    get isOpen() {\r\n        return this.open;\r\n    }\r\n    get Std() {\r\n        return this.std;\r\n    }\r\n\r\n    destory() {\r\n        if (!this.std) return;\r\n        let uis: string[] = this.std.UI;\r\n        if (!uis) return;\r\n        for (let i = 0; i < uis.length; i++) {\r\n            let url = uis[i];\r\n            let target = find(url);\r\n            if (!target) continue;\r\n            target.active = true;\r\n            this.resetBtn(target);\r\n        }\r\n    }\r\n}\r\n\r\nexport class GuideLay extends Panel {\r\n    protected prefab: string = \"prefabs/guide/GuideLay\";\r\n    protected onShow(): void { }\r\n    public flush(...args: any[]): void { }\r\n    protected onHide(...args: any[]): void { }\r\n    static async Add(node: Node) {\r\n        if (!this.$instance) await this.ShowTop();\r\n        this.$instance.node.addChild(node);\r\n    }\r\n    static async Del(node: Node) {\r\n        if (!this.$instance) await this.$loading;\r\n        this.$instance.node.removeChild(node);\r\n    }\r\n}\r\n\r\n/**\r\n * 引导\r\n */\r\nexport class GuideSub {\r\n    protected state: number;\r\n    protected progress: number;\r\n    protected cfg: StdGuide;\r\n    protected pointTo: PointTo;\r\n    protected video: PlayVideo;\r\n    protected $currentTarget: Node;\r\n    protected loop = 0;\r\n\r\n    constructor(cfg: StdGuide) {\r\n        this.cfg = cfg;\r\n        this.progress = 0;\r\n        this.state = 0;\r\n    }\r\n\r\n    set currentTarget(value: Node) {\r\n        this.$currentTarget = value;\r\n    }\r\n    get currentTarget() {\r\n        return this.$currentTarget\r\n    }\r\n\r\n    update() {\r\n        if (!this.state) {\r\n            let result = true;\r\n            for (let n = 1; ; n++) {\r\n                let cs = this.cfg[\"ConditionId\" + n];\r\n                if (cs == undefined || !cs.length) break;\r\n                let vs = this.cfg[\"ConditionValue\" + n];\r\n                for (let i = 0; i < cs.length; i++) {\r\n                    let values = vs[i];\r\n                    if (!Utils.IsArray(values)) values = [values];\r\n                    if (!CheckCondition(cs[i], ...values)) {\r\n                        result = false;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (result) {\r\n                //开始指引\r\n                this.state = 1;\r\n                this.progress = -1;\r\n                this.next();\r\n            }\r\n        } else if (this.state == 1) {\r\n            let result = false;\r\n            for (let n = 1; ; n++) {\r\n                let cs = this.cfg[\"EndConditionId\" + n];\r\n                if (cs == undefined || !cs.length) break;\r\n                let vs = this.cfg[\"EndConditionValue\" + n];\r\n                for (let i = 0; i < cs.length; i++) {\r\n                    let values = vs[i];\r\n                    if (!Utils.IsArray(values)) values = [values];\r\n                    if (CheckCondition(cs[i], ...values)) {\r\n                        result = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (result) {\r\n                this.end();\r\n            } else {\r\n                if (!this.currentTarget) {\r\n                    this.next();\r\n                } else {\r\n                    this.checkTarget();\r\n                }\r\n            }\r\n        }\r\n    }\r\n    get isRunning() {\r\n        return this.state == 1;\r\n    }\r\n    get isEnd() {\r\n        return this.state == 2;\r\n    }\r\n    protected async next(e?: any) {\r\n        if (this.progress + 1 <= this.cfg.Steps.length) {\r\n            if (e && this.cfg.OpenUI[this.progress]) {\r\n                Goto(this.cfg.OpenUI[this.progress]);\r\n            }\r\n\r\n            if (this.pointTo) {\r\n                this.pointTo.receive();\r\n                this.pointTo = undefined;\r\n            }\r\n            if (this.video) {\r\n                this.video.receive();\r\n                this.video = undefined;\r\n            }\r\n            this.currentTarget = undefined;\r\n            let i = this.progress + 1, cfg = this.cfg;\r\n            if (!cfg.Type[i] && cfg.OverTime[i] == undefined) {\r\n                this.progress++;\r\n                return this.next();\r\n            }\r\n            let step = cfg.Steps[i];\r\n            if (cfg?.Type?.[i] == 3) {\r\n                if (!cfg.Prefabs[i]) return this.next();\r\n                this.video = PlayVideo.Create(\"prefabs/guide/\" + cfg.Prefabs[i]);\r\n                this.video.on(\"end\", this.next, this);\r\n                this.video.Play(cfg?.OverTime?.[i] || 0);\r\n                this.progress++;\r\n                this.currentTarget = this.video;\r\n                return;\r\n            }\r\n            this.currentTarget = step ? find(step) : undefined;\r\n            if (!this.currentTarget || !this.currentTarget.activeInHierarchy) {\r\n                this.currentTarget = undefined;\r\n                return;\r\n            }\r\n            let modal = false;\r\n            if (cfg.Type?.[i] == 0) {\r\n                modal = true;\r\n            } else {\r\n                modal = cfg.Type?.[i] == 2;\r\n            }\r\n            this.pointTo = PointTo.Create();\r\n            this.pointTo.on(\"end\", this.next, this);\r\n            console.log(\"Step--->\", step, this.currentTarget);\r\n            this.pointTo.Target(this.currentTarget, cfg.Angle?.[i], cfg.Tips?.[i], modal, cfg.Offset?.[i], cfg.TipsAngle?.[i], cfg.TipsOffset?.[i], cfg.TipsSize?.[i], cfg.OverTime[i] ? cfg.OverTime[i] : undefined);\r\n            this.pointTo.clickSzie = [cfg?.ClickSize?.[0] || 100, cfg?.ClickSize?.[1] || 100];\r\n            this.progress++;\r\n        } else {\r\n            this.end();\r\n        }\r\n    }\r\n    protected checkTarget() {\r\n        let cfg = this.cfg;\r\n        let step = this.cfg.Steps[this.progress];\r\n        if (this.cfg?.Type?.[this.progress] == 3) return;\r\n        let target = step ? find(step) : undefined;\r\n        if (!this.currentTarget || this.currentTarget == target) return;\r\n        let modal = false;\r\n        if (this.cfg.Type?.[this.progress] == 0) {\r\n            modal = true;\r\n        } else {\r\n            modal = this.cfg.Type?.[this.progress] == 2;\r\n        }\r\n        let i = this.progress;\r\n        this.currentTarget = target;\r\n        if (this.pointTo) this.pointTo.receive()\r\n        this.pointTo = PointTo.Create();\r\n        this.pointTo.on(\"end\", this.next, this);\r\n        this.pointTo.Target(this.currentTarget, cfg.Angle?.[i], cfg.Tips?.[i], modal, cfg.Offset?.[i], cfg.TipsAngle?.[i], cfg.TipsOffset?.[i], cfg.TipsSize?.[i], cfg.OverTime[i] ? cfg.OverTime[i] : undefined);\r\n        this.pointTo.clickSzie = [cfg?.ClickSize?.[0] || 100, cfg?.ClickSize?.[1] || 100];\r\n    }\r\n    protected end() {\r\n        LocalStorage.SetNumber(\"guide\" + this.cfg.ID, 1);\r\n        if (this.cfg.Childs) {\r\n            for (let id of this.cfg.Childs) {\r\n                LocalStorage.SetNumber(\"guide\" + id, 1);\r\n            }\r\n        }\r\n        this.state = 2;\r\n        this.currentTarget = undefined;\r\n        if (this.pointTo) {\r\n            this.pointTo.receive();\r\n            this.pointTo = undefined;\r\n        }\r\n        if (this.video) {\r\n            this.video.receive();\r\n            this.video = undefined;\r\n        }\r\n\r\n        if (this.cfg.OpenUI[this.cfg.OpenUI.length - 1]) {\r\n            Goto(this.cfg.OpenUI[this.cfg.OpenUI.length - 1]);\r\n        }\r\n    }\r\n    destory() {\r\n        this.currentTarget = undefined;\r\n        if (this.pointTo) {\r\n            this.pointTo.receive();\r\n            this.pointTo = undefined;\r\n        }\r\n        if (this.video) {\r\n            this.video.receive();\r\n            this.video = undefined;\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * 指引\r\n */\r\nexport class PointTo extends GameObj {\r\n    protected $prefab: string = \"prefabs/guide/PointTo\";\r\n    protected cfg: StdGuide;\r\n    protected modalMask: Node;\r\n    protected finger: Node;\r\n    protected pointer: Node;\r\n    protected tips: Node;\r\n    protected label: Label;\r\n\r\n    target: Node;\r\n    protected overTime: number;\r\n    protected img: Node;\r\n    protected imgSp: Sprite;\r\n    protected sub = 50;\r\n    protected duration = 0.4;\r\n    protected modal = false;\r\n    protected tipsSize: Size;\r\n    protected pointerAngle: number;\r\n    protected offset: number[];\r\n    protected msgAngle: number;\r\n    protected msgOffset: number[];\r\n\r\n    protected onLoad(): void {\r\n        let widget = this.addComponent(Widget);\r\n        widget.isAlignLeft = widget.isAlignRight = widget.isAlignBottom = widget.isAlignTop = true;\r\n        widget.left = 0;\r\n        widget.right = 0;\r\n        widget.bottom = 0;\r\n        widget.top = 0;\r\n        let size = view.getVisibleSize();\r\n        let ut = this.getComponent(UITransform);\r\n        ut.setContentSize(size);\r\n        this.modalMask = this.find(\"mask\");\r\n        this.pointer = this.find(\"pointer\");\r\n        this.finger = this.pointer.getChildByName(\"finger\");\r\n        this.tips = this.find(\"tips\");\r\n        this.label = this.find(\"tips/label\").getComponent(Label);\r\n        this.tipsSize = this.tips.getComponent(UITransform).contentSize.clone();\r\n    }\r\n\r\n    async Stop() {\r\n        if (!this.$hasLoad) await this.loadSub;\r\n        this.active = false;\r\n    }\r\n\r\n    async Target(node: Node, angle: number, msg: string = \"\", modal: boolean = false, offset: number[], msgAngle?: number, msgOffset?: number[], msgSize?: number[], duration?: number) {\r\n        GuideLay.Add(this);\r\n        this.clickSzie = [];\r\n        this.overTime = duration;\r\n        this.pointerAngle = angle;\r\n        this.modal = modal;\r\n        if (!this.$hasLoad) await this.loadSub;\r\n        // this.modalMask.active = modal;\r\n        if (!msgSize) msgSize = [this.tipsSize.x, this.tipsSize.y];\r\n        this.offset = offset || [0, 0];\r\n        this.msgAngle = msgAngle;\r\n        this.msgOffset = msgOffset || [0, 0];\r\n        this.tips.getComponent(UITransform).setContentSize(msgSize[0], msgSize[1]);\r\n        this.label.string = msg;\r\n        this.tips.active = (msg != \"\");\r\n        this.target = node;\r\n        if (this.modal) {\r\n            this.img = Snapshot.Add(this.target);\r\n            this.prefabNode.addChild(this.img);\r\n            this.img.setSiblingIndex(1);\r\n            this.img.name = msg;\r\n            this.img.on(Input.EventType.TOUCH_START, this.onModalTouch, this);\r\n        } else {\r\n            if (this.target.layer & Layers.Enum['SCENE']) {\r\n                find(\"Canvas\").on(Input.EventType.TOUCH_START, this.onTouchCanvas, this);\r\n            } else {\r\n                this.target.once(Input.EventType.TOUCH_START, this.onTouch, this);\r\n            }\r\n        }\r\n\r\n        this.pointSub();\r\n        this.update(1);\r\n    }\r\n    protected pointSub() {\r\n        if (this.finger.position.x < this.sub) {\r\n            this.finger.setPosition(0, 0, 0);\r\n            tween(this.finger).to(this.duration, { position: v3(this.sub, 0, 0) }, { easing: easing.quadOut }).call(this.pointSub.bind(this)).start();\r\n        } else {\r\n            this.finger.setPosition(this.sub, 0, 0);\r\n            tween(this.finger).to(this.duration, { position: v3(0, 0, 0) }, { easing: easing.quadIn }).call(this.pointSub.bind(this)).start();\r\n        }\r\n    }\r\n    clickSzie = [];\r\n    protected onTouchCanvas(e: EventTouch) {\r\n        let out = v3();\r\n        GameSet.mainCamera.worldToScreen(this.target.worldPosition, out);\r\n        let p = e.getLocation();\r\n        let w = this.clickSzie[0] || 100, h = this.clickSzie[1] || 100;\r\n        if (Math.abs(p.x - out.x) <= w && Math.abs(p.y - out.y) <= h) {\r\n            if (this.target) {\r\n                e.type = Input.EventType.TOUCH_END;\r\n                this.target.dispatchEvent(e);\r\n                this.end();\r\n            } else {\r\n\r\n            }\r\n        }\r\n    }\r\n    protected onModalTouch(e: EventTouch) {\r\n        if (this.target && this.target.isValid) {\r\n            let out = v3();\r\n            if (this.target.layer & Layers.Enum['SCENE']) {\r\n                GameSet.mainCamera.worldToScreen(this.target.worldPosition, out);\r\n                let p = e.getLocation();\r\n                let w = this.clickSzie[0] || 100, h = this.clickSzie[1] || 100;\r\n                if (Math.abs(p.x - out.x) <= w && Math.abs(p.y - out.y) <= h) {\r\n\r\n                } else return;\r\n            } else {\r\n                GameSet.UICamera.worldToScreen(this.target.worldPosition, out);\r\n                let p = e.getLocation();\r\n                let w = 100, h = 100;\r\n                if (this.clickSzie[0] != undefined && this.clickSzie[1] != undefined) {\r\n                    w = this.clickSzie[0], h = this.clickSzie[1];\r\n                }\r\n                if (Math.abs(p.x - out.x) <= w && Math.abs(p.y - out.y) <= h) {\r\n\r\n                } else return;\r\n            }\r\n            e.type = Input.EventType.TOUCH_END;\r\n            this.target.dispatchEvent(e);\r\n            this.target.emit(Button.EventType.CLICK, this.target.getComponent(Button));\r\n        }\r\n        this.end();\r\n    }\r\n    protected onTouch(e: EventTouch) {\r\n        if (this.target && this.target.isValid) {\r\n            this.target.off(Input.EventType.TOUCH_START, this.onTouch, this);\r\n        }\r\n        this.end();\r\n    }\r\n\r\n    protected secondTick = 0;\r\n    protected update(dt: number) {\r\n        if (this.overTime != undefined) {\r\n            this.overTime -= dt;\r\n            if (this.overTime <= 0) {\r\n                // if (this.target && this.target.isValid) {\r\n                //     this.target.dispatchEvent(new EventTouch([], true, Input.EventType.TOUCH_END));\r\n                //     this.target.emit(Button.EventType.CLICK, this.target.getComponent(Button));\r\n                // }\r\n                this.overTime = undefined;\r\n                this.end();\r\n                return;\r\n            }\r\n        }\r\n        this.secondTick += dt;\r\n        if (!this.target || this.secondTick < 0.25) return;\r\n        this.secondTick = 0;\r\n\r\n        if (!this.modal && !this.target.activeInHierarchy) {\r\n            this.active = false;\r\n            return;\r\n        }\r\n        this.active = true;\r\n        let offset = this.offset;\r\n        if (this.target.layer & Layers.Enum['SCENE']) {\r\n            let out = v3();\r\n            GameSet.mainCamera.convertToUINode(this.target.worldPosition, find(\"Canvas\"), out);\r\n            this.pointer.setPosition(out.x + (Number(offset[0]) || 0), out.y + Number(offset[1] || 0));\r\n        } else {\r\n            let [x, y] = Utils.Convert(0, 0, this.target, this.prefabNode);\r\n            let box = Utils.GetBoundingBoxTo(this.target, this.pointer.parent);\r\n            let w = Math.max(Math.abs(box.xMin - x), Math.abs(box.xMax - x));\r\n            let h = Math.max(Math.abs(box.yMin - y), Math.abs(box.yMax - y));\r\n            w = Math.max(w, h) * Math.cos(math.toRadian(this.pointerAngle));\r\n            h = Math.min(w, h) * Math.sin(math.toRadian(this.pointerAngle));\r\n            this.pointer.setPosition(x + w + (Number(offset[0]) || 0), y + h + Number(offset[1] || 0));\r\n        }\r\n        this.pointer.setRotationFromEuler(0, 0, this.pointerAngle);\r\n\r\n        let rad = math.toRadian(this.pointerAngle);\r\n        if (this.msgAngle) rad = this.msgAngle;\r\n\r\n        let fingerSize = this.finger.getComponent(UITransform).contentSize;\r\n        let fingerWide = Math.max(fingerSize.width, fingerSize.height);\r\n        let size = this.tips.getComponent(UITransform).contentSize;\r\n        let a = Math.max(size.width, size.height) / 2 + this.sub + fingerWide;\r\n        let b = Math.min(size.width, size.height) / 2 + this.sub + fingerWide;\r\n        this.tips.setPosition(this.pointer.position.x + a * Math.cos(rad) + this.msgOffset[0], this.pointer.position.y + b * Math.sin(rad) + this.msgOffset[1]);\r\n    }\r\n\r\n    protected end() {\r\n        if (this.target) {\r\n            this.target.off(Input.EventType.TOUCH_START, this.onTouch, this);\r\n            Snapshot.Remove(this.target);\r\n        }\r\n        if (this.img) {\r\n            this.img.off(Input.EventType.TOUCH_START, this.onModalTouch, this);\r\n            this.img.parent && this.img.parent.removeChild(this.img);\r\n        }\r\n        find(\"Canvas\").off(Input.EventType.TOUCH_START, this.onTouchCanvas, this);\r\n        this.emit('end', this);\r\n    }\r\n    async receive() {\r\n        if (!this.$hasLoad) await this.loadSub;\r\n        if (this.target) {\r\n            this.target.off(Input.EventType.TOUCH_START, this.onTouch, this);\r\n            Snapshot.Remove(this.target);\r\n        }\r\n        this.off(\"end\");\r\n        this.Stop();\r\n        if (this.img) {\r\n            this.img.off(Input.EventType.TOUCH_START, this.onModalTouch, this);\r\n            this.img.parent && this.img.parent.removeChild(this.img);\r\n            this.img.off(Input.EventType.TOUCH_END);\r\n        }\r\n        this.img = undefined;\r\n        if (this.target) {\r\n            if (this.target.isValid) this.target.off(Input.EventType.TOUCH_END, this.onTouch, this);\r\n            this.target = undefined;\r\n        }\r\n        find(\"Canvas\").off(Input.EventType.TOUCH_START, this.onTouchCanvas, this);\r\n        Tween.stopAllByTarget(this.pointer);\r\n        super.receive();\r\n    }\r\n}\r\n\r\nclass PlayVideo extends GameObj {\r\n    protected $prefab: string;\r\n    protected targetUrl: string;\r\n    protected duration: number;\r\n    protected startTick: number;\r\n    async Play(duration: number) {\r\n        GuideLay.Add(this);\r\n        if (!this.$hasLoad) await this.loadSub;\r\n        let ls = this.prefabNode.children;\r\n        for (let child of ls) {\r\n            child.active = false;\r\n        }\r\n        this.duration = duration || 0.1;\r\n        this.startTick = game.totalTime / 1000;\r\n    }\r\n    protected update(dt: number): void {\r\n        let t = game.totalTime / 1000 - this.startTick;\r\n        if (t >= this.duration) {\r\n            this.end();\r\n            if (this.parent) this.parent.removeChild(this);\r\n            return;\r\n        }\r\n        let list = this.prefabNode.children;\r\n        let index = Math.floor(t / this.duration * list.length);\r\n        for (let i = 0; i < list.length; i++) {\r\n            let child = list[i];\r\n            if (i == index) {\r\n                if (!child.active) {\r\n                    child.active = true;\r\n                    let sk = child.getComponent(sp.Skeleton);\r\n                    if (sk) {\r\n                        let action = Utils.GetSkeAciton(sk);\r\n                        sk.setAnimation(0, action, false);\r\n                        let duration = sk.getCurrent(0)?.animation?.duration || 0;\r\n                        let scale = Math.min(1, this.duration / duration)\r\n                        sk.timeScale = scale;\r\n                    }\r\n                }\r\n            } else {\r\n                child.active = false;\r\n            }\r\n        }\r\n    }\r\n    end() {\r\n        this.emit('end', this);\r\n    }\r\n}"]}