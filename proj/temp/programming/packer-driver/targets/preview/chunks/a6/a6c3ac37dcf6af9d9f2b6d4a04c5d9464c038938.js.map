{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/friend/FriendSortPanel.ts"],"names":["FriendSortPanel","EditBox","Input","Label","ScrollView","Toggle","Panel","AutoScroller","Session","MsgTypeSend","SFriendSortType","prefab","sortListNode","filtrateListNode","sortList","filtrateList","serch","nav","sortData","id","SortDailyOutputDesc","string","SortDailyOutputAsc","SortTotalOutputDesc","SortTotalOutputAsc","SortBindTimeDesc","SortBindTimeAsc","sortvipData","callBcak","selectSortType","pageSize","filter_type","onLoad","CloseBy","find","onBtnEvent","children","forEach","node","index","on","EventType","TOUCH_END","setNav","getChildByName","EDITING_DID_ENDED","onEditEnd","getComponent","SetHandle","updateSortItem","bind","updateFiltrateItem","onShow","isChecked","flush","page_size","callback","sort_type","search","updataSortDatas","active","getComponentInChildren","resetNode","item","content","getSiblingIndex","filter_item","UpdateDatas","data","off","TOGGLE","toggle","onSend","str","type","GetDownlinesRequest","page","search_player_id","Send","onHide","playerid","removeAllChildren"],"mappings":"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","sourcesContent":["import { Button, Component, EditBox, EventHandler, EventTouch, Input, Label, Layout, Node, ScrollView, Sprite, SpriteFrame, Toggle, find, instantiate, path, sp, tween, view } from \"cc\";\r\nimport { Panel } from \"../../GameRoot\";\r\nimport { AutoScroller } from \"../../utils/AutoScroller\";\r\nimport { Session } from \"../../net/Session\";\r\nimport { MsgTypeSend } from \"../../MsgType\";\r\nimport { } from \"../roleModule/PlayerData\"\r\n import {SFriendSortType} from \"../roleModule/PlayerStruct\";\r\n\r\nexport class FriendSortPanel extends Panel {\r\n    protected prefab: string = \"prefabs/panel/friend/FriendSortPanel\";\r\n\r\n    private sortListNode: Node = null;\r\n    private filtrateListNode: Node = null;\r\n    private sortList: Node = null;\r\n    private filtrateList: Node = null;\r\n    // private tittle:Label;\r\n    private serch: Node = null;\r\n    private nav: Node = null;\r\n    private sortData = [\r\n        { id: SFriendSortType.SortDailyOutputDesc, string: `本日收益从高到低` },\r\n        { id: SFriendSortType.SortDailyOutputAsc, string: `本日收益从低到高` },\r\n        { id: SFriendSortType.SortTotalOutputDesc, string: `累计收益从高到低` },\r\n        { id: SFriendSortType.SortTotalOutputAsc, string: `累计收益低到高` }, \r\n        { id: SFriendSortType.SortBindTimeDesc, string: `时间从早到晚` },\r\n        { id: SFriendSortType.SortBindTimeAsc, string: `时间从晚到早` },\r\n    ]\r\n\r\n    private sortvipData = [\r\n        { id: 1, string: `开通权益卡` }, \r\n    ]\r\n\r\n    // private lastSortType:number;\r\n    // private latSortSearch:string;\r\n\r\n    private callBcak:Function;\r\n    private selectSortType:SFriendSortType;\r\n    private pageSize:number;\r\n    private filter_type: number = 0;\r\n    protected onLoad() {\r\n        this.CloseBy(\"mask\");\r\n        this.CloseBy(\"panel/closeBtn\");\r\n        this.sortListNode = this.find(`panel/sortList`);\r\n        this.filtrateListNode = this.find(`panel/filtrateList`);\r\n        this.sortList = this.find(`panel/sortList/leftLayout`);\r\n        this.filtrateList = this.find(`panel/filtrateList/leftLayout`);\r\n        // this.tittle  = this.find(\"panel/sortList/title\",Label);\r\n        this.serch = this.find(`panel/serch`);\r\n        this.nav = this.find(`panel/nav`);\r\n        this.onBtnEvent();\r\n    }\r\n\r\n    private onBtnEvent() {\r\n        this.nav.children.forEach((node, index) => {\r\n            node.on(Input.EventType.TOUCH_END, () => {\r\n                this.setNav(index)\r\n            })\r\n        })\r\n        this.serch.getChildByName(`EditBox`).on(EditBox.EventType.EDITING_DID_ENDED, this.onEditEnd, this)\r\n        this.sortList.getComponent(AutoScroller).SetHandle(this.updateSortItem.bind(this));\r\n        this.filtrateList.getComponent(AutoScroller).SetHandle(this.updateFiltrateItem.bind(this));\r\n       // this.filtrateList.getComponent(AutoScroller).node.on('select', this.onSelect, this);\r\n    }\r\n  \r\n    protected onShow(): void {\r\n        this.nav.children[0].getComponent(Toggle).isChecked = true;\r\n    }\r\n\r\n    flush(page_size:number,callback:Function, sort_type:number, search:string, filter_type: number) {  \r\n        this.pageSize = page_size;\r\n        this.callBcak = callback;\r\n        this.selectSortType = sort_type;\r\n        // this.latSortSearch = search;  \r\n        this.filter_type = filter_type;    \r\n        this.updataSortDatas(0);\r\n        this.setNav(0)\r\n    }\r\n\r\n    private setNav(index) {\r\n        // this.sortList.getComponent(ScrollView).content.removeAllChildren();  \r\n        this.serch.active = (index != 0);\r\n        this.sortListNode.active = (index == 0);\r\n        this.filtrateListNode.active = (index == 1);\r\n        // this.tittle.string = (index == 0) ? \"排序搜索\" : \"筛选\";\r\n       \r\n        this.serch.getComponentInChildren(EditBox).string = ``;\r\n        this.resetNode(index);\r\n    }\r\n\r\n    private resetNode(index) {\r\n        if(index == 0){\r\n            let item = this.sortList.getComponent(ScrollView).content.children;\r\n            item.forEach(item => {\r\n                item.getSiblingIndex() + 1\r\n                if( this.selectSortType == item.getSiblingIndex() + 1){\r\n                    item.getComponent(Toggle).isChecked = true;\r\n                }\r\n            });  \r\n        }else{  \r\n            let filter_item = this.filtrateList.getComponent(ScrollView).content.children;\r\n            filter_item.forEach(filter_item => {\r\n                filter_item.getSiblingIndex() + 1\r\n                if( this.filter_type == filter_item.getSiblingIndex() + 1){\r\n                    filter_item.getComponent(Toggle).isChecked = true;\r\n                }\r\n            }); \r\n        }\r\n    }\r\n\r\n    private updataSortDatas(index) {\r\n        // if(index == 0){\r\n            this.sortList.getComponent(AutoScroller).UpdateDatas(this.sortData)\r\n        // }else{   \r\n            this.filtrateList.getComponent(AutoScroller).UpdateDatas(this.sortvipData)\r\n        // }\r\n    }\r\n\r\n    /**搜索栏事件 */\r\n    private onEditEnd() {\r\n    }\r\n\r\n    private updateSortItem(item, data) {\r\n        item.getComponent(Toggle).isChecked = false;\r\n        item.getChildByName(`title`).getComponent(Label).string = `${data.string}`;\r\n        item.off(Toggle.EventType.TOGGLE);\r\n        item.on(Toggle.EventType.TOGGLE, (toggle) => {\r\n            if (toggle.getComponent(Toggle).isChecked) {\r\n                this.selectSortType = data.id\r\n            }\r\n        })\r\n    }\r\n\r\n    private updateFiltrateItem(item, data) {\r\n        item.getComponent(Toggle).isChecked = false;\r\n        item.getChildByName(`title`).getComponent(Label).string = `${data.string}`;\r\n        item.off(Toggle.EventType.TOGGLE);\r\n        item.on(Toggle.EventType.TOGGLE, (toggle) => {\r\n            if (toggle.getComponent(Toggle).isChecked) {\r\n                this.filter_type = data.id\r\n            }else{\r\n                this.filter_type = 0\r\n            }\r\n        })\r\n    }\r\n\r\n    private onSend(){\r\n        let str = this.serch.getComponentInChildren(EditBox).string;\r\n        let data = {\r\n            type:MsgTypeSend.GetDownlinesRequest,\r\n            data:{page:1, page_size:this.pageSize, sort_type:this.selectSortType, filter_type: this.filter_type, search_player_id:str}\r\n        }\r\n        Session.Send(data);\r\n    }\r\n\r\n    // protected  onSelect(index: number, item: Node):void {\r\n    //     console.log(item.getComponent(Toggle).isChecked)\r\n    //     this.filter_type = item.getComponent(Toggle).isChecked ? 1 : 0;\r\n    // }\r\n \r\n    protected onHide(...args: any[]): void {      \r\n       this.onSend();\r\n       let playerid = this.serch.getComponentInChildren(EditBox).string;\r\n       this.callBcak(this.selectSortType, playerid, this.filter_type);\r\n       this.sortList.getComponent(ScrollView).content.removeAllChildren();\r\n       this.filtrateList.getComponent(ScrollView).content.removeAllChildren();\r\n    }\r\n  \r\n}"]}