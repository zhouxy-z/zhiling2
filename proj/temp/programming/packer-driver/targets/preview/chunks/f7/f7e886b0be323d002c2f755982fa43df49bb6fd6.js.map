{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/friend/FriendSharePanel.ts"],"names":["FriendSharePanel","Button","Label","Sprite","SpriteFrame","path","Panel","EventMgr","QrcodeMaker","GetInviteCode","SaveImage","PlayerData","ResMgr","folder_head_round","AudioMgr","Audio_CommonClick","prefab","save","name_str","uid_str","sever_str","icon","onLoad","url","qrcode","Create","setPosition","find","addChild","CloseBy","node","on","onSave","onShow","flush","string","roleInfo","name","player_id","icon_url","spriteFrame","LoadResAbSub","join","btn","PlayOnce","onClose","Hide","onHide"],"mappings":"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","sourcesContent":["import { Button, EditBox, EventTouch, Input, Label, Node, Sprite, SpriteFrame, Toggle, Touch, UIOpacity, instantiate, path, v3 } from \"cc\";\r\nimport { Panel } from \"../../GameRoot\";\r\nimport { EventMgr, Evt_CloseFriendBindOrUnbindPanel } from \"../../manager/EventMgr\";\r\nimport { QrcodeMaker } from \"../../utils/QrcodeMaker\";\r\nimport { GetDeviceInfo, GetInviteCode } from \"../../Platform\";\r\nimport { SaveImage } from \"../../utils/SaveImage\";\r\nimport PlayerData from \"../roleModule/PlayerData\";\r\nimport { ResMgr, folder_head_round } from \"../../manager/ResMgr\";\r\nimport { AudioMgr, Audio_CommonClick } from \"../../manager/AudioMgr\";\r\n\r\nexport class FriendSharePanel extends Panel {\r\n    protected prefab: string = \"prefabs/panel/friend/FriendSharePanel\";\r\n\r\n    \r\n    private save: Button;\r\n    private name_str: Label;\r\n    private uid_str: Label;\r\n    private sever_str: Label;\r\n    private icon: Sprite;\r\n   \r\n    protected onLoad(): void {\r\n        //25328825\r\n        let url = \"http://test.daochat.cn?inviteCode=\"+GetInviteCode()+\"&appId=test\";\r\n        let qrcode = QrcodeMaker.Create(url, 240, 240);\r\n        qrcode.setPosition(-120,-120)\r\n        this.find(\"node/qrcode\").addChild(qrcode);\r\n\r\n        this.CloseBy(\"node\");  \r\n        this.name_str = this.find(\"node/name_str\", Label);  \r\n        this.uid_str = this.find(\"node/uid_str\", Label);  \r\n        this.sever_str = this.find(\"node/sever_str\", Label);  \r\n        this.icon = this.find(\"node/bg/Mask/icon\", Sprite);     \r\n        this.save = this.find(\"node/save\", Button);     \r\n        this.save.node.on(\"click\", this.onSave, this);    \r\n        // EventMgr.on(Evt_CloseFriendBindOrUnbindPanel, this.onClose, this)\r\n    }\r\n\r\n    protected onShow(): void {\r\n        \r\n    }\r\n\r\n    async flush() {\r\n        this.name_str.string = PlayerData.roleInfo.name;\r\n        this.uid_str.string = \"ID:\" + PlayerData.roleInfo.player_id;\r\n        // this.sever_str.string = \"\";\r\n        let url =  PlayerData.roleInfo.icon_url?  PlayerData.roleInfo.icon_url: \"01\"\r\n        this.icon.spriteFrame = await ResMgr.LoadResAbSub(path.join(folder_head_round,  url, \"spriteFrame\"), SpriteFrame);\r\n    }\r\n\r\n\r\n    private onSave(btn:Button) {\r\n        AudioMgr.PlayOnce(Audio_CommonClick);\r\n        EventMgr.on(\"save_image_complete\",this.onClose,this);\r\n        SaveImage(this.find(\"node\"));\r\n    }\r\n\r\n\r\n    private onClose(){\r\n        this.Hide();\r\n    }\r\n\r\n    protected onHide(...args: any[]): void {\r\n    }\r\n}"]}