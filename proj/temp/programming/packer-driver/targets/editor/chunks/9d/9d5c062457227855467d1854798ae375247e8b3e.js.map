{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/friend/FriendPanel.ts"],"names":["FriendPanel","Button","Input","Label","Toggle","js","EventMgr","Evt_Currency_Updtae","Evt_Hide_Scene","Evt_Show_Scene","FriendListPanel","FriendBindOrUnbindPanel","FriendBindType","DateUtils","Panel","prefab","item","currency3","currency","friendInfoPage","invitePage","addNode","infoNode","navBtns","lookFriendBtn","lookIncomBtn","helpFightBtn","inviteBtn","friendNum","incomeNum","friend_name","friend_time","friend_lv","friend_power","addBtn","unbind","unGetIncome","value","qipao_bg","heleBtn","filtrateBtn","page","FriendData","friendIncomeData","uplineFriendInfo","totalIncome","maxFriendNum","onLoad","CloseBy","find","children","concat","btn","on","onPage","node","onLookFriend","onAdd","EventType","TOUCH_END","onGet","onCurrencyUpdate","onShow","emit","getClassName","flush","args","SetPage","$hasLoad","initSub","undefined","getComponent","isChecked","toggle","indexOf","active","info","player_id","name","icon_url","level","last_offline_time","battle_power","is_online","upline_data","has_upline","upline","updateUpLineData","data","string","time_data","timeElapsedSince","days","hours","minutes","Show","bind","onHide","getClassByName"],"mappings":";;;4PAUaA,W;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAVJC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,K,OAAAA,K;AAAaC,MAAAA,M,OAAAA,M;AAAmBC,MAAAA,E,OAAAA,E;;AAC/CC,MAAAA,Q,iBAAAA,Q;AAAUC,MAAAA,mB,iBAAAA,mB;AAA0DC,MAAAA,c,iBAAAA,c;AAAgBC,MAAAA,c,iBAAAA,c;;AAEpFC,MAAAA,e,iBAAAA,e;;AAEAC,MAAAA,uB,iBAAAA,uB;AAAyBC,MAAAA,c,iBAAAA,c;;AACzBC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,K,iBAAAA,K;;;;;;;;;6BAGId,W,GAAN,MAAMA,WAAN;AAAA;AAAA,0BAAgC;AAAA;AAAA;AAAA,eACzBe,MADyB,GACR,4BADQ;AAGnC;AAHmC,eAI3BC,IAJ2B;AAAA,eAK3BC,SAL2B;AAAA,eAM3BC,QAN2B;AAAA,eAO3BC,cAP2B;AAAA,eAQ3BC,UAR2B;AAAA,eAS3BC,OAT2B;AAAA,eAU3BC,QAV2B;AAAA,eAW3BC,OAX2B;AAAA,eAY3BC,aAZ2B;AAAA,eAa3BC,YAb2B;AAAA,eAc3BC,YAd2B;AAAA,eAe3BC,SAf2B;AAAA,eAgB3BC,SAhB2B;AAAA,eAiB3BC,SAjB2B;AAAA,eAmB3BC,WAnB2B;AAAA,eAoB3BC,WApB2B;AAAA,eAqB3BC,SArB2B;AAAA,eAsB3BC,YAtB2B;AAAA,eAuB3BC,MAvB2B;AAAA,eAwB3BC,MAxB2B;AAAA,eAyB3BC,WAzB2B;AAAA,eA0B3BC,KA1B2B;AAAA,eA2B3BC,QA3B2B;AAAA,eA4B3BC,OA5B2B;AAAA,eA6B3BC,WA7B2B;AAAA,eA+B3BC,IA/B2B;AAAA,eAgC3BC,UAhC2B;AAAA,eAiC3BC,gBAjC2B;AAAA,eAkC3BC,gBAlC2B;AAAA,eAmC3BC,WAnC2B;AAmCP;AAnCO,eAoC3BC,YApC2B;AAAA;;AAqCzBC,QAAAA,MAAM,GAAS;AACrB,eAAKC,OAAL,CAAa,UAAb;AACA,eAAKT,OAAL,GAAe,KAAKU,IAAL,CAAU,oBAAV,CAAf,CAFqB,CAGrB;;AACA,eAAKjC,IAAL,GAAY,KAAKiC,IAAL,CAAU,MAAV,CAAZ;AACA,eAAKhC,SAAL,GAAiB,KAAKgC,IAAL,CAAU,2BAAV,EAAuC9C,KAAvC,CAAjB;AACA,eAAKe,QAAL,GAAgB,KAAK+B,IAAL,CAAU,0BAAV,EAAsC9C,KAAtC,CAAhB;AACA,eAAKgB,cAAL,GAAsB,KAAK8B,IAAL,CAAU,2BAAV,CAAtB;AACA,eAAK7B,UAAL,GAAkB,KAAK6B,IAAL,CAAU,uBAAV,CAAlB;AACA,eAAK5B,OAAL,GAAe,KAAK4B,IAAL,CAAU,+BAAV,CAAf;AACA,eAAK3B,QAAL,GAAgB,KAAK2B,IAAL,CAAU,gCAAV,CAAhB;AACA,eAAKzB,aAAL,GAAqB,KAAKyB,IAAL,CAAU,mDAAV,EAA+DhD,MAA/D,CAArB;AACA,eAAKwB,YAAL,GAAoB,KAAKwB,IAAL,CAAU,iDAAV,EAA6DhD,MAA7D,CAApB;AACA,eAAKyB,YAAL,GAAoB,KAAKuB,IAAL,CAAU,yBAAV,EAAqChD,MAArC,CAApB;AACA,eAAK0B,SAAL,GAAiB,KAAKsB,IAAL,CAAU,sBAAV,EAAkChD,MAAlC,CAAjB;AACA,eAAK2B,SAAL,GAAiB,KAAKqB,IAAL,CAAU,+CAAV,EAA2D9C,KAA3D,CAAjB;AACA,eAAK0B,SAAL,GAAiB,KAAKoB,IAAL,CAAU,qDAAV,EAAiE9C,KAAjE,CAAjB;AACA,eAAK2B,WAAL,GAAmB,KAAKmB,IAAL,CAAU,sDAAV,EAAkE9C,KAAlE,CAAnB;AACA,eAAK4B,WAAL,GAAmB,KAAKkB,IAAL,CAAU,sDAAV,EAAkE9C,KAAlE,CAAnB;AACA,eAAK6B,SAAL,GAAiB,KAAKiB,IAAL,CAAU,gDAAV,EAA4D9C,KAA5D,CAAjB;AACA,eAAK8B,YAAL,GAAoB,KAAKgB,IAAL,CAAU,uDAAV,EAAmE9C,KAAnE,CAApB;AACA,eAAK+B,MAAL,GAAc,KAAKe,IAAL,CAAU,sCAAV,EAAkDhD,MAAlD,CAAd;AACA,eAAKkC,MAAL,GAAc,KAAKc,IAAL,CAAU,iDAAV,EAA6DhD,MAA7D,CAAd;AACA,eAAKmC,WAAL,GAAmB,KAAKa,IAAL,CAAU,kBAAV,CAAnB;AACA,eAAKX,QAAL,GAAgB,KAAKW,IAAL,CAAU,2BAAV,CAAhB;AACA,eAAKZ,KAAL,GAAa,KAAKY,IAAL,CAAU,iCAAV,EAA6C9C,KAA7C,CAAb;AACA,eAAKqC,WAAL,GAAmB,KAAKS,IAAL,CAAU,wBAAV,EAAoChD,MAApC,CAAnB,CA1BqB,CA2BrB;;AAEA,eAAKsB,OAAL,GAAe,KAAK0B,IAAL,CAAU,aAAV,EAAyBC,QAAzB,CAAkCC,MAAlC,EAAf;;AACA,eAAK,IAAIC,GAAT,IAAgB,KAAK7B,OAArB,EAA8B;AAC1B6B,YAAAA,GAAG,CAACC,EAAJ,CAAO,QAAP,EAAiB,KAAKC,MAAtB,EAA8B,IAA9B;AACH;;AACD,eAAK9B,aAAL,CAAmB+B,IAAnB,CAAwBF,EAAxB,CAA2B,OAA3B,EAAoC,KAAKG,YAAzC,EAAuD,IAAvD,EAjCqB,CAkCrB;AACA;AACA;;AACA,eAAKtB,MAAL,CAAYqB,IAAZ,CAAiBF,EAAjB,CAAoB,OAApB,EAA6B,KAAKI,KAAlC,EAAyC,IAAzC,EArCqB,CAsCrB;;AACA,eAAKnB,QAAL,CAAce,EAAd,CAAiBnD,KAAK,CAACwD,SAAN,CAAgBC,SAAjC,EAA4C,KAAKC,KAAjD,EAAwD,IAAxD,EAvCqB,CAwCrB;AACA;AACA;;AACA;AAAA;AAAA,oCAASP,EAAT;AAAA;AAAA,0DAAiC,KAAKQ,gBAAtC,EAAwD,IAAxD;AACH;;AAESC,QAAAA,MAAM,GAAS;AACrB;AAAA;AAAA,oCAASC,IAAT;AAAA;AAAA,gDAA8B1D,EAAE,CAAC2D,YAAH,CAAgB,IAAhB,CAA9B,EADqB,CAErB;AACH;;AAEU,cAALC,KAAK,CAAC,GAAGC,IAAJ,EAAiB;AACxB;AACA,eAAKL,gBAAL;AACA,eAAKM,OAAL,CAAa,CAAb;AACH;;AAEY,cAAPA,OAAO,CAAC1B,IAAD,EAAe;AACxB,cAAI,CAAC,KAAK2B,QAAV,EAAoB,MAAM,KAAKC,OAAX;AACpB,cAAI,CAAC,KAAK9C,OAAL,CAAakB,IAAb,CAAL,EAAyB;AACzB,eAAKA,IAAL,GAAY6B,SAAZ;AACA,eAAK/C,OAAL,CAAakB,IAAb,EAAmB8B,YAAnB,CAAgCnE,MAAhC,EAAwCoE,SAAxC,GAAoD,IAApD;AACA,eAAKlB,MAAL,CAAY,KAAK/B,OAAL,CAAakB,IAAb,EAAmB8B,YAAnB,CAAgCnE,MAAhC,CAAZ;AACH;;AAEOkD,QAAAA,MAAM,CAACmB,MAAD,EAAiB;AAC3B,cAAIhC,IAAI,GAAG,KAAKlB,OAAL,CAAamD,OAAb,CAAqBD,MAAM,CAAClB,IAA5B,CAAX;AACA,cAAId,IAAI,GAAG,CAAP,IAAYA,IAAI,IAAI,KAAKA,IAA7B,EAAmC;AACnC,eAAKA,IAAL,GAAYA,IAAZ;AACA,eAAKtB,cAAL,CAAoBwD,MAApB,GAA6B,KAA7B;AACA,eAAKvD,UAAL,CAAgBuD,MAAhB,GAAyB,KAAzB;AACA,eAAKvC,WAAL,CAAiBuC,MAAjB,GAA0B,KAA1B;;AACA,kBAAQ,KAAKlC,IAAb;AACI,iBAAK,CAAL;AACI;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA,mBAAKtB,cAAL,CAAoBwD,MAApB,GAA6B,IAA7B;AACA;;AACJ,iBAAK,CAAL;AACI;AACA;AACA;AACA;AACA,mBAAKvD,UAAL,CAAgBuD,MAAhB,GAAyB,IAAzB,CALJ,CAMI;AACA;AACA;AACA;AACA;AACA;AACA;;AACI,kBAAIC,IAAiB,GAAG;AACpBC,gBAAAA,SAAS,EAAE,EADS;AAEpBC,gBAAAA,IAAI,EAAE,EAFc;AAGpBC,gBAAAA,QAAQ,EAAE,EAHU;AAIpBC,gBAAAA,KAAK,EAAE,CAJa;AAKpBC,gBAAAA,iBAAiB,EAAE,CALC;AAMpBC,gBAAAA,YAAY,EAAE,CANM;AAOpBC,gBAAAA,SAAS,EAAE;AAPS,eAAxB;AASA,kBAAIC,WAA2B,GAAG;AAAEC,gBAAAA,UAAU,EAAE,KAAd;AAAqBC,gBAAAA,MAAM,EAAEV;AAA7B,eAAlC;AACA,mBAAKW,gBAAL,CAAsBH,WAAtB,EAvBR,CAwBI;;AACA;;AACJ;AACI;AA3CR;AA6CH,SA1JkC,CA4JnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AACQG,QAAAA,gBAAgB,CAACC,IAAD,EAAuB;AAC3C,eAAK5C,gBAAL,GAAwB4C,IAAI,CAACF,MAA7B;AACA,eAAKjE,OAAL,CAAasD,MAAb,GAAsB,CAACa,IAAI,CAACH,UAA5B;AACA,eAAK/D,QAAL,CAAcqD,MAAd,GAAuBa,IAAI,CAACH,UAA5B;;AACA,cAAIG,IAAI,CAACH,UAAT,EAAqB;AACjB,iBAAKvD,WAAL,CAAiB2D,MAAjB,GAA0BD,IAAI,CAACF,MAAL,CAAYR,IAAtC;;AACA,gBAAI,CAACU,IAAI,CAACF,MAAL,CAAYH,SAAjB,EAA4B;AACxB,kBAAIK,IAAI,CAACF,MAAL,CAAYL,iBAAZ,IAAiC,CAArC,EAAwC;AACpC,oBAAIS,SAAS,GAAG;AAAA;AAAA,4CAAUC,gBAAV,CAA2BH,IAAI,CAACF,MAAL,CAAYL,iBAAZ,GAAgC,IAA3D,CAAhB;;AACA,oBAAIS,SAAS,CAACE,IAAd,EAAoB;AAChB,uBAAK7D,WAAL,CAAiB0D,MAAjB,GAA0BC,SAAS,CAACE,IAAV,GAAiB,IAA3C;AACH,iBAFD,MAEO,IAAIF,SAAS,CAACG,KAAd,EAAqB;AACxB,uBAAK9D,WAAL,CAAiB0D,MAAjB,GAA0BC,SAAS,CAACG,KAAV,GAAkB,KAA5C;AACH,iBAFM,MAEA,IAAIH,SAAS,CAACI,OAAd,EAAuB;AAC1B,uBAAK/D,WAAL,CAAiB0D,MAAjB,GAA0BC,SAAS,CAACI,OAAV,GAAoB,KAA9C;AACH;AACJ,eATD,MASO,CACH;AACA;AACH;AACJ,aAdD,MAcO;AACH,mBAAK/D,WAAL,CAAiB0D,MAAjB,GAA0B,IAA1B;AACH;;AAED,iBAAKzD,SAAL,CAAeyD,MAAf,GAAwB,OAAOD,IAAI,CAACF,MAAL,CAAYN,KAA3C;AACA,iBAAK/C,YAAL,CAAkBwD,MAAlB,GAA2BD,IAAI,CAACF,MAAL,CAAYJ,YAAZ,GAA2B,EAAtD;AACH;AACJ;;AAEOrB,QAAAA,gBAAgB,GAAS,CAC7B;AACA;AACH;AAED;;;AACQD,QAAAA,KAAK,GAAG,CACZ;AACA;AACA;AACA;AACA;AACA;AACH,SAxPkC,CA0PnC;;;AACQJ,QAAAA,YAAY,GAAG;AACnB;AAAA;AAAA,kDAAgBuC,IAAhB,CAAqB,KAAKjD,YAA1B;AACH,SA7PkC,CA+PnC;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;;;AACQW,QAAAA,KAAK,GAAG;AACZ;AACA;AAAA;AAAA,kEAAwBsC,IAAxB,CAA6B;AAAA;AAAA,gDAAeC,IAA5C;AACH,SAlRkC,CAoRnC;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEUC,QAAAA,MAAM,CAAC,GAAG/B,IAAJ,EAAuB;AACnC;AACA;AAAA;AAAA,oCAASH,IAAT;AAAA;AAAA,gDAA8B1D,EAAE,CAAC6F,cAAH,CAAkB,IAAlB,CAA9B;AACH;;AA9SkC,O","sourcesContent":["import { Button, Input, Label, Node, Toggle, UIOpacity, js, sp } from \"cc\";\r\nimport { EventMgr, Evt_Currency_Updtae, Evt_GetIncommons, Evt_GetUPLineInfo, Evt_Hide_Scene, Evt_Show_Scene } from \"../../manager/EventMgr\";\r\nimport { Session } from \"../../net/Session\";\r\nimport { FriendListPanel } from \"./FriendListPanel\";\r\nimport { FriendIncomeListPanel } from \"./FriendIncomeListPanel\";\r\nimport { FriendBindOrUnbindPanel, FriendBindType } from \"./FriendBindOrUnbindPanel\";\r\nimport { DateUtils } from \"../../utils/DateUtils\";\r\nimport { Panel } from \"../../manager/GameRoot\";\r\nimport { SGetAgentInfo, SGetIncomes, SGetUplineInfo, SUplineInfo } from \"../player/PlayerStruct\";\r\n\r\nexport class FriendPanel extends Panel {\r\n    protected prefab: string = \"prefabs/friend/FriendPanel\";\r\n\r\n    // private itemNode: Node[];\r\n    private item: Node;\r\n    private currency3: Label;\r\n    private currency: Label;\r\n    private friendInfoPage: Node;\r\n    private invitePage: Node;\r\n    private addNode: Node;\r\n    private infoNode: Node;\r\n    private navBtns: Node[];\r\n    private lookFriendBtn: Button;\r\n    private lookIncomBtn: Button;\r\n    private helpFightBtn: Button;\r\n    private inviteBtn: Button;\r\n    private friendNum: Label;\r\n    private incomeNum: Label;\r\n\r\n    private friend_name: Label;\r\n    private friend_time: Label;\r\n    private friend_lv: Label;\r\n    private friend_power: Label;\r\n    private addBtn: Button;\r\n    private unbind: Button;\r\n    private unGetIncome: Node;\r\n    private value: Label;\r\n    private qipao_bg: Node;\r\n    private heleBtn: Node;\r\n    private filtrateBtn: Button;\r\n\r\n    private page: number\r\n    private FriendData: SGetAgentInfo;\r\n    private friendIncomeData: SGetIncomes;\r\n    private uplineFriendInfo: SUplineInfo;\r\n    private totalIncome: number;//累计收益\r\n    private maxFriendNum: number;\r\n    protected onLoad(): void {\r\n        this.CloseBy(\"closeBtn\");\r\n        this.heleBtn = this.find(\"page/frame/helpBtn\");\r\n        // this.itemNode = this.find(\"itemNode\").children.concat();\r\n        this.item = this.find(\"item\");\r\n        this.currency3 = this.find(\"topLayout/currency3/Label\", Label);\r\n        this.currency = this.find(\"topLayout/currency/Label\", Label);\r\n        this.friendInfoPage = this.find(\"page/frame/friendInfoPage\");\r\n        this.invitePage = this.find(\"page/frame/invitePage\");\r\n        this.addNode = this.find(\"page/frame/invitePage/addNode\");\r\n        this.infoNode = this.find(\"page/frame/invitePage/infoNode\");\r\n        this.lookFriendBtn = this.find(\"page/frame/friendInfoPage/frined_bg/lookFriendBtn\", Button);\r\n        this.lookIncomBtn = this.find(\"page/frame/friendInfoPage/incom_bg/lookIncomBtn\", Button);\r\n        this.helpFightBtn = this.find(\"page/frame/helpFightBtn\", Button);\r\n        this.inviteBtn = this.find(\"page/frame/inviteBtn\", Button);\r\n        this.friendNum = this.find(\"page/frame/friendInfoPage/frined_bg/friendNum\", Label);\r\n        this.incomeNum = this.find(\"page/frame/friendInfoPage/incom_bg/Layout/incomeNum\", Label);\r\n        this.friend_name = this.find(\"page/frame/invitePage/infoNode/invite_bg/friend_name\", Label);\r\n        this.friend_time = this.find(\"page/frame/invitePage/infoNode/invite_bg/friend_time\", Label);\r\n        this.friend_lv = this.find(\"page/frame/invitePage/infoNode/juese/friend_lv\", Label);\r\n        this.friend_power = this.find(\"page/frame/invitePage/infoNode/invite_bg/friend_power\", Label);\r\n        this.addBtn = this.find(\"page/frame/invitePage/addNode/addBtn\", Button);\r\n        this.unbind = this.find(\"page/frame/invitePage/infoNode/invite_bg/unbind\", Button);\r\n        this.unGetIncome = this.find(\"page/unGetIncome\");\r\n        this.qipao_bg = this.find(\"page/unGetIncome/qipao_bg\");\r\n        this.value = this.find(\"page/unGetIncome/qipao_bg/value\", Label);\r\n        this.filtrateBtn = this.find(\"page/frame/filtrateBtn\", Button);\r\n        // this.filtrateBtn.node.on(\"click\", this.onFiltrate, this);\r\n\r\n        this.navBtns = this.find(\"page/navBar\").children.concat();\r\n        for (let btn of this.navBtns) {\r\n            btn.on('toggle', this.onPage, this);\r\n        }\r\n        this.lookFriendBtn.node.on(\"click\", this.onLookFriend, this);\r\n        // this.lookIncomBtn.node.on(\"click\", this.onLookIncom, this);\r\n        // this.helpFightBtn.node.on(\"click\", this.onHelpFight, this);\r\n        // this.inviteBtn.node.on(\"click\", this.onInvite, this);\r\n        this.addBtn.node.on(\"click\", this.onAdd, this);\r\n        // this.unbind.node.on(\"click\", this.onUnbind, this);\r\n        this.qipao_bg.on(Input.EventType.TOUCH_END, this.onGet, this);\r\n        // this.heleBtn.on(Input.EventType.TOUCH_END, this.onHelpBtn, this);\r\n        // EventMgr.on(Evt_GetIncommons, this.updateIncomeData, this)\r\n        // EventMgr.on(Evt_GetUPLineInfo, this.updateUpLineData, this)\r\n        EventMgr.on(Evt_Currency_Updtae, this.onCurrencyUpdate, this);\r\n    }\r\n\r\n    protected onShow(): void {\r\n        EventMgr.emit(Evt_Hide_Scene, js.getClassName(this));\r\n        // AudioMgr.playScene(\"friend_fountain\", true);\r\n    }\r\n\r\n    async flush(...args: any[]) {\r\n        // AdaptBgTop(this.node.getChildByPath(\"di\"));\r\n        this.onCurrencyUpdate();\r\n        this.SetPage(0);\r\n    }\r\n\r\n    async SetPage(page: number) {\r\n        if (!this.$hasLoad) await this.initSub;\r\n        if (!this.navBtns[page]) return;\r\n        this.page = undefined;\r\n        this.navBtns[page].getComponent(Toggle).isChecked = true;\r\n        this.onPage(this.navBtns[page].getComponent(Toggle));\r\n    }\r\n\r\n    private onPage(toggle: Toggle) {\r\n        let page = this.navBtns.indexOf(toggle.node);\r\n        if (page < 0 || page == this.page) return;\r\n        this.page = page;\r\n        this.friendInfoPage.active = false;\r\n        this.invitePage.active = false;\r\n        this.unGetIncome.active = false;\r\n        switch (this.page) {\r\n            case 0:\r\n                // let incomeData = {\r\n                //     type: MsgTypeSend.GetIncomesRequest,\r\n                //     data: {},\r\n                // }\r\n                // Session.Send(incomeData);\r\n\r\n                // let friendData = {\r\n                //     type: MsgTypeSend.GetAgentInfoRequest,\r\n                //     data: {},\r\n                // }\r\n                // Session.Send(friendData);\r\n\r\n                this.friendInfoPage.active = true;\r\n                break;\r\n            case 1:\r\n                // this.navBtns[page].getComponent(Toggle).isChecked = false;\r\n                // MsgPanel.Show(\"功能暂未开启\")\r\n                // this.SetPage(0)\r\n                // return;\r\n                this.invitePage.active = true;\r\n                // if (this.FriendData && this.FriendData.upline_id) {\r\n                //     // let upLineData = {\r\n                //     //     type: MsgTypeSend.GetUplineInfoRequest,\r\n                //     //     data: {},\r\n                //     // }\r\n                //     // Session.Send(upLineData);\r\n                // } else {\r\n                    let info: SUplineInfo = {\r\n                        player_id: \"\",\r\n                        name: \"\",\r\n                        icon_url: \"\",\r\n                        level: 0,\r\n                        last_offline_time: 0,\r\n                        battle_power: 0,\r\n                        is_online: false,\r\n                    }\r\n                    let upline_data: SGetUplineInfo = { has_upline: false, upline: info }\r\n                    this.updateUpLineData(upline_data);\r\n                // }\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    // /**刷新收益信息 */\r\n    // private updateIncomeData(data: SGetIncomes | SGetAgentInfo) {\r\n    //     // if(data){\r\n    //     //     if ((data as SGetIncomes).incomes) {\r\n    //     //         let Income: SGetIncomes = (data as SGetIncomes);\r\n    //     //         this.friendIncomeData = Income;\r\n    //     //         this.friendNum.string = Income.total_downlines + \"\";\r\n    //     //         this.maxFriendNum = Income.total_downlines;\r\n    //     //         let datas: SIncomesInfo[] = Income.incomes;\r\n    //     //         let anmindex = [\"animation1\", \"animation2\", \"animation3\"]\r\n    //     //         if (Income.incomes.length != 0) {\r\n    //     //             for (let index = 0; index < this.itemNode.length; index++) {\r\n    //     //                 if (datas[index] && datas[index].amount != 0) {\r\n    //     //                     this.itemNode[index].getComponent(sp.Skeleton).setAnimation(0, anmindex[randomI(0, 2)], true)\r\n    //     //                     let item = this.itemNode[index].getChildByPath(\"item\");\r\n    //     //                     let value = this.itemNode[index].getChildByPath(\"item/value\").getComponent(Label);\r\n    //     //                     let name = this.itemNode[index].getChildByPath(\"item/name\").getComponent(Label);\r\n    //     //                     value.string = ToFixed(datas[index].amount, 4) + \"\";\r\n    //     //                     name.string = datas[index].name;\r\n    //     //                     item.getComponent(UIOpacity).opacity = 255;\r\n    //     //                     item.off(Input.EventType.TOUCH_END, this.onGet, this);\r\n    //     //                     item.on(Input.EventType.TOUCH_END, this.onGet, this);\r\n    //     //                 }\r\n    //     //             }\r\n    //     //         } else {\r\n    //     //             for (let index = 0; index < this.itemNode.length; index++) {\r\n    //     //                 this.itemNode[index].getComponent(sp.Skeleton).setAnimation(0, anmindex[randomI(0, 2)], true)\r\n    //     //                 let item = this.itemNode[index].getChildByPath(\"item\");\r\n    //     //                 item.getComponent(UIOpacity).opacity = 0;\r\n    //     //                 item.off(Input.EventType.TOUCH_END, this.onGet, this);\r\n    //     //             }\r\n    //     //         }\r\n    \r\n    //     //         if (this.page == 0 && Income.total_unclaimed > 0 && datas.length >= 10) {\r\n    //     //             this.unGetIncome.active = true;\r\n    //     //         } else {\r\n    //     //             this.unGetIncome.active = false;\r\n    //     //         }\r\n    //     //         // this.unGetIncome.active = (Income.total_unclaimed > 0 && datas.length >=10);\r\n    //     //         this.value.string = ToFixed(Income.total_unclaimed, 4);\r\n    //     //     } else {\r\n    //     //         let agentInfo: SGetAgentInfo = (data as SGetAgentInfo);\r\n    //     //         this.incomeNum.string = ToFixed((data as SGetAgentInfo).daily_income, 4);\r\n    //     //         this.totalIncome = (data as SGetAgentInfo).total_income;\r\n    //     //         this.FriendData = agentInfo;\r\n    //     //     }\r\n    //     // }\r\n    // }\r\n\r\n    /**刷新上线信息 */\r\n    private updateUpLineData(data: SGetUplineInfo) {\r\n        this.uplineFriendInfo = data.upline;\r\n        this.addNode.active = !data.has_upline;\r\n        this.infoNode.active = data.has_upline;\r\n        if (data.has_upline) {\r\n            this.friend_name.string = data.upline.name;\r\n            if (!data.upline.is_online) {\r\n                if (data.upline.last_offline_time != 0) {\r\n                    let time_data = DateUtils.timeElapsedSince(data.upline.last_offline_time * 1000);\r\n                    if (time_data.days) {\r\n                        this.friend_time.string = time_data.days + \"天前\";\r\n                    } else if (time_data.hours) {\r\n                        this.friend_time.string = time_data.hours + \"小时前\";\r\n                    } else if (time_data.minutes) {\r\n                        this.friend_time.string = time_data.minutes + \"分钟前\";\r\n                    }\r\n                } else {\r\n                    // let day = CfgMgr.GetCommon(StdCommonType.Friend).UnboundDays;\r\n                    // this.friend_time.string = day + \"天前\";\r\n                }\r\n            } else {\r\n                this.friend_time.string = \"在线\";\r\n            }\r\n\r\n            this.friend_lv.string = \"Lv\" + data.upline.level;\r\n            this.friend_power.string = data.upline.battle_power + \"\";\r\n        }\r\n    }\r\n\r\n    private onCurrencyUpdate(): void {\r\n        // this.currency3.string = ToFixed(PlayerData.roleInfo.currency3, 4);\r\n        // this.currency.string = ToFixed(PlayerData.roleInfo.currency, 4);\r\n    }\r\n\r\n    /**领取收益 */\r\n    private onGet() {\r\n        // AudioMgr.playSound(\"friend_get_income\", false);\r\n        // let data = {\r\n        //     type: MsgTypeSend.IncomeRequest,\r\n        //     data: {},\r\n        // }\r\n        // Session.Send(data);\r\n    }\r\n\r\n    //查看好友\r\n    private onLookFriend() {\r\n        FriendListPanel.Show(this.maxFriendNum);\r\n    }\r\n\r\n    // //查看收益记录\r\n    // private onLookIncom() {\r\n    //     FriendIncomeListPanel.Show(this.totalIncome);\r\n    // }\r\n\r\n    // /**协助 */\r\n    // private onHelpFight() {\r\n    //     FriendHelpPanel.Show(this.FriendData);\r\n    // }\r\n\r\n    // /**邀请 */\r\n    // private onInvite() {\r\n    //     Goto(PANEL_TYPE.FriendInviteListPanel);\r\n    // }\r\n\r\n    //添加绑定好友\r\n    private onAdd() {\r\n        // MsgPanel.Show(\"功能暂未开启\");\r\n        FriendBindOrUnbindPanel.Show(FriendBindType.bind);\r\n    }\r\n\r\n    // //解绑\r\n    // private onUnbind() {\r\n    //     FriendBindOrUnbindPanel.Show(FriendBindType.unbind, this.uplineFriendInfo);\r\n    // }\r\n\r\n    // private onHelpBtn() {\r\n    //     Tips2.Show(Tips2ID.Friend);\r\n    // }\r\n\r\n    // private onFiltrate() {\r\n    //     // let server = GameSet.Server_cfg;\r\n    //     // if(server && server.Mark){\r\n    //         // CallApp({api:Api_Share}); \r\n    //     // }else{\r\n    //     //     MsgPanel.Show(\"功能暂未开启\")\r\n    //     //     return;\r\n    //     // }\r\n    //     // // FriendSharePanel.Show();\r\n    //     // MsgPanel.Show(\"功能暂未开启\")\r\n    //     // return;\r\n    //     CallApp({api:Api_Share,appid:GameSet.Server_cfg.AppId});\r\n    // }\r\n\r\n    protected onHide(...args: any[]): void {\r\n        // AudioMgr.stopScene(\"friend_fountain\")\r\n        EventMgr.emit(Evt_Show_Scene, js.getClassByName(this));\r\n    }\r\n}"]}