{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/cards/CardGroupCreatorTips.ts"],"names":["CardGroupCreatorTips","Input","Label","Tween","Vec3","easing","sp","tween","Panel","PlayerData","CardSotrType1","CfgMgr","AutoScroller","Card","CardsSortOrFiltrate","EventMgr","Evt_Add_Card_Group_update","prefab","title","cardGroupName","btn1","btn2","cardClassList","EffNode","infoCont","callBack1","callBack2","onLoad","CloseBy","find","SetHandle","updateCardItem","bind","on","EventType","TOUCH_END","onGotoCardGroup","onSetDefult","onShow","updateScorll","active","spine","children","getComponent","Skeleton","self","call","clearAnimation","setAnimation","delay","setCompleteListener","stopAllByTarget","setScale","to","scale","elasticOut","start","flush","select_id","card_list","callback1","callback2","select_cfg","GetCard","string","CardName","getCostSort","Up","UpdateDatas","name","getCardGroupDataById","cur_id","item","data","card","getChildByName","addComponent","SetData","undefined","Hide","onHide","args","off"],"mappings":"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","sourcesContent":["import { Input, Label, Node, Sprite, SpriteFrame, Toggle, Tween, Vec3, easing, path, sp, tween } from \"cc\";\r\nimport { Panel, UILay } from \"../../manager/GameRoot\";\r\nimport proto, { Req, Route } from \"../../net/Protocol\";\r\nimport { PlayerData } from \"../player/PlayerData\";\r\nimport { CardSotrType1, CfgMgr } from \"../../manager/CfgMgr\";\r\nimport { AutoScroller } from \"../../component/AutoScroller\";\r\nimport { Card } from \"./Card\";\r\nimport { CardsSortOrFiltrate } from \"./CardsSortOrFiltrate\";\r\nimport { EventMgr, Evt_Add_Card_Group_update } from \"../../manager/EventMgr\";\r\n\r\nexport class CardGroupCreatorTips extends Panel {\r\n    protected prefab: string = \"prefabs/cards/CardGroupCreatorTips\";\r\n    private title: Label;\r\n    private cardGroupName: Label;\r\n    private btn1: Node;\r\n    private btn2: Node;\r\n    private cardClassList:AutoScroller\r\n    private EffNode:Node;\r\n    private infoCont:Node;\r\n  \r\n   \r\n    private callBack1:Function;\r\n    private callBack2:Function;\r\n\r\n    protected onLoad(): void {\r\n        this.CloseBy(\"mask\");\r\n        this.infoCont = this.find(\"infoCont\");\r\n        this.EffNode = this.find(\"effNode\");\r\n        this.title = this.find(\"infoCont/title\", Label);\r\n        this.cardGroupName = this.find(\"infoCont/groupName\", Label);\r\n        this.cardClassList = this.find(\"infoCont/cardClassList\", AutoScroller);\r\n        this.cardClassList.SetHandle(this.updateCardItem.bind(this));\r\n        this.btn1 = this.find(\"infoCont/btn1\");\r\n        this.btn2 = this.find(\"infoCont/btn2\");\r\n        this.btn1.on(Input.EventType.TOUCH_END, this.onGotoCardGroup, this);\r\n        this.btn2.on(Input.EventType.TOUCH_END, this.onSetDefult, this);\r\n    }\r\n\r\n    protected onShow(): void {\r\n        EventMgr.on(Evt_Add_Card_Group_update, this.updateScorll, this)\r\n        this.EffNode.active = true;\r\n        this.infoCont.active = false;\r\n        let spine = this.EffNode.children[0].getComponent(sp.Skeleton)\r\n        let self = this;\r\n        tween(spine)\r\n        .call(()=>{\r\n            spine.clearAnimation();\r\n            spine.setAnimation(0, \"animation\", false);\r\n        })\r\n        .delay(1)\r\n        .call(()=>{\r\n            spine.setCompleteListener(() => {   \r\n            self.EffNode.active = false;  \r\n            })\r\n            this.infoCont.active = true;\r\n            Tween.stopAllByTarget(this.infoCont);\r\n            this.infoCont.setScale(0.3, 0.3, 1);;\r\n            tween(this.infoCont)\r\n            .to(1, { scale: new Vec3(1, 1, 1) }, { easing: easing.elasticOut})\r\n            .start();\r\n        })\r\n        .start() \r\n\r\n    }\r\n    async flush(select_id:number, card_list:proto.base.IBattleCard[], callback1:Function, callback2:Function) {\r\n        this.callBack1 = callback1;\r\n        this.callBack2 = callback2;\r\n        let select_cfg = CfgMgr.GetCard(select_id);\r\n        this.title.string = \"用\"+ select_cfg.CardName + \"生成的自定义卡组\"\r\n        CardsSortOrFiltrate.getCostSort(card_list, CardSotrType1.Up)\r\n        this.cardClassList.UpdateDatas(card_list)\r\n    }\r\n\r\n    private updateScorll(){\r\n        let name = PlayerData.getCardGroupDataById(PlayerData.cur_id).name\r\n        this.cardGroupName.string = name;\r\n    }\r\n\r\n    private updateCardItem(item:Node, data:proto.base.IBattleCard){\r\n        let card = item.getChildByName(\"Cards\").getComponent(Card);\r\n        if (!card) card = item.getChildByName(\"Cards\").addComponent(Card);\r\n        card.SetData(data);\r\n    }\r\n\r\n    private onGotoCardGroup(){\r\n        if(this.callBack1){\r\n            this.callBack1();\r\n            this.callBack1 = undefined;\r\n        }\r\n        this.Hide()\r\n    }\r\n\r\n    private onSetDefult(){\r\n        if(this.callBack2){\r\n            this.callBack2();\r\n            this.callBack2 = undefined;\r\n        }\r\n        this.Hide()\r\n    }\r\n\r\n    protected onHide(...args: any[]): void {\r\n        EventMgr.off(Evt_Add_Card_Group_update, this.updateScorll, this)\r\n    }\r\n}"]}