{"version":3,"sources":["file:///D:/plants_client/trunk/proj/assets/scripts/module/main/MainUI3D.ts"],"names":["MainUI3D","easing","Input","instantiate","Label","path","Sprite","SpriteFrame","tween","UITransform","v3","Vec3","folder_item","ResMgr","GameSet","PlaneView","Second","Utils","Transform3d","AsyncComponent","PlayerData","CfgMgr","EventMgr","Evt_MainTaskChange","Panel","MsgPanel","Goto","proto","planeView","leftView","rightView","battleView","fightBtn","saijiBtn","txzItem","leftStartY","rightStartY","right_taskStartX","taskClone","noticeClone","taskPool","noticePool","leftItems","taskItems","startTaskTween","instance","_instance","prevLoad","loadSub","Promise","resolve","reject","GetResources","prefab","node","addComponent","Show","mainCamera","addChild","d","TestUIHigh","PixelSize","setPosition","canvas","on","EventType","TOUCH_START","onTouchStart","TOUCH_END","onTouchEnd","Init","Hide","parent","removeChild","off","onLoad","getChildByPath","left","push","position","y","right","x","updateLeftData","hdItem","AddTouchEffect","e","ut","getComponent","checkTouch","contentSize","width","height","tileItem","start","UNIT_Z","children","layoutV","localLeftDown","startTween","localRightDown","setTween","battleNode","battleNode_pos","getPosition","z","to","circOut","left_right","items","endPos","index","length","element","pos","starty","h","_i","_item","startx","startz","out","mat","getWorldMatrix","invert","i","item","trans","transformMat4","worldPosition","v","datas","GetShowMianTask","len","Math","max","data","DelTouchEffect","pop","cfg_task","GetTaskByData","console","log","icon","Getitem","RewardID","Icon","num","RewardNumber","LoadResAbSub","join","res","getChildByName","spriteFrame","string","Description","state","GetTaskState","active","update","dt","change_task_list","GetPanelNum","updateRighTaskItem","concat","item_count","count","ceil","time","value","CompletionNum","str","delay","call","CurSeasonData","currentSeasonId","base","BattleMode","BattleModeRank","SatrElementData","BattleModeStar","name","cfg","type","TaskTypeData"],"mappings":"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","sourcesContent":["import { Component, director, easing, EventTouch, find, geometry, Input, instantiate, Label, math, Node, path, Prefab, Sprite, SpriteFrame, tween, UIOpacity, UITransform, v3, Vec3 } from \"cc\";\nimport { folder_item, ResMgr } from \"../../manager/ResMgr\";\nimport { GameSet } from \"../../manager/GameSet\";\nimport { PlaneView, Second, Utils } from \"../../utils/Utils\";\nimport { Transform3d } from \"../common/Transform3d\";\nimport { AsyncComponent } from \"../common/AsyncComponent\";\nimport { TaskPanel } from \"../task/TaskPanel\";\nimport { PlayerData } from \"../player/PlayerData\";\nimport { CfgMgr, StdTask } from \"../../manager/CfgMgr\";\nimport { EventMgr, Evt_MainTaskChange, Evt_TaskChange } from \"../../manager/EventMgr\";\nimport { Panel } from \"../../manager/GameRoot\";\nimport { MsgPanel } from \"../common/MsgPanel\";\nimport { Goto } from \"../../DL\";\nimport proto from \"../../net/Protocol\";\n\nexport class MainUI3D extends AsyncComponent {\n    protected static _instance: MainUI3D;\n    protected static canvas: Node;\n    static get instance() {\n        return this._instance;\n    }\n\n    protected static loadSub: Promise<any>;\n\n    static async prevLoad() {\n        if (!this.loadSub) {\n            this.loadSub = new Promise((resolve, reject) => {\n                ResMgr.GetResources(\"prefabs/main/MainUI3D\", (prefab: Prefab) => {\n                    let node: Node = instantiate(prefab);\n                    MainUI3D._instance = node.addComponent(MainUI3D);\n                    resolve(MainUI3D._instance);\n                })\n            });\n            return this.loadSub;\n        }\n        return this.loadSub;\n    }\n\n    /**\n     * 显示\n     */\n    static async Show(node: Node) {\n        if (!this._instance) await this.prevLoad();\n        GameSet.mainCamera.node.addChild(this._instance.node);\n        let d = Utils.TestUIHigh(720 * GameSet.PixelSize, GameSet.mainCamera);\n        MainUI3D._instance.node.setPosition(0, 0, -d);\n\n        this.canvas = node;\n        this.canvas.on(Input.EventType.TOUCH_START, this._instance.onTouchStart, this._instance);\n        this.canvas.on(Input.EventType.TOUCH_END, this._instance.onTouchEnd, this._instance);\n        this._instance.Init();\n    }\n\n\n    static async Hide() {\n        if (!this._instance) await this.prevLoad();\n        if (this._instance && this._instance.node.parent) {\n            this._instance.node.parent.removeChild(this._instance.node);\n        }\n        if (this.canvas) {\n            this.canvas.off(Input.EventType.TOUCH_START, this._instance.onTouchStart, this._instance);\n            this.canvas.off(Input.EventType.TOUCH_END, this._instance.onTouchEnd, this._instance);\n        }\n    }\n\n    protected planeView: PlaneView;\n    protected leftView: PlaneView;\n    protected rightView: PlaneView;\n    protected battleView: PlaneView;\n    protected fightBtn: Node;\n    protected saijiBtn: Node;\n    protected txzItem: Node;\n    protected leftStartY: number;\n    protected rightStartY: number;\n    protected right_taskStartX: number;\n    protected taskClone: Node;\n    protected noticeClone: Node;\n    protected taskPool: Node[] = [];\n    protected noticePool: Node[] = [];\n    protected leftItems: Node[] = [];\n    protected taskItems: Node[] = [];\n    private startTaskTween: boolean = false;\n\n    protected async onLoad() {\n        MainUI3D._instance = this;\n\n        this.fightBtn = this.node.getChildByPath(\"ui/battleNode/fight\");\n        this.saijiBtn = this.node.getChildByPath(\"ui/battleNode/saiji\");\n        this.txzItem = this.node.getChildByPath(\"ui/left/txzItem\");\n\n\n        let left = this.node.getChildByPath(\"ui/left\");\n        this.taskClone = left.getChildByPath(\"item0\");\n        left.removeChild(this.taskClone);\n        this.taskPool.push(left.getChildByPath(\"item1\"));\n        this.taskPool.push(left.getChildByPath(\"item2\"));\n        left.removeChild(this.taskPool[0]);\n        left.removeChild(this.taskPool[1]);\n        this.leftStartY = left.getChildByPath(\"txzItem\").position.y;\n\n        let right = this.node.getChildByPath(\"ui/right\");\n        this.rightStartY = right.getChildByPath(\"hdItem\").position.y;\n\n        this.taskItems.push(this.node.getChildByPath(\"ui/taskItem/item0\"));\n        this.taskItems.push(this.node.getChildByPath(\"ui/taskItem/item1\"));\n        this.taskItems.push(this.node.getChildByPath(\"ui/taskItem/item2\"));\n        this.right_taskStartX = this.node.getChildByPath(\"ui/taskItem/item0\").position.x;\n        EventMgr.on(Evt_MainTaskChange, this.updateLeftData, this);\n\n        super.onLoad();\n    }\n\n    protected Init() {\n\n        let hdItem = this.node.getChildByPath(\"ui/right/hdItem\");\n        Utils.AddTouchEffect(hdItem, (e) => {\n            let ut = hdItem.getComponent(UITransform);\n            if (this.rightView.checkTouch(e, hdItem, ut.contentSize.width, ut.contentSize.height / 2)) return true;\n            return false;\n        }, this, MainUI3D.canvas);\n        \n        Utils.AddTouchEffect(this.txzItem, (e) => {\n            let ut = this.txzItem.getComponent(UITransform);\n            if (this.leftView.checkTouch(e, this.txzItem, ut.contentSize.width, ut.contentSize.height / 2)) return true;\n            return false;\n        }, this, MainUI3D.canvas);\n\n        let tileItem = this.node.getChildByPath(\"ui/left/tileItem\");\n        Utils.AddTouchEffect(tileItem, (e) => {\n            let ut = tileItem.getComponent(UITransform);\n            if (this.leftView.checkTouch(e, tileItem, ut.contentSize.width, ut.contentSize.height / 2)) return true;\n            return false;\n        }, this, MainUI3D.canvas);\n\n        Utils.AddTouchEffect(this.fightBtn, (e) => {\n            let ut = this.fightBtn.getComponent(UITransform);\n            if (this.battleView.checkTouch(e, this.fightBtn, ut.contentSize.width / 2, ut.contentSize.height / 2)) return true;\n            return false;\n        }, this, MainUI3D.canvas);\n        Utils.AddTouchEffect(this.saijiBtn, (e) => {\n            let ut = this.saijiBtn.getComponent(UITransform);\n            if (this.battleView.checkTouch(e, this.saijiBtn, ut.contentSize.width / 2, ut.contentSize.height / 2)) return true;\n            return false;\n        }, this, MainUI3D.canvas);\n\n    }\n\n    async start() {\n        this.planeView = new PlaneView(GameSet.mainCamera, this.node.getChildByPath(\"ui\"), Vec3.UNIT_Z);\n        this.leftView = new PlaneView(GameSet.mainCamera, this.node.getChildByPath(\"ui/left\"));\n        this.rightView = new PlaneView(GameSet.mainCamera, this.node.getChildByPath(\"ui/right\"));\n        this.battleView = new PlaneView(GameSet.mainCamera, this.node.getChildByPath(\"ui/battleNode\"));\n\n        this.updateLeftData();\n\n        let children = this.node.getChildByPath(\"ui/left\").children;\n        this.layoutV(this.leftView.localLeftDown.x, this.leftStartY, children);\n        this.startTween(0, children);\n\n        children = this.node.getChildByPath(\"ui/right\").children;\n        this.layoutV(this.rightView.localRightDown.x, this.rightStartY, children);\n        this.startTween(1, children);\n\n        this.setTween();\n    }\n\n    private async setTween() {\n        // let poster = this.node.getChildByPath(\"poster\");\n        // poster.getComponent(UIOpacity).opacity = 0;\n        // poster.setScale(new Vec3(poster.scale.x * 0.5, poster.scale.y * 0.5, 1));\n        // tween(poster)\n        //     .to(0.6, { scale: new Vec3(poster.scale.x * 2, poster.scale.y * 2, 1) }, { easing: easing.circOut })\n        //     .start();\n\n        let battleNode = this.node.getChildByPath(\"ui/battleNode\");\n        let battleNode_pos = battleNode.getPosition();\n        battleNode.setPosition(new Vec3(battleNode_pos.x, battleNode_pos.y - 20, battleNode_pos.z));\n\n        tween(battleNode)\n            .to(1.2, { position: new Vec3(battleNode_pos.x, battleNode_pos.y, battleNode_pos.z) }, { easing: easing.circOut })\n            .start();\n        // // await Second(0.2)\n        // tween(poster.getComponent(UIOpacity))\n        //     .to(1, { opacity: 255 }, { easing: easing.circOut })\n        //     .start()\n    }\n\n    private async startTween(left_right: number, items: Node[]) {\n        let endPos = [];\n        for (let index = 0; index < items.length; index++) {\n            const element = items[index];\n            let pos = element.getPosition();\n            endPos.push(pos);\n            if (left_right == 1) {\n                element.setPosition(new Vec3(pos.x + 100, pos.y, pos.z));\n            } else {\n                element.setPosition(new Vec3(pos.x - 100, pos.y, pos.z));\n            }\n        }\n\n        for (let index = 0; index < items.length; index++) {\n            const element = items[index];\n            tween(element).\n                to(1, { position: endPos[index] }, { easing: easing.circOut }).\n                start();\n            await Second(0.05);\n        }\n    }\n\n    protected layoutV(x: number, starty: number, items: Node[]) {\n        let h = 0;\n        for (let _i = 0; _i < items.length; _i++) {\n            let _item = items[_i];\n            h += _item.getComponent(Transform3d).height;\n        }\n        let startx = x;\n        let startz = 0;\n        let out = v3();\n        let mat = this.node.getWorldMatrix().invert();\n        for (let i = 0; i < items.length; i++) {\n            let item = items[i];\n            let trans = item.getComponent(Transform3d);\n            Vec3.transformMat4(out, item.worldPosition, mat);\n            let v = item.position;\n            item.setPosition(startx, starty, startz);\n            starty -= trans.height;\n        }\n    }\n\n    /**\n     * 更新左边任务栏\n     * @param datas \n     */\n    protected updateLeftData() {\n        let datas: any[] = PlayerData.GetShowMianTask();\n        let left = this.node.getChildByPath(\"ui/left\");\n        for (let i = 0, len = Math.max(datas.length, this.leftItems.length); i < len; i++) {\n            let data = datas[i];\n            if (!data) {\n                let item = this.leftItems[i]\n                left.removeChild(item);\n                this.taskPool.push(item);\n                Utils.DelTouchEffect(item, MainUI3D.canvas);\n\n            } else {\n                let item = this.leftItems[i];\n                if (!item) {\n                    item = this.taskPool.length ? this.taskPool.pop() : instantiate(this.taskClone);\n                    Utils.DelTouchEffect(item, MainUI3D.canvas);\n                    Utils.AddTouchEffect(item, (e) => {\n                        let ut = item.getComponent(UITransform);\n                        if (this.leftView.checkTouch(e, item, ut.contentSize.width, ut.contentSize.height / 2)) return true;\n                        return false;\n                    }, this, MainUI3D.canvas);\n\n                    this.leftItems.push(item);\n                    left.addChild(item);\n                }\n                let cfg_task = CfgMgr.GetTaskByData(data)\n                console.log(cfg_task)\n                let icon = CfgMgr.Getitem(cfg_task.RewardID[0]).Icon;\n                let num = cfg_task.RewardNumber[0];\n                ResMgr.LoadResAbSub(path.join(folder_item, icon, \"spriteFrame\"), SpriteFrame, res => {\n                    item.getChildByName(\"icon\").getComponent(Sprite).spriteFrame = res;\n                })\n                item.getChildByPath(\"icon/num\").getComponent(Label).string = num + \"\"\n                item.getChildByPath(\"icon/label\").getComponent(Label).string = cfg_task.Description\n                let state = PlayerData.GetTaskState(data)\n                item.getChildByName(\"select\").active = state == 2\n                item[\"data\"] = cfg_task\n            }\n        }\n    }\n\n    protected update(dt: number): void {\n        if (this.node.parent) {\n            if (PlayerData.change_task_list.length && Panel.GetPanelNum(\"MainPanel\", \"TopUI\") <= 0) {\n                if (!this.startTaskTween) {\n                    this.startTaskTween = true;\n                    this.updateRighTaskItem();\n                }\n            }\n        }\n    }\n\n    /** 更新右边任务栏 */\n    private async updateRighTaskItem() {\n        let data = [];\n        data = data.concat(...PlayerData.change_task_list);\n        PlayerData.change_task_list = [];\n        this.startTaskTween = false;\n        let item_count = this.taskItems.length\n        let count = Math.ceil(data.length / item_count);\n        for (let index = 0; index < count; index++) {\n            let time = index == count - 1 ? 3 : 0.6\n            for (let i = 0; i < item_count; i++) {\n                const element = data[index * item_count + i];\n                console.log(element, data.length, index, item_count, i)\n                let item = this.taskItems[i];\n                if (!element) {\n                    item.active = false\n                } else {\n                    item.active = true;\n                    let cfg_task = CfgMgr.GetTaskByData(element.data)\n                    let count = element.data.value > cfg_task.CompletionNum ? cfg_task.CompletionNum : element.data.value\n                    let str = \"(\" + count + \"/\" + cfg_task.CompletionNum + \")\"\n                    item.getChildByName(\"label\").getComponent(Label).string = \"完成\" + cfg_task.Description + str\n                }\n                tween(item)\n                    .to(0.5, { position: new Vec3(this.right_taskStartX - 4.1, item.position.y, item.position.z) })\n                    .delay(time)\n                    .call(() => { item.active = false })\n                    .to(0.01, { position: new Vec3(this.right_taskStartX, item.position.y, item.position.z) })\n                    .call(() => { item.active = true })\n                    .start()\n            }\n            await Second(1.11)\n        }\n    }\n\n    protected onTouchStart(e: EventTouch) {\n\n    }\n\n\n    /**\n     * 点击事件\n     * @param e \n     * @returns \n     */\n    protected onTouchEnd(e: EventTouch) {\n        let ut = this.saijiBtn.getComponent(UITransform);\n        if (this.battleView.checkTouch(e, this.saijiBtn, ut.contentSize.width / 2, ut.contentSize.height / 2)) {\n            if (PlayerData.CurSeasonData && PlayerData.CurSeasonData.currentSeasonId != 0) {\n                Goto(\"VSModelPanel\", proto.base.BattleMode.BattleModeRank);\n            } else {\n                MsgPanel.Show(\"暂时没有赛季进行中\");\n            }\n            return;\n        }\n\n        ut = this.fightBtn.getComponent(UITransform);\n        if (this.battleView.checkTouch(e, this.fightBtn, ut.contentSize.width / 2, ut.contentSize.height / 2)) {\n            if (PlayerData.SatrElementData && PlayerData.SatrElementData.currentSeasonId != 0) {\n                Goto(\"VSModelPanel\", proto.base.BattleMode.BattleModeStar);\n            } else {\n                MsgPanel.Show(\"暂时没有星元对战进行中\");\n            }\n            return;\n        }\n\n        //赛季通行证\n        ut = this.txzItem.getComponent(UITransform);\n        if (this.leftView.checkTouch(e, this.txzItem, ut.contentSize.width, ut.contentSize.height)) {\n            Goto(\"RightsPanel\")\n            return;\n        }\n\n        //任务\n        let tileItem = this.node.getChildByPath(\"ui/left/tileItem\");\n        ut = tileItem.getComponent(UITransform);\n        if (this.leftView.checkTouch(e, tileItem, ut.contentSize.width, ut.contentSize.height)) {\n            console.log(tileItem.name);\n            Goto(\"TaskPanel\");\n            return;\n        }\n\n        for (let item of this.leftItems) {\n            if (item.parent) {\n                ut = item.getComponent(UITransform);\n                if (this.leftView.checkTouch(e, item, ut.contentSize.width, ut.contentSize.height)) {\n                    let cfg: StdTask = item[\"data\"];\n                    console.log(cfg);\n                    let type = 0;\n                    if (cfg.TaskTypeData && cfg.TaskTypeData.length > 0) {\n                        type = cfg.TaskTypeData[0]\n                    }\n                    Goto(\"TaskPanel\", cfg.Show - 1, type);\n                    return;\n                }\n            }\n        }\n    }\n}\n"]}